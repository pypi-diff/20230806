# Comparing `tmp/torchrec_nightly-2023.8.3-py39-none-any.whl.zip` & `tmp/torchrec_nightly-2023.8.5-py39-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,150 +1,150 @@
-Zip file size: 373003 bytes, number of entries: 148
--rw-r--r--  2.0 unx      811 b- defN 23-Aug-03 11:17 torchrec/__init__.py
--rw-r--r--  2.0 unx     1638 b- defN 23-Aug-03 11:17 torchrec/streamable.py
--rw-r--r--  2.0 unx      854 b- defN 23-Aug-03 11:17 torchrec/types.py
--rw-r--r--  2.0 unx     1153 b- defN 23-Aug-03 11:17 torchrec/datasets/__init__.py
--rw-r--r--  2.0 unx    41469 b- defN 23-Aug-03 11:17 torchrec/datasets/criteo.py
--rw-r--r--  2.0 unx     4548 b- defN 23-Aug-03 11:17 torchrec/datasets/movielens.py
--rw-r--r--  2.0 unx     6539 b- defN 23-Aug-03 11:17 torchrec/datasets/random.py
--rw-r--r--  2.0 unx    10909 b- defN 23-Aug-03 11:17 torchrec/datasets/utils.py
--rw-r--r--  2.0 unx        0 b- defN 23-Aug-03 11:17 torchrec/datasets/scripts/__init__.py
--rw-r--r--  2.0 unx     2448 b- defN 23-Aug-03 11:17 torchrec/datasets/scripts/contiguous_preproc_criteo.py
--rw-r--r--  2.0 unx     2847 b- defN 23-Aug-03 11:17 torchrec/datasets/scripts/npy_preproc_criteo.py
--rw-r--r--  2.0 unx     3077 b- defN 23-Aug-03 11:17 torchrec/datasets/scripts/shuffle_preproc_criteo.py
--rw-r--r--  2.0 unx        0 b- defN 23-Aug-03 11:17 torchrec/datasets/test_utils/__init__.py
--rw-r--r--  2.0 unx     5308 b- defN 23-Aug-03 11:17 torchrec/datasets/test_utils/criteo_test_utils.py
--rw-r--r--  2.0 unx     1912 b- defN 23-Aug-03 11:17 torchrec/distributed/__init__.py
--rw-r--r--  2.0 unx    37307 b- defN 23-Aug-03 11:17 torchrec/distributed/batched_embedding_kernel.py
--rw-r--r--  2.0 unx     2069 b- defN 23-Aug-03 11:17 torchrec/distributed/collective_utils.py
--rw-r--r--  2.0 unx     4988 b- defN 23-Aug-03 11:17 torchrec/distributed/comm.py
--rw-r--r--  2.0 unx    56136 b- defN 23-Aug-03 11:17 torchrec/distributed/comm_ops.py
--rw-r--r--  2.0 unx    36889 b- defN 23-Aug-03 11:17 torchrec/distributed/dist_data.py
--rw-r--r--  2.0 unx    32295 b- defN 23-Aug-03 11:17 torchrec/distributed/embedding.py
--rw-r--r--  2.0 unx     4947 b- defN 23-Aug-03 11:17 torchrec/distributed/embedding_kernel.py
--rw-r--r--  2.0 unx    30169 b- defN 23-Aug-03 11:17 torchrec/distributed/embedding_lookup.py
--rw-r--r--  2.0 unx    19035 b- defN 23-Aug-03 11:17 torchrec/distributed/embedding_sharding.py
--rw-r--r--  2.0 unx    36853 b- defN 23-Aug-03 11:17 torchrec/distributed/embedding_tower_sharding.py
--rw-r--r--  2.0 unx    15386 b- defN 23-Aug-03 11:17 torchrec/distributed/embedding_types.py
--rw-r--r--  2.0 unx    37310 b- defN 23-Aug-03 11:17 torchrec/distributed/embeddingbag.py
--rw-r--r--  2.0 unx     7373 b- defN 23-Aug-03 11:17 torchrec/distributed/fbgemm_qcomm_codec.py
--rw-r--r--  2.0 unx     6219 b- defN 23-Aug-03 11:17 torchrec/distributed/fp_embeddingbag.py
--rw-r--r--  2.0 unx     5243 b- defN 23-Aug-03 11:17 torchrec/distributed/fused_embedding.py
--rw-r--r--  2.0 unx     5080 b- defN 23-Aug-03 11:17 torchrec/distributed/fused_embeddingbag.py
--rw-r--r--  2.0 unx     2271 b- defN 23-Aug-03 11:17 torchrec/distributed/fused_params.py
--rw-r--r--  2.0 unx     3807 b- defN 23-Aug-03 11:17 torchrec/distributed/grouped_position_weighted.py
--rw-r--r--  2.0 unx    10997 b- defN 23-Aug-03 11:17 torchrec/distributed/mc_embeddingbag.py
--rw-r--r--  2.0 unx    19750 b- defN 23-Aug-03 11:17 torchrec/distributed/model_parallel.py
--rw-r--r--  2.0 unx    20748 b- defN 23-Aug-03 11:17 torchrec/distributed/quant_embedding.py
--rw-r--r--  2.0 unx    15112 b- defN 23-Aug-03 11:17 torchrec/distributed/quant_embedding_kernel.py
--rw-r--r--  2.0 unx    12621 b- defN 23-Aug-03 11:17 torchrec/distributed/quant_embeddingbag.py
--rw-r--r--  2.0 unx    13928 b- defN 23-Aug-03 11:17 torchrec/distributed/quant_state.py
--rw-r--r--  2.0 unx     9261 b- defN 23-Aug-03 11:17 torchrec/distributed/shard.py
--rw-r--r--  2.0 unx    19646 b- defN 23-Aug-03 11:17 torchrec/distributed/sharding_plan.py
--rw-r--r--  2.0 unx    48681 b- defN 23-Aug-03 11:17 torchrec/distributed/train_pipeline.py
--rw-r--r--  2.0 unx    26441 b- defN 23-Aug-03 11:17 torchrec/distributed/types.py
--rw-r--r--  2.0 unx    15470 b- defN 23-Aug-03 11:17 torchrec/distributed/utils.py
--rw-r--r--  2.0 unx        0 b- defN 23-Aug-03 11:17 torchrec/distributed/composable/__init__.py
--rw-r--r--  2.0 unx     3207 b- defN 23-Aug-03 11:17 torchrec/distributed/composable/table_batched_embedding_slice.py
--rw-r--r--  2.0 unx     1025 b- defN 23-Aug-03 11:17 torchrec/distributed/planner/__init__.py
--rw-r--r--  2.0 unx     3135 b- defN 23-Aug-03 11:17 torchrec/distributed/planner/constants.py
--rw-r--r--  2.0 unx    11430 b- defN 23-Aug-03 11:17 torchrec/distributed/planner/enumerators.py
--rw-r--r--  2.0 unx    12642 b- defN 23-Aug-03 11:17 torchrec/distributed/planner/partitioners.py
--rw-r--r--  2.0 unx      835 b- defN 23-Aug-03 11:17 torchrec/distributed/planner/perf_models.py
--rw-r--r--  2.0 unx    13803 b- defN 23-Aug-03 11:17 torchrec/distributed/planner/planners.py
--rw-r--r--  2.0 unx    11236 b- defN 23-Aug-03 11:17 torchrec/distributed/planner/proposers.py
--rw-r--r--  2.0 unx    41291 b- defN 23-Aug-03 11:17 torchrec/distributed/planner/shard_estimators.py
--rw-r--r--  2.0 unx    24082 b- defN 23-Aug-03 11:17 torchrec/distributed/planner/stats.py
--rw-r--r--  2.0 unx    11109 b- defN 23-Aug-03 11:17 torchrec/distributed/planner/storage_reservations.py
--rw-r--r--  2.0 unx    14582 b- defN 23-Aug-03 11:17 torchrec/distributed/planner/types.py
--rw-r--r--  2.0 unx     1431 b- defN 23-Aug-03 11:17 torchrec/distributed/planner/utils.py
--rw-r--r--  2.0 unx        0 b- defN 23-Aug-03 11:17 torchrec/distributed/sharding/__init__.py
--rw-r--r--  2.0 unx     2479 b- defN 23-Aug-03 11:17 torchrec/distributed/sharding/cw_sequence_sharding.py
--rw-r--r--  2.0 unx    12945 b- defN 23-Aug-03 11:17 torchrec/distributed/sharding/cw_sharding.py
--rw-r--r--  2.0 unx     2802 b- defN 23-Aug-03 11:17 torchrec/distributed/sharding/dp_sequence_sharding.py
--rw-r--r--  2.0 unx     7681 b- defN 23-Aug-03 11:17 torchrec/distributed/sharding/dp_sharding.py
--rw-r--r--  2.0 unx     7640 b- defN 23-Aug-03 11:17 torchrec/distributed/sharding/rw_sequence_sharding.py
--rw-r--r--  2.0 unx    17911 b- defN 23-Aug-03 11:17 torchrec/distributed/sharding/rw_sharding.py
--rw-r--r--  2.0 unx     3627 b- defN 23-Aug-03 11:17 torchrec/distributed/sharding/sequence_sharding.py
--rw-r--r--  2.0 unx     7632 b- defN 23-Aug-03 11:17 torchrec/distributed/sharding/tw_sequence_sharding.py
--rw-r--r--  2.0 unx    16097 b- defN 23-Aug-03 11:17 torchrec/distributed/sharding/tw_sharding.py
--rw-r--r--  2.0 unx     1284 b- defN 23-Aug-03 11:17 torchrec/distributed/sharding/twcw_sharding.py
--rw-r--r--  2.0 unx    19871 b- defN 23-Aug-03 11:17 torchrec/distributed/sharding/twrw_sharding.py
--rw-r--r--  2.0 unx        0 b- defN 23-Aug-03 11:17 torchrec/distributed/test_utils/__init__.py
--rw-r--r--  2.0 unx    11237 b- defN 23-Aug-03 11:17 torchrec/distributed/test_utils/infer_utils.py
--rw-r--r--  2.0 unx     4868 b- defN 23-Aug-03 11:17 torchrec/distributed/test_utils/multi_process.py
--rw-r--r--  2.0 unx    34993 b- defN 23-Aug-03 11:17 torchrec/distributed/test_utils/test_model.py
--rw-r--r--  2.0 unx    11197 b- defN 23-Aug-03 11:17 torchrec/distributed/test_utils/test_model_parallel.py
--rw-r--r--  2.0 unx    25310 b- defN 23-Aug-03 11:17 torchrec/distributed/test_utils/test_model_parallel_base.py
--rw-r--r--  2.0 unx    15367 b- defN 23-Aug-03 11:17 torchrec/distributed/test_utils/test_sharding.py
--rw-r--r--  2.0 unx      422 b- defN 23-Aug-03 11:17 torchrec/fx/__init__.py
--rw-r--r--  2.0 unx     6451 b- defN 23-Aug-03 11:17 torchrec/fx/tracer.py
--rw-r--r--  2.0 unx     4524 b- defN 23-Aug-03 11:17 torchrec/fx/utils.py
--rw-r--r--  2.0 unx     1223 b- defN 23-Aug-03 11:17 torchrec/inference/__init__.py
--rw-r--r--  2.0 unx     3614 b- defN 23-Aug-03 11:17 torchrec/inference/client.py
--rw-r--r--  2.0 unx     3957 b- defN 23-Aug-03 11:17 torchrec/inference/model_packager.py
--rw-r--r--  2.0 unx     8068 b- defN 23-Aug-03 11:17 torchrec/inference/modules.py
--rw-r--r--  2.0 unx     3797 b- defN 23-Aug-03 11:17 torchrec/inference/state_dict_transform.py
--rw-r--r--  2.0 unx        0 b- defN 23-Aug-03 11:17 torchrec/metrics/__init__.py
--rw-r--r--  2.0 unx     4168 b- defN 23-Aug-03 11:17 torchrec/metrics/accuracy.py
--rw-r--r--  2.0 unx    12549 b- defN 23-Aug-03 11:17 torchrec/metrics/auc.py
--rw-r--r--  2.0 unx     3703 b- defN 23-Aug-03 11:17 torchrec/metrics/calibration.py
--rw-r--r--  2.0 unx     3465 b- defN 23-Aug-03 11:17 torchrec/metrics/ctr.py
--rw-r--r--  2.0 unx     3836 b- defN 23-Aug-03 11:17 torchrec/metrics/mae.py
--rw-r--r--  2.0 unx    17990 b- defN 23-Aug-03 11:17 torchrec/metrics/metric_module.py
--rw-r--r--  2.0 unx     6796 b- defN 23-Aug-03 11:17 torchrec/metrics/metrics_config.py
--rw-r--r--  2.0 unx     3731 b- defN 23-Aug-03 11:17 torchrec/metrics/metrics_namespace.py
--rw-r--r--  2.0 unx     3904 b- defN 23-Aug-03 11:17 torchrec/metrics/model_utils.py
--rw-r--r--  2.0 unx     4631 b- defN 23-Aug-03 11:17 torchrec/metrics/mse.py
--rw-r--r--  2.0 unx     5605 b- defN 23-Aug-03 11:17 torchrec/metrics/multiclass_recall.py
--rw-r--r--  2.0 unx     8735 b- defN 23-Aug-03 11:17 torchrec/metrics/ndcg.py
--rw-r--r--  2.0 unx     6811 b- defN 23-Aug-03 11:17 torchrec/metrics/ne.py
--rw-r--r--  2.0 unx    33554 b- defN 23-Aug-03 11:17 torchrec/metrics/rec_metric.py
--rw-r--r--  2.0 unx    10490 b- defN 23-Aug-03 11:17 torchrec/metrics/recall_session.py
--rw-r--r--  2.0 unx     6057 b- defN 23-Aug-03 11:17 torchrec/metrics/throughput.py
--rw-r--r--  2.0 unx    11160 b- defN 23-Aug-03 11:17 torchrec/metrics/tower_qps.py
--rw-r--r--  2.0 unx     2867 b- defN 23-Aug-03 11:17 torchrec/metrics/weighted_avg.py
--rw-r--r--  2.0 unx    16441 b- defN 23-Aug-03 11:17 torchrec/metrics/test_utils/__init__.py
--rw-r--r--  2.0 unx      913 b- defN 23-Aug-03 11:17 torchrec/models/__init__.py
--rw-r--r--  2.0 unx    11410 b- defN 23-Aug-03 11:17 torchrec/models/deepfm.py
--rw-r--r--  2.0 unx    29965 b- defN 23-Aug-03 11:17 torchrec/models/dlrm.py
--rw-r--r--  2.0 unx        0 b- defN 23-Aug-03 11:17 torchrec/models/experimental/__init__.py
--rw-r--r--  2.0 unx     9825 b- defN 23-Aug-03 11:17 torchrec/models/experimental/test_transformerdlrm.py
--rw-r--r--  2.0 unx     7434 b- defN 23-Aug-03 11:17 torchrec/models/experimental/transformerdlrm.py
--rw-r--r--  2.0 unx     1179 b- defN 23-Aug-03 11:17 torchrec/modules/__init__.py
--rw-r--r--  2.0 unx     1456 b- defN 23-Aug-03 11:17 torchrec/modules/activation.py
--rw-r--r--  2.0 unx    14636 b- defN 23-Aug-03 11:17 torchrec/modules/crossnet.py
--rw-r--r--  2.0 unx     8415 b- defN 23-Aug-03 11:17 torchrec/modules/deepfm.py
--rw-r--r--  2.0 unx     6468 b- defN 23-Aug-03 11:17 torchrec/modules/embedding_configs.py
--rw-r--r--  2.0 unx    14021 b- defN 23-Aug-03 11:17 torchrec/modules/embedding_modules.py
--rw-r--r--  2.0 unx     4858 b- defN 23-Aug-03 11:17 torchrec/modules/embedding_tower.py
--rw-r--r--  2.0 unx    12360 b- defN 23-Aug-03 11:17 torchrec/modules/feature_processor.py
--rw-r--r--  2.0 unx     4964 b- defN 23-Aug-03 11:17 torchrec/modules/feature_processor_.py
--rw-r--r--  2.0 unx     4960 b- defN 23-Aug-03 11:17 torchrec/modules/fp_embedding_modules.py
--rw-r--r--  2.0 unx    31545 b- defN 23-Aug-03 11:17 torchrec/modules/fused_embedding_modules.py
--rw-r--r--  2.0 unx    10533 b- defN 23-Aug-03 11:17 torchrec/modules/lazy_extension.py
--rw-r--r--  2.0 unx     3143 b- defN 23-Aug-03 11:17 torchrec/modules/managed_collision_modules.py
--rw-r--r--  2.0 unx     5124 b- defN 23-Aug-03 11:17 torchrec/modules/mc_embedding_modules.py
--rw-r--r--  2.0 unx     6309 b- defN 23-Aug-03 11:17 torchrec/modules/mlp.py
--rw-r--r--  2.0 unx     3897 b- defN 23-Aug-03 11:17 torchrec/modules/utils.py
--rw-r--r--  2.0 unx     1639 b- defN 23-Aug-03 11:17 torchrec/optim/__init__.py
--rw-r--r--  2.0 unx     2012 b- defN 23-Aug-03 11:17 torchrec/optim/apply_optimizer_in_backward.py
--rw-r--r--  2.0 unx     1569 b- defN 23-Aug-03 11:17 torchrec/optim/clipping.py
--rw-r--r--  2.0 unx     1353 b- defN 23-Aug-03 11:17 torchrec/optim/fused.py
--rw-r--r--  2.0 unx    16069 b- defN 23-Aug-03 11:17 torchrec/optim/keyed.py
--rw-r--r--  2.0 unx     4420 b- defN 23-Aug-03 11:17 torchrec/optim/optimizers.py
--rw-r--r--  2.0 unx     7405 b- defN 23-Aug-03 11:17 torchrec/optim/rowwise_adagrad.py
--rw-r--r--  2.0 unx     4865 b- defN 23-Aug-03 11:17 torchrec/optim/warmup.py
--rw-r--r--  2.0 unx      560 b- defN 23-Aug-03 11:17 torchrec/optim/test_utils/__init__.py
--rw-r--r--  2.0 unx     1140 b- defN 23-Aug-03 11:17 torchrec/quant/__init__.py
--rw-r--r--  2.0 unx    26618 b- defN 23-Aug-03 11:17 torchrec/quant/embedding_modules.py
--rw-r--r--  2.0 unx     4292 b- defN 23-Aug-03 11:17 torchrec/quant/utils.py
--rw-r--r--  2.0 unx     1163 b- defN 23-Aug-03 11:17 torchrec/sparse/__init__.py
--rw-r--r--  2.0 unx    56412 b- defN 23-Aug-03 11:17 torchrec/sparse/jagged_tensor.py
--rw-r--r--  2.0 unx     1430 b- defN 23-Aug-03 11:17 torchrec/sparse/test_utils/__init__.py
--rw-r--r--  2.0 unx     5661 b- defN 23-Aug-03 11:17 torchrec/test_utils/__init__.py
--rw-r--r--  2.0 unx     1530 b- defN 23-Aug-03 11:22 torchrec_nightly-2023.8.3.dist-info/LICENSE
--rw-r--r--  2.0 unx     5011 b- defN 23-Aug-03 11:22 torchrec_nightly-2023.8.3.dist-info/METADATA
--rw-r--r--  2.0 unx       93 b- defN 23-Aug-03 11:22 torchrec_nightly-2023.8.3.dist-info/WHEEL
--rw-r--r--  2.0 unx        9 b- defN 23-Aug-03 11:22 torchrec_nightly-2023.8.3.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx    13819 b- defN 23-Aug-03 11:22 torchrec_nightly-2023.8.3.dist-info/RECORD
-148 files, 1541328 bytes uncompressed, 350903 bytes compressed:  77.2%
+Zip file size: 373251 bytes, number of entries: 148
+-rw-r--r--  2.0 unx      811 b- defN 23-Aug-05 11:17 torchrec/__init__.py
+-rw-r--r--  2.0 unx     1638 b- defN 23-Aug-05 11:17 torchrec/streamable.py
+-rw-r--r--  2.0 unx      854 b- defN 23-Aug-05 11:17 torchrec/types.py
+-rw-r--r--  2.0 unx     1153 b- defN 23-Aug-05 11:17 torchrec/datasets/__init__.py
+-rw-r--r--  2.0 unx    41469 b- defN 23-Aug-05 11:17 torchrec/datasets/criteo.py
+-rw-r--r--  2.0 unx     4548 b- defN 23-Aug-05 11:17 torchrec/datasets/movielens.py
+-rw-r--r--  2.0 unx     6539 b- defN 23-Aug-05 11:17 torchrec/datasets/random.py
+-rw-r--r--  2.0 unx    10909 b- defN 23-Aug-05 11:17 torchrec/datasets/utils.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Aug-05 11:17 torchrec/datasets/scripts/__init__.py
+-rw-r--r--  2.0 unx     2448 b- defN 23-Aug-05 11:17 torchrec/datasets/scripts/contiguous_preproc_criteo.py
+-rw-r--r--  2.0 unx     2847 b- defN 23-Aug-05 11:17 torchrec/datasets/scripts/npy_preproc_criteo.py
+-rw-r--r--  2.0 unx     3077 b- defN 23-Aug-05 11:17 torchrec/datasets/scripts/shuffle_preproc_criteo.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Aug-05 11:17 torchrec/datasets/test_utils/__init__.py
+-rw-r--r--  2.0 unx     5308 b- defN 23-Aug-05 11:17 torchrec/datasets/test_utils/criteo_test_utils.py
+-rw-r--r--  2.0 unx     1945 b- defN 23-Aug-05 11:17 torchrec/distributed/__init__.py
+-rw-r--r--  2.0 unx    37307 b- defN 23-Aug-05 11:17 torchrec/distributed/batched_embedding_kernel.py
+-rw-r--r--  2.0 unx     2069 b- defN 23-Aug-05 11:17 torchrec/distributed/collective_utils.py
+-rw-r--r--  2.0 unx     4988 b- defN 23-Aug-05 11:17 torchrec/distributed/comm.py
+-rw-r--r--  2.0 unx    56136 b- defN 23-Aug-05 11:17 torchrec/distributed/comm_ops.py
+-rw-r--r--  2.0 unx    36889 b- defN 23-Aug-05 11:17 torchrec/distributed/dist_data.py
+-rw-r--r--  2.0 unx    32295 b- defN 23-Aug-05 11:17 torchrec/distributed/embedding.py
+-rw-r--r--  2.0 unx     4947 b- defN 23-Aug-05 11:17 torchrec/distributed/embedding_kernel.py
+-rw-r--r--  2.0 unx    30169 b- defN 23-Aug-05 11:17 torchrec/distributed/embedding_lookup.py
+-rw-r--r--  2.0 unx    19035 b- defN 23-Aug-05 11:17 torchrec/distributed/embedding_sharding.py
+-rw-r--r--  2.0 unx    36853 b- defN 23-Aug-05 11:17 torchrec/distributed/embedding_tower_sharding.py
+-rw-r--r--  2.0 unx    15386 b- defN 23-Aug-05 11:17 torchrec/distributed/embedding_types.py
+-rw-r--r--  2.0 unx    37310 b- defN 23-Aug-05 11:17 torchrec/distributed/embeddingbag.py
+-rw-r--r--  2.0 unx     7373 b- defN 23-Aug-05 11:17 torchrec/distributed/fbgemm_qcomm_codec.py
+-rw-r--r--  2.0 unx     6219 b- defN 23-Aug-05 11:17 torchrec/distributed/fp_embeddingbag.py
+-rw-r--r--  2.0 unx     5243 b- defN 23-Aug-05 11:17 torchrec/distributed/fused_embedding.py
+-rw-r--r--  2.0 unx     5080 b- defN 23-Aug-05 11:17 torchrec/distributed/fused_embeddingbag.py
+-rw-r--r--  2.0 unx     2271 b- defN 23-Aug-05 11:17 torchrec/distributed/fused_params.py
+-rw-r--r--  2.0 unx     3807 b- defN 23-Aug-05 11:17 torchrec/distributed/grouped_position_weighted.py
+-rw-r--r--  2.0 unx    10997 b- defN 23-Aug-05 11:17 torchrec/distributed/mc_embeddingbag.py
+-rw-r--r--  2.0 unx    19750 b- defN 23-Aug-05 11:17 torchrec/distributed/model_parallel.py
+-rw-r--r--  2.0 unx    20748 b- defN 23-Aug-05 11:17 torchrec/distributed/quant_embedding.py
+-rw-r--r--  2.0 unx    15112 b- defN 23-Aug-05 11:17 torchrec/distributed/quant_embedding_kernel.py
+-rw-r--r--  2.0 unx    12621 b- defN 23-Aug-05 11:17 torchrec/distributed/quant_embeddingbag.py
+-rw-r--r--  2.0 unx    13928 b- defN 23-Aug-05 11:17 torchrec/distributed/quant_state.py
+-rw-r--r--  2.0 unx     9261 b- defN 23-Aug-05 11:17 torchrec/distributed/shard.py
+-rw-r--r--  2.0 unx    19906 b- defN 23-Aug-05 11:17 torchrec/distributed/sharding_plan.py
+-rw-r--r--  2.0 unx    48752 b- defN 23-Aug-05 11:17 torchrec/distributed/train_pipeline.py
+-rw-r--r--  2.0 unx    26441 b- defN 23-Aug-05 11:17 torchrec/distributed/types.py
+-rw-r--r--  2.0 unx    15470 b- defN 23-Aug-05 11:17 torchrec/distributed/utils.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Aug-05 11:17 torchrec/distributed/composable/__init__.py
+-rw-r--r--  2.0 unx     3207 b- defN 23-Aug-05 11:17 torchrec/distributed/composable/table_batched_embedding_slice.py
+-rw-r--r--  2.0 unx     1025 b- defN 23-Aug-05 11:17 torchrec/distributed/planner/__init__.py
+-rw-r--r--  2.0 unx     3135 b- defN 23-Aug-05 11:17 torchrec/distributed/planner/constants.py
+-rw-r--r--  2.0 unx    11430 b- defN 23-Aug-05 11:17 torchrec/distributed/planner/enumerators.py
+-rw-r--r--  2.0 unx    12642 b- defN 23-Aug-05 11:17 torchrec/distributed/planner/partitioners.py
+-rw-r--r--  2.0 unx      835 b- defN 23-Aug-05 11:17 torchrec/distributed/planner/perf_models.py
+-rw-r--r--  2.0 unx    13803 b- defN 23-Aug-05 11:17 torchrec/distributed/planner/planners.py
+-rw-r--r--  2.0 unx    11236 b- defN 23-Aug-05 11:17 torchrec/distributed/planner/proposers.py
+-rw-r--r--  2.0 unx    41291 b- defN 23-Aug-05 11:17 torchrec/distributed/planner/shard_estimators.py
+-rw-r--r--  2.0 unx    24082 b- defN 23-Aug-05 11:17 torchrec/distributed/planner/stats.py
+-rw-r--r--  2.0 unx    12858 b- defN 23-Aug-05 11:17 torchrec/distributed/planner/storage_reservations.py
+-rw-r--r--  2.0 unx    14582 b- defN 23-Aug-05 11:17 torchrec/distributed/planner/types.py
+-rw-r--r--  2.0 unx     1431 b- defN 23-Aug-05 11:17 torchrec/distributed/planner/utils.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Aug-05 11:17 torchrec/distributed/sharding/__init__.py
+-rw-r--r--  2.0 unx     2479 b- defN 23-Aug-05 11:17 torchrec/distributed/sharding/cw_sequence_sharding.py
+-rw-r--r--  2.0 unx    12945 b- defN 23-Aug-05 11:17 torchrec/distributed/sharding/cw_sharding.py
+-rw-r--r--  2.0 unx     2802 b- defN 23-Aug-05 11:17 torchrec/distributed/sharding/dp_sequence_sharding.py
+-rw-r--r--  2.0 unx     7681 b- defN 23-Aug-05 11:17 torchrec/distributed/sharding/dp_sharding.py
+-rw-r--r--  2.0 unx     7640 b- defN 23-Aug-05 11:17 torchrec/distributed/sharding/rw_sequence_sharding.py
+-rw-r--r--  2.0 unx    17911 b- defN 23-Aug-05 11:17 torchrec/distributed/sharding/rw_sharding.py
+-rw-r--r--  2.0 unx     3627 b- defN 23-Aug-05 11:17 torchrec/distributed/sharding/sequence_sharding.py
+-rw-r--r--  2.0 unx     7632 b- defN 23-Aug-05 11:17 torchrec/distributed/sharding/tw_sequence_sharding.py
+-rw-r--r--  2.0 unx    16097 b- defN 23-Aug-05 11:17 torchrec/distributed/sharding/tw_sharding.py
+-rw-r--r--  2.0 unx     1284 b- defN 23-Aug-05 11:17 torchrec/distributed/sharding/twcw_sharding.py
+-rw-r--r--  2.0 unx    19871 b- defN 23-Aug-05 11:17 torchrec/distributed/sharding/twrw_sharding.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Aug-05 11:17 torchrec/distributed/test_utils/__init__.py
+-rw-r--r--  2.0 unx    11237 b- defN 23-Aug-05 11:17 torchrec/distributed/test_utils/infer_utils.py
+-rw-r--r--  2.0 unx     4868 b- defN 23-Aug-05 11:17 torchrec/distributed/test_utils/multi_process.py
+-rw-r--r--  2.0 unx    34993 b- defN 23-Aug-05 11:17 torchrec/distributed/test_utils/test_model.py
+-rw-r--r--  2.0 unx    11197 b- defN 23-Aug-05 11:17 torchrec/distributed/test_utils/test_model_parallel.py
+-rw-r--r--  2.0 unx    25310 b- defN 23-Aug-05 11:17 torchrec/distributed/test_utils/test_model_parallel_base.py
+-rw-r--r--  2.0 unx    15367 b- defN 23-Aug-05 11:17 torchrec/distributed/test_utils/test_sharding.py
+-rw-r--r--  2.0 unx      422 b- defN 23-Aug-05 11:17 torchrec/fx/__init__.py
+-rw-r--r--  2.0 unx     6451 b- defN 23-Aug-05 11:17 torchrec/fx/tracer.py
+-rw-r--r--  2.0 unx     4524 b- defN 23-Aug-05 11:17 torchrec/fx/utils.py
+-rw-r--r--  2.0 unx     1223 b- defN 23-Aug-05 11:17 torchrec/inference/__init__.py
+-rw-r--r--  2.0 unx     3614 b- defN 23-Aug-05 11:17 torchrec/inference/client.py
+-rw-r--r--  2.0 unx     3957 b- defN 23-Aug-05 11:17 torchrec/inference/model_packager.py
+-rw-r--r--  2.0 unx     8068 b- defN 23-Aug-05 11:17 torchrec/inference/modules.py
+-rw-r--r--  2.0 unx     3797 b- defN 23-Aug-05 11:17 torchrec/inference/state_dict_transform.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Aug-05 11:17 torchrec/metrics/__init__.py
+-rw-r--r--  2.0 unx     4168 b- defN 23-Aug-05 11:17 torchrec/metrics/accuracy.py
+-rw-r--r--  2.0 unx    12549 b- defN 23-Aug-05 11:17 torchrec/metrics/auc.py
+-rw-r--r--  2.0 unx     3703 b- defN 23-Aug-05 11:17 torchrec/metrics/calibration.py
+-rw-r--r--  2.0 unx     3465 b- defN 23-Aug-05 11:17 torchrec/metrics/ctr.py
+-rw-r--r--  2.0 unx     3836 b- defN 23-Aug-05 11:17 torchrec/metrics/mae.py
+-rw-r--r--  2.0 unx    17990 b- defN 23-Aug-05 11:17 torchrec/metrics/metric_module.py
+-rw-r--r--  2.0 unx     6796 b- defN 23-Aug-05 11:17 torchrec/metrics/metrics_config.py
+-rw-r--r--  2.0 unx     3731 b- defN 23-Aug-05 11:17 torchrec/metrics/metrics_namespace.py
+-rw-r--r--  2.0 unx     3904 b- defN 23-Aug-05 11:17 torchrec/metrics/model_utils.py
+-rw-r--r--  2.0 unx     4631 b- defN 23-Aug-05 11:17 torchrec/metrics/mse.py
+-rw-r--r--  2.0 unx     5605 b- defN 23-Aug-05 11:17 torchrec/metrics/multiclass_recall.py
+-rw-r--r--  2.0 unx     8735 b- defN 23-Aug-05 11:17 torchrec/metrics/ndcg.py
+-rw-r--r--  2.0 unx     6811 b- defN 23-Aug-05 11:17 torchrec/metrics/ne.py
+-rw-r--r--  2.0 unx    33554 b- defN 23-Aug-05 11:17 torchrec/metrics/rec_metric.py
+-rw-r--r--  2.0 unx    10490 b- defN 23-Aug-05 11:17 torchrec/metrics/recall_session.py
+-rw-r--r--  2.0 unx     6057 b- defN 23-Aug-05 11:17 torchrec/metrics/throughput.py
+-rw-r--r--  2.0 unx    11160 b- defN 23-Aug-05 11:17 torchrec/metrics/tower_qps.py
+-rw-r--r--  2.0 unx     2867 b- defN 23-Aug-05 11:17 torchrec/metrics/weighted_avg.py
+-rw-r--r--  2.0 unx    16441 b- defN 23-Aug-05 11:17 torchrec/metrics/test_utils/__init__.py
+-rw-r--r--  2.0 unx      913 b- defN 23-Aug-05 11:17 torchrec/models/__init__.py
+-rw-r--r--  2.0 unx    11410 b- defN 23-Aug-05 11:17 torchrec/models/deepfm.py
+-rw-r--r--  2.0 unx    29965 b- defN 23-Aug-05 11:17 torchrec/models/dlrm.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Aug-05 11:17 torchrec/models/experimental/__init__.py
+-rw-r--r--  2.0 unx     9825 b- defN 23-Aug-05 11:17 torchrec/models/experimental/test_transformerdlrm.py
+-rw-r--r--  2.0 unx     7434 b- defN 23-Aug-05 11:17 torchrec/models/experimental/transformerdlrm.py
+-rw-r--r--  2.0 unx     1179 b- defN 23-Aug-05 11:17 torchrec/modules/__init__.py
+-rw-r--r--  2.0 unx     1456 b- defN 23-Aug-05 11:17 torchrec/modules/activation.py
+-rw-r--r--  2.0 unx    14636 b- defN 23-Aug-05 11:17 torchrec/modules/crossnet.py
+-rw-r--r--  2.0 unx     8415 b- defN 23-Aug-05 11:17 torchrec/modules/deepfm.py
+-rw-r--r--  2.0 unx     6468 b- defN 23-Aug-05 11:17 torchrec/modules/embedding_configs.py
+-rw-r--r--  2.0 unx    14021 b- defN 23-Aug-05 11:17 torchrec/modules/embedding_modules.py
+-rw-r--r--  2.0 unx     4858 b- defN 23-Aug-05 11:17 torchrec/modules/embedding_tower.py
+-rw-r--r--  2.0 unx    12360 b- defN 23-Aug-05 11:17 torchrec/modules/feature_processor.py
+-rw-r--r--  2.0 unx     4964 b- defN 23-Aug-05 11:17 torchrec/modules/feature_processor_.py
+-rw-r--r--  2.0 unx     4960 b- defN 23-Aug-05 11:17 torchrec/modules/fp_embedding_modules.py
+-rw-r--r--  2.0 unx    31545 b- defN 23-Aug-05 11:17 torchrec/modules/fused_embedding_modules.py
+-rw-r--r--  2.0 unx    10533 b- defN 23-Aug-05 11:17 torchrec/modules/lazy_extension.py
+-rw-r--r--  2.0 unx     3143 b- defN 23-Aug-05 11:17 torchrec/modules/managed_collision_modules.py
+-rw-r--r--  2.0 unx     5124 b- defN 23-Aug-05 11:17 torchrec/modules/mc_embedding_modules.py
+-rw-r--r--  2.0 unx     6309 b- defN 23-Aug-05 11:17 torchrec/modules/mlp.py
+-rw-r--r--  2.0 unx     3897 b- defN 23-Aug-05 11:17 torchrec/modules/utils.py
+-rw-r--r--  2.0 unx     1639 b- defN 23-Aug-05 11:17 torchrec/optim/__init__.py
+-rw-r--r--  2.0 unx     2012 b- defN 23-Aug-05 11:17 torchrec/optim/apply_optimizer_in_backward.py
+-rw-r--r--  2.0 unx     1569 b- defN 23-Aug-05 11:17 torchrec/optim/clipping.py
+-rw-r--r--  2.0 unx     1353 b- defN 23-Aug-05 11:17 torchrec/optim/fused.py
+-rw-r--r--  2.0 unx    16069 b- defN 23-Aug-05 11:17 torchrec/optim/keyed.py
+-rw-r--r--  2.0 unx     4420 b- defN 23-Aug-05 11:17 torchrec/optim/optimizers.py
+-rw-r--r--  2.0 unx     7405 b- defN 23-Aug-05 11:17 torchrec/optim/rowwise_adagrad.py
+-rw-r--r--  2.0 unx     4865 b- defN 23-Aug-05 11:17 torchrec/optim/warmup.py
+-rw-r--r--  2.0 unx      560 b- defN 23-Aug-05 11:17 torchrec/optim/test_utils/__init__.py
+-rw-r--r--  2.0 unx     1140 b- defN 23-Aug-05 11:17 torchrec/quant/__init__.py
+-rw-r--r--  2.0 unx    26618 b- defN 23-Aug-05 11:17 torchrec/quant/embedding_modules.py
+-rw-r--r--  2.0 unx     4292 b- defN 23-Aug-05 11:17 torchrec/quant/utils.py
+-rw-r--r--  2.0 unx     1163 b- defN 23-Aug-05 11:17 torchrec/sparse/__init__.py
+-rw-r--r--  2.0 unx    56427 b- defN 23-Aug-05 11:17 torchrec/sparse/jagged_tensor.py
+-rw-r--r--  2.0 unx     1430 b- defN 23-Aug-05 11:17 torchrec/sparse/test_utils/__init__.py
+-rw-r--r--  2.0 unx     5661 b- defN 23-Aug-05 11:17 torchrec/test_utils/__init__.py
+-rw-r--r--  2.0 unx     1530 b- defN 23-Aug-05 11:22 torchrec_nightly-2023.8.5.dist-info/LICENSE
+-rw-r--r--  2.0 unx     5011 b- defN 23-Aug-05 11:22 torchrec_nightly-2023.8.5.dist-info/METADATA
+-rw-r--r--  2.0 unx       93 b- defN 23-Aug-05 11:22 torchrec_nightly-2023.8.5.dist-info/WHEEL
+-rw-r--r--  2.0 unx        9 b- defN 23-Aug-05 11:22 torchrec_nightly-2023.8.5.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx    13819 b- defN 23-Aug-05 11:22 torchrec_nightly-2023.8.5.dist-info/RECORD
+148 files, 1543456 bytes uncompressed, 351151 bytes compressed:  77.2%
```

## zipnote {}

```diff
@@ -423,23 +423,23 @@
 
 Filename: torchrec/sparse/test_utils/__init__.py
 Comment: 
 
 Filename: torchrec/test_utils/__init__.py
 Comment: 
 
-Filename: torchrec_nightly-2023.8.3.dist-info/LICENSE
+Filename: torchrec_nightly-2023.8.5.dist-info/LICENSE
 Comment: 
 
-Filename: torchrec_nightly-2023.8.3.dist-info/METADATA
+Filename: torchrec_nightly-2023.8.5.dist-info/METADATA
 Comment: 
 
-Filename: torchrec_nightly-2023.8.3.dist-info/WHEEL
+Filename: torchrec_nightly-2023.8.5.dist-info/WHEEL
 Comment: 
 
-Filename: torchrec_nightly-2023.8.3.dist-info/top_level.txt
+Filename: torchrec_nightly-2023.8.5.dist-info/top_level.txt
 Comment: 
 
-Filename: torchrec_nightly-2023.8.3.dist-info/RECORD
+Filename: torchrec_nightly-2023.8.5.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## torchrec/distributed/__init__.py

```diff
@@ -20,25 +20,26 @@
 * sharded implementations of various modules including `ShardedEmbeddingBag` for
   `nn.EmbeddingBag`, `ShardedEmbeddingBagCollection` for `EmbeddingBagCollection`
 
   * embedding sharders that define sharding for any sharded module implementation.
   * support for various compute kernels, which are optimized for compute device
     (CPU/GPU) and may include batching together embedding tables and/or optimizer
     fusion.
-    
+
 * pipelined training through `TrainPipelineSparseDist` that overlaps dataloading
   device transfer (copy to GPU), inter*device communications (input_dist), and
   computation (forward, backward) for increased performance.
 * quantization support for reduced precision training and inference.
 
 """
 
 from torchrec.distributed.comm import get_local_rank, get_local_size  # noqa
 from torchrec.distributed.model_parallel import DistributedModelParallel  # noqa
 from torchrec.distributed.train_pipeline import (  # noqa
+    PrefetchTrainPipelineSparseDist,
     TrainPipeline,
     TrainPipelineBase,
     TrainPipelineSparseDist,
 )
 from torchrec.distributed.types import (  # noqa
     Awaitable,
     ModuleSharder,
```

## torchrec/distributed/sharding_plan.py

```diff
@@ -140,26 +140,37 @@
 
     for i in range(num_devices - 1):
         shard_offsets.append([shard_sizes[i][0] + shard_offsets[i][0], 0])
 
     return shard_sizes, shard_offsets
 
 
+def _find_base_dim(lower_bound: int, dim: int) -> int:
+    for i in range(lower_bound, dim):
+        if dim % i == 0 and i % 4 == 0:
+            return i
+    return dim
+
+
 def _calculate_cw_shard_sizes_and_offsets(
     columns: int,
     rows: int,
     col_wise_shard_dim: Optional[int] = None,
 ) -> Tuple[List[List[int]], List[List[int]]]:
     block_size: int = min(
-        col_wise_shard_dim if col_wise_shard_dim else MIN_CW_DIM, columns
+        _find_base_dim(col_wise_shard_dim, columns)
+        if col_wise_shard_dim
+        else _find_base_dim(MIN_CW_DIM, columns),
+        columns,
     )
 
     if columns % block_size != 0:
         warnings.warn(
-            f"Dim of {columns} cannot be evenly divided with column wise shard dim {col_wise_shard_dim}, overriding block_size to embedding_dim={columns}",
+            f"Dim of {columns} cannot be evenly divided with column wise shard"
+            "dim {col_wise_shard_dim}, overriding block_size to embedding_dim={columns}",
             UserWarning,
         )
         block_size = columns
 
     num_col_wise_shards, _residual = divmod(columns, block_size)
 
     shard_sizes: List[List[int]] = [[rows, block_size]] * num_col_wise_shards
```

## torchrec/distributed/train_pipeline.py

```diff
@@ -555,15 +555,17 @@
     context: TrainPipelineContext,
 ) -> None:
     context.input_dist_splits_requests.clear()
     context.module_contexts_next_batch.clear()
     context.fused_splits_awaitables.clear()
     for module in pipelined_modules:
         forward = module.forward
-        assert isinstance(forward, PipelinedForward)
+        assert isinstance(forward, PipelinedForward) or isinstance(
+            forward, PrefetchPipelinedForward
+        )
 
         # Retrieve argument for the input_dist of EBC
         # is_getitem True means this argument could be retrieved by a list
         # False means this argument is getting while getattr
         # and this info was done in the _rewrite_model by tracing the
         # entire model to get the arg_info_list
         args = []
```

## torchrec/distributed/planner/storage_reservations.py

```diff
@@ -82,22 +82,19 @@
 
     return dense_tensor_storage
 
 
 def _reserve_kjt_storage(
     topology: Topology,
     batch_size: int,
-    input_lengths: List[float],
+    batch_inputs: List[float],
     input_data_type_size: int,
     multiplier: int,
 ) -> Storage:
-    kjt_size = (
-        math.ceil(float(batch_size) * sum(input_lengths) * float(input_data_type_size))
-        * multiplier
-    )
+    kjt_size = math.ceil(sum(batch_inputs) * float(input_data_type_size)) * multiplier
 
     kjt_storage = Storage(
         hbm=kjt_size if topology.compute_device == "cuda" else 0,
         ddr=kjt_size if topology.compute_device == "cpu" else 0,
     )
 
     for device in topology.devices:
@@ -145,14 +142,65 @@
             )
 
     populate_shardable_modules(module)
 
     return input_lengths, shardable_modules
 
 
+def _get_batch_inputs_and_shardable_parameters(
+    module: nn.Module,
+    sharders: List[ModuleSharder[nn.Module]],
+    batch_size: int,
+    constraints: Optional[Dict[str, ParameterConstraints]] = None,
+) -> Tuple[List[float], Set[nn.Module]]:
+    sharder_map: Dict[str, ModuleSharder[nn.Module]] = {
+        sharder_name(sharder.module_type): sharder for sharder in sharders
+    }
+    input_lengths: List[float] = []
+    batch_sizes: List[int] = []
+    shardable_modules: Set[nn.Module] = set()
+
+    def populate_shardable_modules(
+        module: nn.Module,
+    ) -> None:
+        sharder_key = sharder_name(type(module))
+        sharder = sharder_map.get(sharder_key)
+
+        if not sharder:
+            for _child_name, child in module.named_children():
+                populate_shardable_modules(child)
+        else:
+            names = sharder.shardable_parameters(module).keys()
+            shardable_modules.add(module)
+
+            for name in names:
+                pooling_factors = (
+                    constraints[name].pooling_factors
+                    if constraints and constraints.get(name)
+                    else [POOLING_FACTOR]
+                )
+                input_lengths.extend(pooling_factors)
+                batch_sizes.extend(
+                    constraints[name].batch_sizes  # pyre-ignore[6]
+                    if constraints
+                    and constraints.get(name)
+                    and constraints[name].batch_sizes
+                    else [batch_size] * len(pooling_factors)
+                )
+
+    populate_shardable_modules(module)
+
+    batch_inputs: List[float] = [
+        input_length * batch_size
+        for input_length, batch_size in zip(input_lengths, batch_sizes)
+    ]
+
+    return batch_inputs, shardable_modules
+
+
 class FixedPercentageStorageReservation(StorageReservation):
     def __init__(self, percentage: float) -> None:
         assert percentage >= 0 and percentage <= 1
         self._percentage: float = percentage
 
     def reserve(
         self,
@@ -203,16 +251,16 @@
         batch_size: int,
         module: nn.Module,
         sharders: List[ModuleSharder[nn.Module]],
         constraints: Optional[Dict[str, ParameterConstraints]] = None,
     ) -> Topology:
         reserved_topology = copy.deepcopy(topology)
 
-        input_lengths, shardable_modules = _get_input_lengths_and_shardable_parameters(
-            module, sharders, constraints
+        batch_inputs, shardable_modules = _get_batch_inputs_and_shardable_parameters(
+            module, sharders, batch_size, constraints
         )
 
         _reserve_storage_percentage(reserved_topology, self._percentage)
 
         self._dense_storage = _reserve_dense_storage(
             topology=reserved_topology,
             module=module,
@@ -220,15 +268,15 @@
             multiplier=self._parameter_multiplier,
             dense_tensor_estimate=self._dense_tensor_estimate,
         )
 
         self._kjt_storage = _reserve_kjt_storage(
             topology=reserved_topology,
             batch_size=batch_size,
-            input_lengths=input_lengths,
+            batch_inputs=batch_inputs,
             input_data_type_size=BIGINT_DTYPE,
             # 2 pipelined batches each with 10 internal copies
             multiplier=20,
         )
 
         if reserved_topology.devices[0].storage.hbm < 0:
             negative_storage_solution = (
@@ -288,16 +336,16 @@
         batch_size: int,
         module: nn.Module,
         sharders: List[ModuleSharder[nn.Module]],
         constraints: Optional[Dict[str, ParameterConstraints]] = None,
     ) -> Topology:
         reserved_topology = copy.deepcopy(topology)
 
-        input_lengths, shardable_modules = _get_input_lengths_and_shardable_parameters(
-            module, sharders, constraints
+        batch_inputs, shardable_modules = _get_batch_inputs_and_shardable_parameters(
+            module, sharders, batch_size, constraints
         )
 
         _reserve_storage_percentage(reserved_topology, self._percentage)
 
         self._dense_storage = _reserve_dense_storage(
             topology=reserved_topology,
             module=module,
@@ -305,13 +353,13 @@
             multiplier=1,
             dense_tensor_estimate=self._dense_tensor_estimate,
         )
 
         self._kjt_storage = _reserve_kjt_storage(
             topology=reserved_topology,
             batch_size=batch_size,
-            input_lengths=input_lengths,
+            batch_inputs=batch_inputs,
             input_data_type_size=BIGINT_DTYPE,
             multiplier=1,
         )
 
         return reserved_topology
```

## torchrec/sparse/jagged_tensor.py

```diff
@@ -706,14 +706,15 @@
             values=keyed_jagged_tensor.values(),
             lengths=keyed_jagged_tensor.lengths(),
             weights=keyed_jagged_tensor.weights_or_none(),
             jt_dict=keyed_jagged_tensor._jt_dict,
         )
 
 
+@torch.fx.wrap
 def _maybe_compute_kjt_to_jt_dict(
     stride: int,
     keys: List[str],
     length_per_key: List[int],
     values: torch.Tensor,
     lengths: torch.Tensor,
     weights: Optional[torch.Tensor],
```

## Comparing `torchrec_nightly-2023.8.3.dist-info/LICENSE` & `torchrec_nightly-2023.8.5.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `torchrec_nightly-2023.8.3.dist-info/METADATA` & `torchrec_nightly-2023.8.5.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: torchrec-nightly
-Version: 2023.8.3
+Version: 2023.8.5
 Summary: Pytorch domain library for recommendation systems
 Home-page: https://github.com/pytorch/torchrec
 Author: TorchRec Team
 Author-email: packages@pytorch.org
 License: BSD-3
 Keywords: pytorch,recommendation systems,sharding
 Classifier: Development Status :: 4 - Beta
```

## Comparing `torchrec_nightly-2023.8.3.dist-info/RECORD` & `torchrec_nightly-2023.8.5.dist-info/RECORD`

 * *Files 5% similar despite different names*

```diff
@@ -8,15 +8,15 @@
 torchrec/datasets/utils.py,sha256=eQDJJCkEl60pmgc7z1yjKcl-OrNQImflhhmohI-CuL0,10909
 torchrec/datasets/scripts/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 torchrec/datasets/scripts/contiguous_preproc_criteo.py,sha256=8jjtDiQScJH6R4FfKLgJ3fm-FzfnJxyfbV52zj3SM_8,2448
 torchrec/datasets/scripts/npy_preproc_criteo.py,sha256=QOyHZpPGL6HtPrVijk7qTALvnDqgecWPEZxKB_eVA94,2847
 torchrec/datasets/scripts/shuffle_preproc_criteo.py,sha256=PC1t5EkJkG6qu3ioewAVZM-Bnzo01HKMUH92IprFth0,3077
 torchrec/datasets/test_utils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 torchrec/datasets/test_utils/criteo_test_utils.py,sha256=Ob2fJniGOsfbWNF_Gy2RJhrGAVnLAFPSlUTJOp2kay4,5308
-torchrec/distributed/__init__.py,sha256=VCy8GKOM-1dejxUWNSA3gozG3HQ4x5-Y9c9-WFbAMGg,1912
+torchrec/distributed/__init__.py,sha256=sgwN1dgwbW4W21vxAhqF3hHPievHxlm9MYwuDEsDw9k,1945
 torchrec/distributed/batched_embedding_kernel.py,sha256=uBFpJTxGTKKaye-kCA4Ou-sh6rpg_6K0JAfiZhqAyvw,37307
 torchrec/distributed/collective_utils.py,sha256=r7Aawq-KSVC-HjjEd6U8k0vNnRMx_-8_sAhYdElGaJw,2069
 torchrec/distributed/comm.py,sha256=21Std9n_HJCF3Nsw9O4yQQOJuL2DUVzZzoRhH3M6my8,4988
 torchrec/distributed/comm_ops.py,sha256=1GOJQEoRPystHePHLDSf-qavv84MkVwSqLVgYSdg6LU,56136
 torchrec/distributed/dist_data.py,sha256=bsRALYTMWxDTqj3DpRctnA6g9pyCx-iIE5dKkCQIA6M,36889
 torchrec/distributed/embedding.py,sha256=ctrHHtWFq5ITPOucAbO2UQ2cRdeDPKRFyHd04lhYmPo,32295
 torchrec/distributed/embedding_kernel.py,sha256=9OA5PDofQZ-ZRORNR4Ca1pJoEZk5Oj2gE6axYwcXIds,4947
@@ -34,30 +34,30 @@
 torchrec/distributed/mc_embeddingbag.py,sha256=3_cm7HF53Lj12DJ271yfN1cbjbdxxYRpBCQUWySNsWc,10997
 torchrec/distributed/model_parallel.py,sha256=VV9Vsyas0VKNHr8sX9pq1iT_xJ2b9xjenY3pYAY5HYw,19750
 torchrec/distributed/quant_embedding.py,sha256=9hTS4oUYkoCEHInYO7r0IQjfAJi4fsw5WNiTOHGUJuM,20748
 torchrec/distributed/quant_embedding_kernel.py,sha256=VsROr4bXBkYysS0H7NnlZzF7IvGgZFtgws5jsnPf6g4,15112
 torchrec/distributed/quant_embeddingbag.py,sha256=SJPY-nL95LKozfT8iR4SHt1BNLx4OcoAfFvqKzy1Gf4,12621
 torchrec/distributed/quant_state.py,sha256=PDQ7qUwhFt-q1WvTkoSbWE3rotiFOYyKNFsQ5vJQ36U,13928
 torchrec/distributed/shard.py,sha256=4Dr5ixWCoMEFEuL5WN4fL2gIdl9wmSUjZWsiF-kdCdQ,9261
-torchrec/distributed/sharding_plan.py,sha256=DftThfyzPvfFzg7SvqsNo7X5n-1rxWhp1RlcQCcpq2o,19646
-torchrec/distributed/train_pipeline.py,sha256=pQAy5HrnnglG51uWFJCSt3r33BMYHP8STyefYQc7dA4,48681
+torchrec/distributed/sharding_plan.py,sha256=xYM8l3JpqURxfZwFPwQtSTrfg9qM3dp20PAYEGROHfI,19906
+torchrec/distributed/train_pipeline.py,sha256=weqXkMGeL-O4WVlQ_hQ03pfiiGOaGG5ISKp5K2-gBvQ,48752
 torchrec/distributed/types.py,sha256=a7kNk8HdIQjyBTyq0rmBY7wn3CyGW7hk3rDC9XzWvAU,26441
 torchrec/distributed/utils.py,sha256=dwNuXu5_OOK0YsGZhGPIdtZu4GzvT6X1MPsARINy10U,15470
 torchrec/distributed/composable/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 torchrec/distributed/composable/table_batched_embedding_slice.py,sha256=x439M8TTXQtzoihan1OKKbmGYkqJlAxxTHCDz5295RY,3207
 torchrec/distributed/planner/__init__.py,sha256=UWnxb-SuE211uJGdwtSkKRVADT3plQozB2l6fvs6Ve0,1025
 torchrec/distributed/planner/constants.py,sha256=MkeVqYO2QGg57i6fs29lZb2dScaaR9mdQVsee4NxyFc,3135
 torchrec/distributed/planner/enumerators.py,sha256=JoQ1WcrU12Fyy57aBHitcKIpBTASJVnyLhkOxN7V4J4,11430
 torchrec/distributed/planner/partitioners.py,sha256=k-rzm6oMZ_sLpGHT8yAu2tIMkMumhJMvAFeY0cdNirk,12642
 torchrec/distributed/planner/perf_models.py,sha256=vYIjVr0NG6sZItfxVuRWF7AS8lGGtbRn66O0flNJpoU,835
 torchrec/distributed/planner/planners.py,sha256=Fqm-k0p119BY3k6o3qxHwY8JfCZlQaFtTRZJt3pXhdE,13803
 torchrec/distributed/planner/proposers.py,sha256=tfhI0DavpRYfY4UN5diXBMl8fWHIEm8wNco5R6yBIGI,11236
 torchrec/distributed/planner/shard_estimators.py,sha256=QTW2OdGRaBnOp79xRiUz5W3O9oxS9m4wlAqP-goHCi4,41291
 torchrec/distributed/planner/stats.py,sha256=nSlFy12f2mhuCbuGZ-jzCi8-L0AXMF7-1BOZN0BVSwo,24082
-torchrec/distributed/planner/storage_reservations.py,sha256=DxFY7ws-cBlhK0E8Z9cypevS2aPaptD8o901-xUlehQ,11109
+torchrec/distributed/planner/storage_reservations.py,sha256=bq2uRVTgkz1BxJghW9d_Wl08YfQgomfukZXiRVdf2Os,12858
 torchrec/distributed/planner/types.py,sha256=FHe0shRgJJ8Kvqnb9IpNV7Aphqsga2wcZ6dXTmI_M7s,14582
 torchrec/distributed/planner/utils.py,sha256=4dD84n7rGUGfCT8tbtPVVNN-iFBnDpb5eyyPxvWru3k,1431
 torchrec/distributed/sharding/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 torchrec/distributed/sharding/cw_sequence_sharding.py,sha256=N5qRxCxDkhT0ZcOAUBDTuhQTAz3_I7B1cN_pFeleBbk,2479
 torchrec/distributed/sharding/cw_sharding.py,sha256=K6Nc8JaQxENSaOPv4rMZytW6FE7wGlKxXj78RZOx6QE,12945
 torchrec/distributed/sharding/dp_sequence_sharding.py,sha256=zQmERguEGVd5IAbmVsIhqdKXb0f2g8tQamN838qVvfM,2802
 torchrec/distributed/sharding/dp_sharding.py,sha256=HSedwv3zCoi-WGElzucyqDMolrviB6tyqs1jN-6RTEY,7681
@@ -134,15 +134,15 @@
 torchrec/optim/rowwise_adagrad.py,sha256=jHpCZDFWRrXbwlKiwROg2dl0qK1lG2uXMJkTtbZ_uSg,7405
 torchrec/optim/warmup.py,sha256=QaMcWU-jMZbDOfRHEH_x9r7EsjtI_LRgOGAmEgzJWSQ,4865
 torchrec/optim/test_utils/__init__.py,sha256=mkNZr5iNV3kseuamPBnnAeknjbv4ELPFMGyJ1lWiJGU,560
 torchrec/quant/__init__.py,sha256=A6NIA6ztq6iP1JTLRLNzlgnCcd-LaN8efnxGub3Ii4A,1140
 torchrec/quant/embedding_modules.py,sha256=-_5_HaoNpt3AmL7fapO2Wj2r6WPjbq2VvATNmGhrai0,26618
 torchrec/quant/utils.py,sha256=rcyo5LDcLK49VLs6ZFxOHeutblWZunDAM_T-0NsraDE,4292
 torchrec/sparse/__init__.py,sha256=dLqSye4Jo6obnNNTUKdPDxPQb9sL2U4weemSn-DjpYk,1163
-torchrec/sparse/jagged_tensor.py,sha256=__iBD2tBQE9ZZpxcOn8RVmDF9gognnyUlmMjedHxJ4E,56412
+torchrec/sparse/jagged_tensor.py,sha256=i7bqXkDMZOEW1eXiluYq1bdYFxOgUDGqYtI7vIaYUBs,56427
 torchrec/sparse/test_utils/__init__.py,sha256=BLxfGKJvwjjCiQM64O5wGAA_Cea0sG-buw9lTDWuqug,1430
 torchrec/test_utils/__init__.py,sha256=JncJcXS4N3gI7-fsizQ2-qiWM6MhIrpvskF_9gDf0Go,5661
-torchrec_nightly-2023.8.3.dist-info/LICENSE,sha256=e0Eotbf_rHOYPuEUlppIbvwy4SN98CZnl_hqwvbDA4Q,1530
-torchrec_nightly-2023.8.3.dist-info/METADATA,sha256=TzeH8XdECnwXbTH32LzUFO3q9GFQNBuALSG2qdGyCVw,5011
-torchrec_nightly-2023.8.3.dist-info/WHEEL,sha256=ns_9KNZvwSNZtRgVV_clzMUG_fXjGc5Z8Tx4hxQ0gkw,93
-torchrec_nightly-2023.8.3.dist-info/top_level.txt,sha256=LoLcTAPLj_7x62AuyYmhEVBcx2WJ1Z1Nrknv0Jnk_gQ,9
-torchrec_nightly-2023.8.3.dist-info/RECORD,,
+torchrec_nightly-2023.8.5.dist-info/LICENSE,sha256=e0Eotbf_rHOYPuEUlppIbvwy4SN98CZnl_hqwvbDA4Q,1530
+torchrec_nightly-2023.8.5.dist-info/METADATA,sha256=thfhavjdlwQkVrXXDF5Kf-eWKTqOuPl9pxeA_TUD7DE,5011
+torchrec_nightly-2023.8.5.dist-info/WHEEL,sha256=ns_9KNZvwSNZtRgVV_clzMUG_fXjGc5Z8Tx4hxQ0gkw,93
+torchrec_nightly-2023.8.5.dist-info/top_level.txt,sha256=LoLcTAPLj_7x62AuyYmhEVBcx2WJ1Z1Nrknv0Jnk_gQ,9
+torchrec_nightly-2023.8.5.dist-info/RECORD,,
```

