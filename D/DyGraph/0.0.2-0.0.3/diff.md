# Comparing `tmp/DyGraph-0.0.2.tar.gz` & `tmp/DyGraph-0.0.3.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "DyGraph-0.0.2.tar", last modified: Sat Aug  5 22:49:40 2023, max compression
+gzip compressed data, was "DyGraph-0.0.3.tar", last modified: Sun Aug  6 01:28:42 2023, max compression
```

## Comparing `DyGraph-0.0.2.tar` & `DyGraph-0.0.3.tar`

### file list

```diff
@@ -1,27 +1,27 @@
-drwxrwxrwx   0        0        0        0 2023-08-05 22:49:40.465489 DyGraph-0.0.2/
--rw-rw-rw-   0        0        0     1102 2023-06-07 13:00:07.000000 DyGraph-0.0.2/LICENSE
--rw-rw-rw-   0        0        0     3286 2023-08-05 22:49:40.466549 DyGraph-0.0.2/PKG-INFO
--rw-rw-rw-   0        0        0     2374 2023-06-07 13:00:07.000000 DyGraph-0.0.2/README.md
--rw-rw-rw-   0        0        0      228 2023-06-07 13:00:07.000000 DyGraph-0.0.2/pyproject.toml
--rw-rw-rw-   0        0        0     1143 2023-08-05 22:49:40.475360 DyGraph-0.0.2/setup.cfg
--rw-rw-rw-   0        0        0       71 2023-06-07 13:00:07.000000 DyGraph-0.0.2/setup.py
-drwxrwxrwx   0        0        0        0 2023-08-05 22:49:40.287943 DyGraph-0.0.2/src/
-drwxrwxrwx   0        0        0        0 2023-08-05 22:49:40.349377 DyGraph-0.0.2/src/CovReg/
--rw-rw-rw-   0        0        0      334 2023-08-04 07:50:57.000000 DyGraph-0.0.2/src/CovReg/__init__.py
--rw-rw-rw-   0        0        0     9076 2023-08-05 21:37:01.000000 DyGraph-0.0.2/src/CovReg/covreg.py
--rw-rw-rw-   0        0        0    13227 2023-08-05 01:55:39.000000 DyGraph-0.0.2/src/CovReg/graphcovreg.py
-drwxrwxrwx   0        0        0        0 2023-08-05 22:49:40.381201 DyGraph-0.0.2/src/DyGraph/
--rw-rw-rw-   0        0        0     5064 2023-06-07 13:00:07.000000 DyGraph-0.0.2/src/DyGraph/RootDygl.py
--rw-rw-rw-   0        0        0      250 2023-08-04 03:06:35.000000 DyGraph-0.0.2/src/DyGraph/__init__.py
--rw-rw-rw-   0        0        0    11758 2023-07-23 00:51:58.000000 DyGraph-0.0.2/src/DyGraph/dyg_outer_em.py
--rw-rw-rw-   0        0        0    11690 2023-07-23 00:51:58.000000 DyGraph-0.0.2/src/DyGraph/dygl_inner_em.py
--rw-rw-rw-   0        0        0    24554 2023-06-07 13:00:07.000000 DyGraph-0.0.2/src/DyGraph/dygl_utils.py
--rw-rw-rw-   0        0        0     4581 2023-06-07 13:00:07.000000 DyGraph-0.0.2/src/DyGraph/sgl_inner_em.py
--rw-rw-rw-   0        0        0     4924 2023-06-07 13:00:07.000000 DyGraph-0.0.2/src/DyGraph/sgl_outer_em.py
-drwxrwxrwx   0        0        0        0 2023-08-05 22:49:40.461760 DyGraph-0.0.2/src/DyGraph.egg-info/
--rw-rw-rw-   0        0        0     3286 2023-08-05 22:49:40.000000 DyGraph-0.0.2/src/DyGraph.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      516 2023-08-05 22:49:40.000000 DyGraph-0.0.2/src/DyGraph.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-08-05 22:49:40.000000 DyGraph-0.0.2/src/DyGraph.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0        2 2023-08-05 22:46:00.000000 DyGraph-0.0.2/src/DyGraph.egg-info/not-zip-safe
--rw-rw-rw-   0        0        0       91 2023-08-05 22:49:40.000000 DyGraph-0.0.2/src/DyGraph.egg-info/requires.txt
--rw-rw-rw-   0        0        0       15 2023-08-05 22:49:40.000000 DyGraph-0.0.2/src/DyGraph.egg-info/top_level.txt
+drwxrwxrwx   0        0        0        0 2023-08-06 01:28:42.022199 DyGraph-0.0.3/
+-rw-rw-rw-   0        0        0     1102 2023-06-07 13:00:07.000000 DyGraph-0.0.3/LICENSE
+-rw-rw-rw-   0        0        0     3286 2023-08-06 01:28:42.023198 DyGraph-0.0.3/PKG-INFO
+-rw-rw-rw-   0        0        0     2374 2023-06-07 13:00:07.000000 DyGraph-0.0.3/README.md
+-rw-rw-rw-   0        0        0      228 2023-06-07 13:00:07.000000 DyGraph-0.0.3/pyproject.toml
+-rw-rw-rw-   0        0        0     1143 2023-08-06 01:28:42.031995 DyGraph-0.0.3/setup.cfg
+-rw-rw-rw-   0        0        0       71 2023-06-07 13:00:07.000000 DyGraph-0.0.3/setup.py
+drwxrwxrwx   0        0        0        0 2023-08-06 01:28:41.954260 DyGraph-0.0.3/src/
+drwxrwxrwx   0        0        0        0 2023-08-06 01:28:41.960735 DyGraph-0.0.3/src/CovReg/
+-rw-rw-rw-   0        0        0      334 2023-08-04 07:50:57.000000 DyGraph-0.0.3/src/CovReg/__init__.py
+-rw-rw-rw-   0        0        0     8635 2023-08-06 01:23:23.000000 DyGraph-0.0.3/src/CovReg/covreg.py
+-rw-rw-rw-   0        0        0    13036 2023-08-06 01:23:58.000000 DyGraph-0.0.3/src/CovReg/graphcovreg.py
+drwxrwxrwx   0        0        0        0 2023-08-06 01:28:41.991670 DyGraph-0.0.3/src/DyGraph/
+-rw-rw-rw-   0        0        0     5064 2023-06-07 13:00:07.000000 DyGraph-0.0.3/src/DyGraph/RootDygl.py
+-rw-rw-rw-   0        0        0      250 2023-08-04 03:06:35.000000 DyGraph-0.0.3/src/DyGraph/__init__.py
+-rw-rw-rw-   0        0        0    11758 2023-07-23 00:51:58.000000 DyGraph-0.0.3/src/DyGraph/dyg_outer_em.py
+-rw-rw-rw-   0        0        0    11690 2023-07-23 00:51:58.000000 DyGraph-0.0.3/src/DyGraph/dygl_inner_em.py
+-rw-rw-rw-   0        0        0    24554 2023-06-07 13:00:07.000000 DyGraph-0.0.3/src/DyGraph/dygl_utils.py
+-rw-rw-rw-   0        0        0     4581 2023-06-07 13:00:07.000000 DyGraph-0.0.3/src/DyGraph/sgl_inner_em.py
+-rw-rw-rw-   0        0        0     4924 2023-06-07 13:00:07.000000 DyGraph-0.0.3/src/DyGraph/sgl_outer_em.py
+drwxrwxrwx   0        0        0        0 2023-08-06 01:28:42.020206 DyGraph-0.0.3/src/DyGraph.egg-info/
+-rw-rw-rw-   0        0        0     3286 2023-08-06 01:28:41.000000 DyGraph-0.0.3/src/DyGraph.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      516 2023-08-06 01:28:41.000000 DyGraph-0.0.3/src/DyGraph.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-08-06 01:28:41.000000 DyGraph-0.0.3/src/DyGraph.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0        2 2023-08-05 22:46:00.000000 DyGraph-0.0.3/src/DyGraph.egg-info/not-zip-safe
+-rw-rw-rw-   0        0        0       91 2023-08-06 01:28:41.000000 DyGraph-0.0.3/src/DyGraph.egg-info/requires.txt
+-rw-rw-rw-   0        0        0       15 2023-08-06 01:28:41.000000 DyGraph-0.0.3/src/DyGraph.egg-info/top_level.txt
```

### Comparing `DyGraph-0.0.2/LICENSE` & `DyGraph-0.0.3/LICENSE`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.2/PKG-INFO` & `DyGraph-0.0.3/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: DyGraph
-Version: 0.0.2
+Version: 0.0.3
 Summary: A package for estimating dynamic graphical lasso with heavy tailed distributions
 Home-page: https://github.com/ragnarlevi/DyGraph
 Author: ragnarlevi
 License: MIT
 Project-URL: Bug Tracker, https://github.com/ragnarlevi/DyGraph/issues
 Platform: unix
 Platform: linux
```

### Comparing `DyGraph-0.0.2/README.md` & `DyGraph-0.0.3/README.md`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.2/setup.cfg` & `DyGraph-0.0.3/setup.cfg`

 * *Files 0% similar despite different names*

```diff
@@ -9,15 +9,15 @@
 00000080: 5f64 6573 6372 6970 7469 6f6e 203d 2066  _description = f
 00000090: 696c 653a 2052 4541 444d 452e 6d64 0d0a  ile: README.md..
 000000a0: 6c6f 6e67 5f64 6573 6372 6970 7469 6f6e  long_description
 000000b0: 5f63 6f6e 7465 6e74 5f74 7970 6520 3d20  _content_type = 
 000000c0: 7465 7874 2f6d 6172 6b64 6f77 6e0d 0a61  text/markdown..a
 000000d0: 7574 686f 7220 3d20 7261 676e 6172 6c65  uthor = ragnarle
 000000e0: 7669 0d0a 7665 7273 696f 6e20 3d20 302e  vi..version = 0.
-000000f0: 302e 320d 0a6c 6963 656e 7365 203d 204d  0.2..license = M
+000000f0: 302e 330d 0a6c 6963 656e 7365 203d 204d  0.3..license = M
 00000100: 4954 0d0a 6c69 6365 6e73 655f 6669 6c65  IT..license_file
 00000110: 203d 204c 4943 454e 5345 0d0a 7572 6c20   = LICENSE..url 
 00000120: 3d20 6874 7470 733a 2f2f 6769 7468 7562  = https://github
 00000130: 2e63 6f6d 2f72 6167 6e61 726c 6576 692f  .com/ragnarlevi/
 00000140: 4479 4772 6170 680d 0a70 6c61 7466 6f72  DyGraph..platfor
 00000150: 6d73 203d 2075 6e69 782c 206c 696e 7578  ms = unix, linux
 00000160: 2c20 6f73 782c 2063 7967 7769 6e2c 2077  , osx, cygwin, w
```

### Comparing `DyGraph-0.0.2/src/CovReg/covreg.py` & `DyGraph-0.0.3/src/CovReg/covreg.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,568 +1,540 @@
-00000000: 0d0a 696d 706f 7274 2072 6571 7565 7374  ..import request
-00000010: 730d 0a69 6d70 6f72 7420 7061 6e64 6173  s..import pandas
-00000020: 2061 7320 7064 0d0a 696d 706f 7274 206e   as pd..import n
-00000030: 756d 7079 2061 7320 6e70 0d0a 6672 6f6d  umpy as np..from
-00000040: 2073 6b6c 6561 726e 2e70 7265 7072 6f63   sklearn.preproc
-00000050: 6573 7369 6e67 2069 6d70 6f72 7420 5374  essing import St
-00000060: 616e 6461 7264 5363 616c 6572 0d0a 6672  andardScaler..fr
-00000070: 6f6d 2073 6369 7079 2e73 7461 7473 2069  om scipy.stats i
-00000080: 6d70 6f72 7420 6d75 6c74 6976 6172 6961  mport multivaria
-00000090: 7465 5f6e 6f72 6d61 6c0d 0a69 6d70 6f72  te_normal..impor
-000000a0: 7420 6e65 7477 6f72 6b78 2061 7320 6e78  t networkx as nx
-000000b0: 0d0a 696d 706f 7274 2079 6669 6e61 6e63  ..import yfinanc
-000000c0: 6520 6173 2079 660d 0a69 6d70 6f72 7420  e as yf..import 
-000000d0: 7379 730d 0a73 7973 2e70 6174 682e 696e  sys..sys.path.in
-000000e0: 7365 7274 2830 2c20 2743 3a2f 5573 6572  sert(0, 'C:/User
-000000f0: 732f 5573 6572 2f43 6f64 652f 4479 4772  s/User/Code/DyGr
-00000100: 6170 6827 290d 0a73 7973 2e70 6174 682e  aph')..sys.path.
-00000110: 696e 7365 7274 2830 2c20 2743 3a2f 5573  insert(0, 'C:/Us
-00000120: 6572 732f 5573 6572 2f43 6f64 652f 4479  ers/User/Code/Dy
-00000130: 4772 6170 682f 7372 6327 290d 0a0d 0a69  Graph/src')....i
-00000140: 6d70 6f72 7420 4479 4772 6170 6820 6173  mport DyGraph as
-00000150: 2064 670d 0a69 6d70 6f72 7420 706f 7274   dg..import port
-00000160: 5f6d 6561 7375 7265 7320 6173 2070 6d0d  _measures as pm.
-00000170: 0a69 6d70 6f72 7420 6d61 7470 6c6f 746c  .import matplotl
-00000180: 6962 2e70 7970 6c6f 7420 6173 2070 6c74  ib.pyplot as plt
-00000190: 0d0a 696d 706f 7274 2074 7164 6d0d 0a69  ..import tqdm..i
-000001a0: 6d70 6f72 7420 7363 6970 790d 0a66 726f  mport scipy..fro
-000001b0: 6d20 7363 6970 792e 6f70 7469 6d69 7a65  m scipy.optimize
-000001c0: 2069 6d70 6f72 7420 6d69 6e69 6d69 7a65   import minimize
-000001d0: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2069  ..from sklearn i
-000001e0: 6d70 6f72 7420 6c69 6e65 6172 5f6d 6f64  mport linear_mod
-000001f0: 656c 0d0a 0d0a 0d0a 0d0a 0d0a 636c 6173  el..........clas
-00000200: 7320 436f 7652 6567 2829 3a0d 0a0d 0a20  s CovReg():.... 
-00000210: 2020 200d 0a20 2020 2064 6566 205f 5f69     ..    def __i
-00000220: 6e69 745f 5f28 7365 6c66 2c20 592c 2061  nit__(self, Y, a
-00000230: 6c70 6861 2c20 6d61 785f 6974 6572 203d  lpha, max_iter =
-00000240: 2031 3030 2c20 746f 6c20 3d20 3165 2d36   100, tol = 1e-6
-00000250: 2c20 646f 5f61 6c6c 5f69 7465 7220 3d20  , do_all_iter = 
-00000260: 4661 6c73 6529 202d 3e20 4e6f 6e65 3a0d  False) -> None:.
-00000270: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
-00000280: 5920 3d20 590d 0a20 2020 2020 2020 2073  Y = Y..        s
-00000290: 656c 662e 6d61 785f 6974 6572 203d 206d  elf.max_iter = m
-000002a0: 6178 5f69 7465 720d 0a20 2020 2020 2020  ax_iter..       
-000002b0: 2073 656c 662e 746f 6c20 3d20 746f 6c0d   self.tol = tol.
-000002c0: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
-000002d0: 6420 3d20 592e 7368 6170 655b 315d 0d0a  d = Y.shape[1]..
-000002e0: 2020 2020 2020 2020 7365 6c66 2e6e 203d          self.n =
-000002f0: 2059 2e73 6861 7065 5b30 5d0d 0a0d 0a20   Y.shape[0].... 
-00000300: 2020 2020 2020 2073 656c 662e 616c 7068         self.alph
-00000310: 6120 3d20 7365 6c66 2e6e 2a61 6c70 6861  a = self.n*alpha
-00000320: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-00000330: 2e77 6974 685f 6772 6170 6820 3d20 4661  .with_graph = Fa
-00000340: 6c73 650d 0a20 2020 2020 2020 2073 656c  lse..        sel
-00000350: 662e 646f 5f61 6c6c 5f69 7465 7220 3d20  f.do_all_iter = 
-00000360: 646f 5f61 6c6c 5f69 7465 720d 0a0d 0a0d  do_all_iter.....
-00000370: 0a0d 0a20 2020 2040 7374 6174 6963 6d65  ...    @staticme
-00000380: 7468 6f64 0d0a 2020 2020 6465 6620 6c61  thod..    def la
-00000390: 7373 6f5f 6f62 6a65 6374 6976 6528 7061  sso_objective(pa
-000003a0: 7261 6d2c 2058 2c20 592c 5073 695f 696e  ram, X, Y,Psi_in
-000003b0: 762c 2064 2c72 2c20 616c 7068 6129 2d3e  v, d,r, alpha)->
-000003c0: 7475 706c 653a 0d0a 2020 2020 2020 2020  tuple:..        
-000003d0: 2222 2222 0d0a 2020 2020 2020 2020 4f62  """"..        Ob
-000003e0: 6a65 6374 6976 6520 616e 6420 6772 6164  jective and grad
-000003f0: 6965 6e74 2074 6f20 7061 7373 2069 6e74  ient to pass int
-00000400: 6f20 7468 6520 4c2d 4246 4753 2d42 2073  o the L-BFGS-B s
-00000410: 6f6c 7665 7220 746f 2073 6f6c 7665 2074  olver to solve t
-00000420: 6865 206c 6173 736f 2070 726f 626c 656d  he lasso problem
-00000430: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-00000440: 2020 2020 2020 2020 4320 3d20 6e70 2e72          C = np.r
-00000450: 6573 6861 7065 2870 6172 616d 5b3a 722a  eshape(param[:r*
-00000460: 645d 2d70 6172 616d 5b72 2a64 3a5d 2c28  d]-param[r*d:],(
-00000470: 642c 7229 290d 0a20 2020 2020 2020 206f  d,r))..        o
-00000480: 626a 203d 2020 6e70 2e74 7261 6365 286e  bj =  np.trace(n
-00000490: 702e 646f 7428 2859 2d20 6e70 2e64 6f74  p.dot((Y- np.dot
-000004a0: 2858 2c43 2e54 2929 2e54 2c28 592d 206e  (X,C.T)).T,(Y- n
-000004b0: 702e 646f 7428 582c 432e 5429 2929 2e64  p.dot(X,C.T))).d
-000004c0: 6f74 2850 7369 5f69 6e76 2929 202b 2061  ot(Psi_inv)) + a
-000004d0: 6c70 6861 2a70 6172 616d 2e73 756d 2829  lpha*param.sum()
-000004e0: 0d0a 2020 2020 2020 2020 745f 3020 3d20  ..        t_0 = 
-000004f0: 592e 542d 6e70 2e64 6f74 2843 2c58 2e54  Y.T-np.dot(C,X.T
-00000500: 290d 0a20 2020 2020 2020 2067 7261 6420  )..        grad 
-00000510: 3d20 282d 302e 352a 6e70 2e64 6f74 2874  = (-0.5*np.dot(t
-00000520: 5f30 2c58 2929 2e66 6c61 7474 656e 2829  _0,X)).flatten()
-00000530: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00000540: 206f 626a 2c20 6e70 2e63 6f6e 6361 7465   obj, np.concate
-00000550: 6e61 7465 2828 6772 6164 202b 2061 6c70  nate((grad + alp
-00000560: 6861 202c 202d 2067 7261 6420 2b20 616c  ha , - grad + al
-00000570: 7068 6120 292c 2061 7869 733d 4e6f 6e65  pha ), axis=None
-00000580: 290d 0a20 2020 2020 2020 200d 0a0d 0a20  )..        .... 
-00000590: 2020 2064 6566 2066 696c 7465 725f 7828     def filter_x(
-000005a0: 7365 6c66 293a 0d0a 2020 2020 2020 2020  self):..        
-000005b0: 7061 7373 0d0a 0d0a 2020 2020 6465 6620  pass....    def 
-000005c0: 6669 7428 7365 6c66 293a 0d0a 2020 2020  fit(self):..    
-000005d0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-000005e0: 2057 7261 7070 6572 0d0a 2020 2020 2020   Wrapper..      
-000005f0: 2020 2222 220d 0a20 2020 2020 2020 2070    """..        p
-00000600: 6173 730d 0a0d 0a0d 0a20 2020 2064 6566  ass......    def
-00000610: 206f 6e65 5f69 7465 7261 7469 6f6e 2873   one_iteration(s
-00000620: 656c 662c 2050 7369 5f70 7265 5f69 6e76  elf, Psi_pre_inv
-00000630: 2c20 7073 692c 2043 5f70 7265 2c20 632c  , psi, C_pre, c,
-00000640: 2059 5f74 696c 6465 2c20 5831 203d 204e   Y_tilde, X1 = N
-00000650: 6f6e 652c 2058 3220 3d20 4e6f 6e65 2c20  one, X2 = None, 
-00000660: 465f 7072 6520 3d20 4e6f 6e65 2c20 7769  F_pre = None, wi
-00000670: 7468 5f6d 6561 6e20 3d20 5472 7565 293a  th_mean = True):
-00000680: 0d0a 0d0a 0d0a 2020 2020 2020 2020 7620  ......        v 
-00000690: 3d20 6e70 2e6f 6e65 7328 7365 6c66 2e6e  = np.ones(self.n
-000006a0: 290d 0a20 2020 2020 2020 206d 203d 206e  )..        m = n
-000006b0: 702e 6f6e 6573 2873 656c 662e 6e29 0d0a  p.ones(self.n)..
-000006c0: 0d0a 0d0a 2020 2020 2020 2020 6966 2077  ....        if w
-000006d0: 6974 685f 6d65 616e 3a0d 0a20 2020 2020  ith_mean:..     
-000006e0: 2020 2020 2020 2041 203d 2043 5f70 7265         A = C_pre
-000006f0: 5b3a 2c3a 7365 6c66 2e72 315d 0d0a 2020  [:,:self.r1]..  
-00000700: 2020 2020 2020 2020 2020 4220 3d20 435f            B = C_
-00000710: 7072 655b 3a2c 7365 6c66 2e72 313a 5d0d  pre[:,self.r1:].
-00000720: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00000730: 2020 2020 2020 2020 2020 2020 4120 3d20              A = 
-00000740: 300d 0a20 2020 2020 2020 2020 2020 2042  0..            B
-00000750: 203d 2043 5f70 7265 0d0a 0d0a 0d0a 2020   = C_pre......  
-00000760: 2020 2020 2020 435f 746d 7020 3d20 435f        C_tmp = C_
-00000770: 7072 652e 666c 6174 7465 6e28 290d 0a20  pre.flatten().. 
-00000780: 2020 2020 2020 2043 5f76 6563 203d 206e         C_vec = n
-00000790: 702e 7a65 726f 7328 322a 2873 656c 662e  p.zeros(2*(self.
-000007a0: 7231 2b73 656c 662e 7232 292a 7365 6c66  r1+self.r2)*self
-000007b0: 2e64 290d 0a20 2020 2020 2020 2043 5f76  .d)..        C_v
-000007c0: 6563 5b3a 2873 656c 662e 7231 2b73 656c  ec[:(self.r1+sel
-000007d0: 662e 7232 292a 7365 6c66 2e64 5d20 3d20  f.r2)*self.d] = 
-000007e0: 6e70 2e61 6273 2843 5f74 6d70 2920 2a20  np.abs(C_tmp) * 
-000007f0: 2843 5f74 6d70 3e30 290d 0a20 2020 2020  (C_tmp>0)..     
-00000800: 2020 2043 5f76 6563 5b28 7365 6c66 2e72     C_vec[(self.r
-00000810: 312b 7365 6c66 2e72 3229 2a73 656c 662e  1+self.r2)*self.
-00000820: 643a 5d20 3d20 6e70 2e61 6273 2843 5f74  d:] = np.abs(C_t
-00000830: 6d70 2920 2a20 2843 5f74 6d70 3c30 290d  mp) * (C_tmp<0).
-00000840: 0a0d 0a0d 0a20 2020 2020 2020 2023 2045  .....        # E
-00000850: 2d73 7465 700d 0a20 2020 2020 2020 2066  -step..        f
-00000860: 6f72 2069 2069 6e20 7261 6e67 6528 7365  or i in range(se
-00000870: 6c66 2e6e 293a 0d0a 2020 2020 2020 2020  lf.n):..        
-00000880: 2020 2020 6966 2077 6974 685f 6d65 616e      if with_mean
-00000890: 2026 2028 6e6f 7420 7365 6c66 2e77 6974   & (not self.wit
-000008a0: 685f 6772 6170 6829 3a0d 0a20 2020 2020  h_graph):..     
-000008b0: 2020 2020 2020 2020 2020 2078 5f69 203d             x_i =
-000008c0: 206e 702e 6873 7461 636b 2828 5831 5b69   np.hstack((X1[i
-000008d0: 5d2c 2058 325b 695d 2929 0d0a 2020 2020  ], X2[i]))..    
-000008e0: 2020 2020 2020 2020 2020 2020 765b 695d              v[i]
-000008f0: 203d 2028 312b 6e70 2e64 6f74 2878 5f69   = (1+np.dot(x_i
-00000900: 2e54 2c20 435f 7072 652e 5429 2e64 6f74  .T, C_pre.T).dot
-00000910: 2850 7369 5f70 7265 5f69 6e76 292e 646f  (Psi_pre_inv).do
-00000920: 7428 435f 7072 6529 2e64 6f74 2878 5f69  t(C_pre).dot(x_i
-00000930: 2929 202a 2a20 282d 3129 0d0a 2020 2020  )) ** (-1)..    
-00000940: 2020 2020 2020 2020 2020 2020 6d5b 695d              m[i]
-00000950: 203d 2076 5b69 5d2a 6e70 2e64 6f74 2828   = v[i]*np.dot((
-00000960: 7365 6c66 2e59 5b69 5d2d 6e70 2e64 6f74  self.Y[i]-np.dot
-00000970: 2841 2c20 5831 5b69 5d29 292e 542c 5073  (A, X1[i])).T,Ps
-00000980: 695f 7072 655f 696e 7629 2e64 6f74 2843  i_pre_inv).dot(C
-00000990: 5f70 7265 292e 646f 7428 785f 6929 0d0a  _pre).dot(x_i)..
-000009a0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-000009b0: 2028 6e6f 7420 7769 7468 5f6d 6561 6e29   (not with_mean)
-000009c0: 2026 2028 6e6f 7420 7365 6c66 2e77 6974   & (not self.wit
-000009d0: 685f 6772 6170 6829 3a0d 0a20 2020 2020  h_graph):..     
-000009e0: 2020 2020 2020 2020 2020 2078 5f69 203d             x_i =
-000009f0: 2058 325b 695d 0d0a 2020 2020 2020 2020   X2[i]..        
-00000a00: 2020 2020 2020 2020 765b 695d 203d 2028          v[i] = (
-00000a10: 312b 6e70 2e64 6f74 2878 5f69 2e54 2c20  1+np.dot(x_i.T, 
-00000a20: 435f 7072 652e 5429 2e64 6f74 2850 7369  C_pre.T).dot(Psi
-00000a30: 5f70 7265 5f69 6e76 292e 646f 7428 435f  _pre_inv).dot(C_
-00000a40: 7072 6529 2e64 6f74 2878 5f69 2929 202a  pre).dot(x_i)) *
-00000a50: 2a20 282d 3129 0d0a 2020 2020 2020 2020  * (-1)..        
-00000a60: 2020 2020 2020 2020 6d5b 695d 203d 2076          m[i] = v
-00000a70: 5b69 5d2a 6e70 2e64 6f74 2828 7365 6c66  [i]*np.dot((self
-00000a80: 2e59 5b69 5d2d 3029 2e54 2c50 7369 5f70  .Y[i]-0).T,Psi_p
-00000a90: 7265 5f69 6e76 292e 646f 7428 435f 7072  re_inv).dot(C_pr
-00000aa0: 6529 2e64 6f74 2878 5f69 290d 0a20 2020  e).dot(x_i)..   
-00000ab0: 2020 2020 2020 2020 2065 6c69 6620 7769           elif wi
-00000ac0: 7468 5f6d 6561 6e20 2620 7365 6c66 2e77  th_mean & self.w
-00000ad0: 6974 685f 6772 6170 683a 0d0a 2020 2020  ith_graph:..    
-00000ae0: 2020 2020 2020 2020 2020 2020 785f 6920              x_i 
-00000af0: 3d20 6e70 2e68 7374 6163 6b28 2846 5f70  = np.hstack((F_p
-00000b00: 7265 5b69 5d2c 2046 5f70 7265 5b69 5d29  re[i], F_pre[i])
-00000b10: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00000b20: 2020 2076 5b69 5d20 3d20 2831 2b6e 702e     v[i] = (1+np.
-00000b30: 646f 7428 785f 692e 542c 2043 5f70 7265  dot(x_i.T, C_pre
-00000b40: 2e54 292e 646f 7428 5073 695f 7072 655f  .T).dot(Psi_pre_
-00000b50: 696e 7629 2e64 6f74 2843 5f70 7265 292e  inv).dot(C_pre).
-00000b60: 646f 7428 785f 6929 2920 2a2a 2028 2d31  dot(x_i)) ** (-1
-00000b70: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00000b80: 2020 206d 5b69 5d20 3d20 765b 695d 2a6e     m[i] = v[i]*n
-00000b90: 702e 646f 7428 2873 656c 662e 595b 695d  p.dot((self.Y[i]
-00000ba0: 2d6e 702e 646f 7428 412c 2046 5f70 7265  -np.dot(A, F_pre
-00000bb0: 5b69 5d29 292e 542c 5073 695f 7072 655f  [i])).T,Psi_pre_
-00000bc0: 696e 7629 2e64 6f74 2843 5f70 7265 292e  inv).dot(C_pre).
-00000bd0: 646f 7428 785f 6929 0d0a 2020 2020 2020  dot(x_i)..      
-00000be0: 2020 2020 2020 656c 6966 2028 6e6f 7420        elif (not 
-00000bf0: 7769 7468 5f6d 6561 6e29 2026 2073 656c  with_mean) & sel
-00000c00: 662e 7769 7468 5f67 7261 7068 3a0d 0a20  f.with_graph:.. 
-00000c10: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-00000c20: 5f69 203d 2046 5f70 7265 5b69 5d0d 0a20  _i = F_pre[i].. 
-00000c30: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00000c40: 5b69 5d20 3d20 2831 2b6e 702e 646f 7428  [i] = (1+np.dot(
-00000c50: 785f 692e 542c 2043 5f70 7265 2e54 292e  x_i.T, C_pre.T).
-00000c60: 646f 7428 5073 695f 7072 655f 696e 7629  dot(Psi_pre_inv)
-00000c70: 2e64 6f74 2843 5f70 7265 292e 646f 7428  .dot(C_pre).dot(
-00000c80: 785f 6929 2920 2a2a 2028 2d31 290d 0a20  x_i)) ** (-1).. 
-00000c90: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00000ca0: 5b69 5d20 3d20 765b 695d 2a6e 702e 646f  [i] = v[i]*np.do
-00000cb0: 7428 2873 656c 662e 595b 695d 2d30 292e  t((self.Y[i]-0).
-00000cc0: 542c 5073 695f 7072 655f 696e 7629 2e64  T,Psi_pre_inv).d
-00000cd0: 6f74 2843 5f70 7265 292e 646f 7428 785f  ot(C_pre).dot(x_
-00000ce0: 6929 0d0a 0d0a 2020 2020 2020 2020 0d0a  i)....        ..
-00000cf0: 2020 2020 2020 2020 2320 4d2d 7374 6570          # M-step
-00000d00: 0d0a 0d0a 0d0a 2020 2020 2020 2020 6966  ......        if
-00000d10: 2077 6974 685f 6d65 616e 2026 2028 6e6f   with_mean & (no
-00000d20: 7420 7365 6c66 2e77 6974 685f 6772 6170  t self.with_grap
-00000d30: 6829 3a0d 0a20 2020 2020 2020 2020 2020  h):..           
-00000d40: 2058 5f74 696c 6465 203d 2020 6e70 2e76   X_tilde =  np.v
-00000d50: 7374 6163 6b28 286e 702e 6873 7461 636b  stack((np.hstack
-00000d60: 2828 5831 2c20 6d5b 3a2c 6e70 2e6e 6577  ((X1, m[:,np.new
-00000d70: 6178 6973 5d2a 5832 2929 2c6e 702e 6873  axis]*X2)),np.hs
-00000d80: 7461 636b 2828 6e70 2e7a 6572 6f73 2828  tack((np.zeros((
-00000d90: 7365 6c66 2e6e 2c20 7365 6c66 2e72 3129  self.n, self.r1)
-00000da0: 292c 765b 3a2c 6e70 2e6e 6577 6178 6973  ),v[:,np.newaxis
-00000db0: 5d2a 5832 2929 2929 0d0a 2020 2020 2020  ]*X2))))..      
-00000dc0: 2020 656c 6966 2028 6e6f 7420 7769 7468    elif (not with
-00000dd0: 5f6d 6561 6e29 2026 2028 6e6f 7420 7365  _mean) & (not se
-00000de0: 6c66 2e77 6974 685f 6772 6170 6829 3a0d  lf.with_graph):.
-00000df0: 0a20 2020 2020 2020 2020 2020 2058 5f74  .            X_t
-00000e00: 696c 6465 203d 2020 6e70 2e76 7374 6163  ilde =  np.vstac
-00000e10: 6b28 286d 5b3a 2c6e 702e 6e65 7761 7869  k((m[:,np.newaxi
-00000e20: 735d 2a58 322c 765b 3a2c 6e70 2e6e 6577  s]*X2,v[:,np.new
-00000e30: 6178 6973 5d2a 5832 2929 0d0a 2020 2020  axis]*X2))..    
-00000e40: 2020 2020 656c 6966 2077 6974 685f 6d65      elif with_me
-00000e50: 616e 2026 2073 656c 662e 7769 7468 5f67  an & self.with_g
-00000e60: 7261 7068 3a0d 0a20 2020 2020 2020 2020  raph:..         
-00000e70: 2020 2058 5f74 696c 6465 203d 2020 6e70     X_tilde =  np
-00000e80: 2e76 7374 6163 6b28 286e 702e 6873 7461  .vstack((np.hsta
-00000e90: 636b 2828 465f 7072 652c 206d 5b3a 2c6e  ck((F_pre, m[:,n
-00000ea0: 702e 6e65 7761 7869 735d 2a46 5f70 7265  p.newaxis]*F_pre
-00000eb0: 2929 2c6e 702e 6873 7461 636b 2828 6e70  )),np.hstack((np
-00000ec0: 2e7a 6572 6f73 2828 7365 6c66 2e6e 2c20  .zeros((self.n, 
-00000ed0: 7365 6c66 2e72 3129 292c 765b 3a2c 6e70  self.r1)),v[:,np
-00000ee0: 2e6e 6577 6178 6973 5d2a 465f 7072 6529  .newaxis]*F_pre)
-00000ef0: 2929 290d 0a20 2020 2020 2020 2065 6c69  )))..        eli
-00000f00: 6620 286e 6f74 2077 6974 685f 6d65 616e  f (not with_mean
-00000f10: 2920 2620 7365 6c66 2e77 6974 685f 6772  ) & self.with_gr
-00000f20: 6170 683a 0d0a 2020 2020 2020 2020 2020  aph:..          
-00000f30: 2020 585f 7469 6c64 6520 3d20 206e 702e    X_tilde =  np.
-00000f40: 7673 7461 636b 2828 6d5b 3a2c 6e70 2e6e  vstack((m[:,np.n
-00000f50: 6577 6178 6973 5d2a 465f 7072 652c 765b  ewaxis]*F_pre,v[
-00000f60: 3a2c 6e70 2e6e 6577 6178 6973 5d2a 465f  :,np.newaxis]*F_
-00000f70: 7072 6529 290d 0a0d 0a0d 0a20 2020 2020  pre))......     
-00000f80: 2020 2069 6620 6320 6973 204e 6f6e 653a     if c is None:
-00000f90: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00000fa0: 2073 656c 662e 616c 7068 6120 213d 2030   self.alpha != 0
-00000fb0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00000fc0: 2020 206f 7574 203d 206d 696e 696d 697a     out = minimiz
-00000fd0: 6528 7365 6c66 2e6c 6173 736f 5f6f 626a  e(self.lasso_obj
-00000fe0: 6563 7469 7665 2c20 435f 7665 632c 2061  ective, C_vec, a
-00000ff0: 7267 7320 3d20 2858 5f74 696c 6465 2c20  rgs = (X_tilde, 
-00001000: 595f 7469 6c64 652c 2050 7369 5f70 7265  Y_tilde, Psi_pre
-00001010: 5f69 6e76 2c73 656c 662e 642c 7365 6c66  _inv,self.d,self
-00001020: 2e72 312b 7365 6c66 2e72 322c 2073 656c  .r1+self.r2, sel
-00001030: 662e 616c 7068 6129 2c20 6d65 7468 6f64  f.alpha), method
-00001040: 3d27 4c2d 4246 4753 2d42 272c 206a 6163  ='L-BFGS-B', jac
-00001050: 3d54 7275 652c 2062 6f75 6e64 7320 3d20  =True, bounds = 
-00001060: 5b28 302e 302c 4e6f 6e65 295d 2a28 322a  [(0.0,None)]*(2*
-00001070: 2873 656c 662e 7231 2b73 656c 662e 7232  (self.r1+self.r2
-00001080: 292a 7365 6c66 2e64 2929 0d0a 2020 2020  )*self.d))..    
-00001090: 2020 2020 2020 2020 2020 2020 435f 7665              C_ve
-000010a0: 6320 3d20 6f75 742e 780d 0a20 2020 2020  c = out.x..     
-000010b0: 2020 2020 2020 2020 2020 2043 203d 206e             C = n
-000010c0: 702e 7265 7368 6170 6528 6f75 742e 785b  p.reshape(out.x[
-000010d0: 3a28 7365 6c66 2e72 312b 7365 6c66 2e72  :(self.r1+self.r
-000010e0: 3229 2a73 656c 662e 645d 202d 206f 7574  2)*self.d] - out
-000010f0: 2e78 5b28 7365 6c66 2e72 312b 7365 6c66  .x[(self.r1+self
-00001100: 2e72 3229 2a73 656c 662e 643a 5d2c 2028  .r2)*self.d:], (
-00001110: 7365 6c66 2e64 2c73 656c 662e 7231 2b73  self.d,self.r1+s
-00001120: 656c 662e 7232 2929 0d0a 2020 2020 2020  elf.r2))..      
-00001130: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00001140: 2020 2020 2020 2020 2020 2020 2043 203d               C =
-00001150: 206e 702e 646f 7428 595f 7469 6c64 652e   np.dot(Y_tilde.
-00001160: 542c 2058 5f74 696c 6465 292e 646f 7428  T, X_tilde).dot(
-00001170: 6e70 2e6c 696e 616c 672e 696e 7628 6e70  np.linalg.inv(np
-00001180: 2e64 6f74 2858 5f74 696c 6465 2e54 2c58  .dot(X_tilde.T,X
-00001190: 5f74 696c 6465 2920 2b20 302e 3030 312a  _tilde) + 0.001*
-000011a0: 6e70 2e69 6465 6e74 6974 7928 7365 6c66  np.identity(self
-000011b0: 2e72 312b 7365 6c66 2e72 3229 2929 0d0a  .r1+self.r2)))..
-000011c0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-000011d0: 2020 2020 2020 2020 2020 2043 203d 2063             C = c
-000011e0: 0d0a 0d0a 2020 2020 2020 2020 2369 6e76  ....        #inv
-000011f0: 5f6d 203d 206e 702e 6c69 6e61 6c67 2e69  _m = np.linalg.i
-00001200: 6e76 286e 702e 646f 7428 585f 7469 6c64  nv(np.dot(X_tild
-00001210: 652e 542c 2058 5f74 696c 6465 2929 0d0a  e.T, X_tilde))..
-00001220: 2020 2020 2020 2020 2342 203d 206e 702e          #B = np.
-00001230: 646f 7428 595f 7469 6c64 652e 542c 585f  dot(Y_tilde.T,X_
-00001240: 7469 6c64 6529 2e64 6f74 2869 6e76 5f6d  tilde).dot(inv_m
-00001250: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
-00001260: 7073 6920 6973 204e 6f6e 653a 0d0a 2020  psi is None:..  
-00001270: 2020 2020 2020 2020 2020 5073 695f 6573            Psi_es
-00001280: 7420 3d20 6e70 2e63 6f76 2828 595f 7469  t = np.cov((Y_ti
-00001290: 6c64 652d 6e70 2e64 6f74 2858 5f74 696c  lde-np.dot(X_til
-000012a0: 6465 2c43 2e54 2929 2e54 292a 2873 656c  de,C.T)).T)*(sel
-000012b0: 662e 6e2d 3129 2f73 656c 662e 6e0d 0a20  f.n-1)/self.n.. 
-000012c0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-000012d0: 2020 2020 2020 2020 2020 5073 695f 6573            Psi_es
-000012e0: 7420 3d20 7073 690d 0a0d 0a0d 0a20 2020  t = psi......   
-000012f0: 2020 2020 2069 6620 7769 7468 5f6d 6561       if with_mea
-00001300: 6e3a 0d0a 2020 2020 2020 2020 2020 2020  n:..            
-00001310: 4120 3d20 435b 3a2c 3a73 656c 662e 7231  A = C[:,:self.r1
-00001320: 5d0d 0a20 2020 2020 2020 2020 2020 2042  ]..            B
-00001330: 203d 2043 5b3a 2c73 656c 662e 7231 3a5d   = C[:,self.r1:]
-00001340: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00001350: 0a20 2020 2020 2020 2020 2020 2041 203d  .            A =
-00001360: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
-00001370: 4220 3d20 430d 0a0d 0a0d 0a20 2020 2020  B = C......     
-00001380: 2020 2069 6620 7365 6c66 2e77 6974 685f     if self.with_
-00001390: 6772 6170 683a 0d0a 2020 2020 2020 2020  graph:..        
-000013a0: 2020 2020 6966 2028 7365 6c66 2e46 5f6d      if (self.F_m
-000013b0: 6574 686f 6420 3d3d 2027 6469 7265 6374  ethod == 'direct
-000013c0: 2729 2026 2077 6974 685f 6d65 616e 3a0d  ') & with_mean:.
-000013d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000013e0: 2046 203d 2073 656c 662e 465f 6469 7265   F = self.F_dire
-000013f0: 6374 2820 422c 2041 2c20 6d2c 762c 2050  ct( B, A, m,v, P
-00001400: 7369 5f70 7265 5f69 6e76 290d 0a20 2020  si_pre_inv)..   
-00001410: 2020 2020 2020 2020 2065 6c69 6620 2873           elif (s
-00001420: 656c 662e 465f 6d65 7468 6f64 203d 3d20  elf.F_method == 
-00001430: 2764 6972 6563 7427 2920 2620 286e 6f74  'direct') & (not
-00001440: 2077 6974 685f 6d65 616e 293a 0d0a 2020   with_mean):..  
-00001450: 2020 2020 2020 2020 2020 2020 2020 4620                F 
-00001460: 3d20 7365 6c66 2e46 5f64 6972 6563 745f  = self.F_direct_
-00001470: 636f 765f 6f6e 6c79 2820 422c 206d 2c76  cov_only( B, m,v
-00001480: 2c20 5073 695f 7072 655f 696e 7629 0d0a  , Psi_pre_inv)..
-00001490: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-000014a0: 2028 7365 6c66 2e46 5f6d 6574 686f 6420   (self.F_method 
-000014b0: 3d3d 2027 7365 6361 6e74 2729 2026 2077  == 'secant') & w
-000014c0: 6974 685f 6d65 616e 3a0d 0a20 2020 2020  ith_mean:..     
-000014d0: 2020 2020 2020 2020 2020 2046 203d 2073             F = s
-000014e0: 656c 662e 465f 7365 6361 6e74 5f6f 7074  elf.F_secant_opt
-000014f0: 696d 2842 2c20 412c 206d 2c76 2c20 5073  im(B, A, m,v, Ps
-00001500: 695f 7072 655f 696e 7629 0d0a 2020 2020  i_pre_inv)..    
-00001510: 2020 2020 2020 2020 656c 6966 2028 7365          elif (se
-00001520: 6c66 2e46 5f6d 6574 686f 6420 3d3d 2027  lf.F_method == '
-00001530: 7365 6361 6e74 2729 2026 2028 6e6f 7420  secant') & (not 
-00001540: 7769 7468 5f6d 6561 6e29 3a0d 0a20 2020  with_mean):..   
-00001550: 2020 2020 2020 2020 2020 2020 2046 203d               F =
-00001560: 2073 656c 662e 465f 7365 6361 6e74 5f6f   self.F_secant_o
-00001570: 7074 696d 2842 2c20 6e70 2e7a 6572 6f73  ptim(B, np.zeros
-00001580: 2828 7365 6c66 2e64 2c20 7365 6c66 2e72  ((self.d, self.r
-00001590: 2929 2c20 6d2c 762c 2050 7369 5f70 7265  )), m,v, Psi_pre
-000015a0: 5f69 6e76 290d 0a20 2020 2020 2020 2020  _inv)..         
-000015b0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-000015c0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000015d0: 5661 6c75 6545 7272 6f72 2866 2246 5f6d  ValueError(f"F_m
-000015e0: 6574 686f 6420 7b73 656c 662e 465f 6d65  ethod {self.F_me
-000015f0: 7468 6f64 7d20 6e6f 7420 6b6e 6f77 6e22  thod} not known"
-00001600: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-00001610: 0d0a 2020 2020 2020 2020 2020 2020 4620  ..            F 
-00001620: 3d20 4e6f 6e65 0d0a 0d0a 0d0a 2020 2020  = None......    
-00001630: 2020 2020 6966 2073 656c 662e 7769 7468      if self.with
-00001640: 5f67 7261 7068 3a0d 0a20 2020 2020 2020  _graph:..       
-00001650: 2020 2020 2074 6f6c 5f69 203d 2028 6e70       tol_i = (np
-00001660: 2e6c 696e 616c 672e 6e6f 726d 2843 2d43  .linalg.norm(C-C
-00001670: 5f70 7265 2920 2b20 6e70 2e6c 696e 616c  _pre) + np.linal
-00001680: 672e 6e6f 726d 2846 2d46 5f70 7265 2929  g.norm(F-F_pre))
-00001690: 2f28 6e70 2e6c 696e 616c 672e 6e6f 726d  /(np.linalg.norm
-000016a0: 2846 5f70 7265 2920 2b20 6e70 2e6c 696e  (F_pre) + np.lin
-000016b0: 616c 672e 6e6f 726d 2843 5f70 7265 2929  alg.norm(C_pre))
-000016c0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-000016d0: 0a20 2020 2020 2020 2020 2020 2074 6f6c  .            tol
-000016e0: 5f69 203d 206e 702e 6c69 6e61 6c67 2e6e  _i = np.linalg.n
-000016f0: 6f72 6d28 432d 435f 7072 6529 2f6e 702e  orm(C-C_pre)/np.
-00001700: 6c69 6e61 6c67 2e6e 6f72 6d28 435f 7072  linalg.norm(C_pr
-00001710: 6529 0d0a 0d0a 0d0a 2020 2020 2020 2020  e)......        
-00001720: 7265 7475 726e 2043 2c20 5073 695f 6573  return C, Psi_es
-00001730: 742c 2046 2c20 746f 6c5f 690d 0a0d 0a0d  t, F, tol_i.....
-00001740: 0a0d 0a0d 0a0d 0a0d 0a20 2020 2064 6566  .........    def
-00001750: 2066 6974 5f68 6f66 665f 625f 6f6e 6c79   fit_hoff_b_only
-00001760: 2873 656c 662c 2058 322c 2070 7369 203d  (self, X2, psi =
-00001770: 204e 6f6e 652c 2058 5f66 696c 7465 7220   None, X_filter 
-00001780: 3d20 4e6f 6e65 292d 3e20 4e6f 6e65 3a0d  = None)-> None:.
-00001790: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-000017a0: 2020 2020 2020 486f 6666 206f 6e6c 7920        Hoff only 
-000017b0: 6669 7420 636f 7661 7269 616e 6365 2074  fit covariance t
-000017c0: 6572 6d0d 0a20 2020 2020 2020 2022 2222  erm..        """
-000017d0: 0d0a 0d0a 2020 2020 2020 2020 6320 3d20  ....        c = 
-000017e0: 4e6f 6e65 0d0a 0d0a 2020 2020 2020 2020  None....        
-000017f0: 7365 6c66 2e72 3220 3d20 5832 2e73 6861  self.r2 = X2.sha
-00001800: 7065 5b31 5d0d 0a20 2020 2020 2020 2073  pe[1]..        s
-00001810: 656c 662e 7231 203d 2030 0d0a 2020 2020  elf.r1 = 0..    
-00001820: 2020 2020 0d0a 2020 2020 2020 2020 595f      ..        Y_
-00001830: 7469 6c64 6520 3d20 6e70 2e76 7374 6163  tilde = np.vstac
-00001840: 6b28 2873 656c 662e 592c 206e 702e 7a65  k((self.Y, np.ze
-00001850: 726f 7328 2873 656c 662e 6e2c 7365 6c66  ros((self.n,self
-00001860: 2e64 2929 2929 0d0a 0d0a 2020 2020 2020  .d))))....      
-00001870: 2020 6966 2070 7369 2069 7320 4e6f 6e65    if psi is None
-00001880: 3a0d 0a20 2020 2020 2020 2020 2020 2050  :..            P
-00001890: 7369 5f70 7265 203d 206e 702e 6964 656e  si_pre = np.iden
-000018a0: 7469 7479 2873 656c 662e 6429 0d0a 2020  tity(self.d)..  
-000018b0: 2020 2020 2020 2020 2020 5073 695f 7072            Psi_pr
-000018c0: 655f 696e 7620 3d20 6e70 2e6c 696e 616c  e_inv = np.linal
-000018d0: 672e 696e 7628 5073 695f 7072 6529 0d0a  g.inv(Psi_pre)..
-000018e0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-000018f0: 2020 2020 2020 2020 2020 2050 7369 5f70             Psi_p
-00001900: 7265 203d 2070 7369 0d0a 2020 2020 2020  re = psi..      
-00001910: 2020 2020 2020 5073 695f 7072 655f 696e        Psi_pre_in
-00001920: 7620 3d20 6e70 2e6c 696e 616c 672e 696e  v = np.linalg.in
-00001930: 7628 5073 695f 7072 6529 0d0a 0d0a 2020  v(Psi_pre)....  
-00001940: 2020 2020 2020 7620 3d20 6e70 2e6f 6e65        v = np.one
-00001950: 7328 7365 6c66 2e6e 290d 0a20 2020 2020  s(self.n)..     
-00001960: 2020 206d 203d 206e 702e 6f6e 6573 2873     m = np.ones(s
-00001970: 656c 662e 6e29 0d0a 2020 2020 2020 2020  elf.n)..        
-00001980: 585f 7469 6c64 6520 3d20 206e 702e 7673  X_tilde =  np.vs
-00001990: 7461 636b 2828 6d5b 3a2c 6e70 2e6e 6577  tack((m[:,np.new
-000019a0: 6178 6973 5d2a 5832 2c76 5b3a 2c6e 702e  axis]*X2,v[:,np.
-000019b0: 6e65 7761 7869 735d 2a58 3229 290d 0a20  newaxis]*X2)).. 
-000019c0: 2020 2020 2020 2023 2054 6865 2073 6f6c         # The sol
-000019d0: 7574 696f 6e20 6973 2065 7672 7920 7365  ution is evry se
-000019e0: 6e73 6974 6976 6520 746f 2074 6865 2069  nsitive to the i
-000019f0: 6e69 7461 6c20 6d61 7472 6978 2c20 7468  nital matrix, th
-00001a00: 6520 6c32 2072 6567 756c 6172 697a 6174  e l2 regularizat
-00001a10: 696f 6e20 666f 7220 425f 7072 6520 6566  ion for B_pre ef
-00001a20: 6665 6374 7320 616c 7068 610d 0a20 2020  fects alpha..   
-00001a30: 2020 2020 200d 0a20 2020 2020 2020 2043       ..        C
-00001a40: 5f70 7265 203d 206e 702e 6f6e 6573 2828  _pre = np.ones((
-00001a50: 7365 6c66 2e64 2c20 7365 6c66 2e72 3229  self.d, self.r2)
-00001a60: 2923 206e 702e 646f 7428 595f 7469 6c64  )# np.dot(Y_tild
-00001a70: 652e 542c 2058 5f74 696c 6465 292e 646f  e.T, X_tilde).do
-00001a80: 7428 6e70 2e6c 696e 616c 672e 696e 7628  t(np.linalg.inv(
-00001a90: 6e70 2e64 6f74 2858 5f74 696c 6465 2e54  np.dot(X_tilde.T
-00001aa0: 2c20 585f 7469 6c64 6529 202b 2061 6c70  , X_tilde) + alp
-00001ab0: 6861 2a6e 702e 6964 656e 7469 7479 2872  ha*np.identity(r
-00001ac0: 2929 290d 0a20 2020 2020 2020 200d 0a20  )))..        .. 
-00001ad0: 2020 2020 2020 2073 656c 662e 6974 6572         self.iter
-00001ae0: 6174 696f 6e20 3d20 300d 0a20 2020 2020  ation = 0..     
-00001af0: 2020 2073 656c 662e 746f 6c5f 7665 6320     self.tol_vec 
-00001b00: 3d20 6e70 2e7a 6572 6f73 2873 656c 662e  = np.zeros(self.
-00001b10: 6d61 785f 6974 6572 290d 0a20 2020 2020  max_iter)..     
-00001b20: 2020 2077 6869 6c65 2073 656c 662e 6974     while self.it
-00001b30: 6572 6174 696f 6e20 3c73 656c 662e 6d61  eration <self.ma
-00001b40: 785f 6974 6572 3a0d 0a0d 0a20 2020 2020  x_iter:....     
-00001b50: 2020 2020 2020 2043 2c20 5073 695f 6573         C, Psi_es
-00001b60: 742c 205f 2c20 746f 6c5f 6920 3d20 7365  t, _, tol_i = se
-00001b70: 6c66 2e6f 6e65 5f69 7465 7261 7469 6f6e  lf.one_iteration
-00001b80: 286e 702e 6c69 6e61 6c67 2e69 6e76 2850  (np.linalg.inv(P
-00001b90: 7369 5f70 7265 5f69 6e76 292c 2070 7369  si_pre_inv), psi
-00001ba0: 2c20 435f 7072 652c 2063 2c20 595f 7469  , C_pre, c, Y_ti
-00001bb0: 6c64 652c 2058 3120 3d20 4e6f 6e65 2c20  lde, X1 = None, 
-00001bc0: 5832 203d 2058 322c 2077 6974 685f 6d65  X2 = X2, with_me
-00001bd0: 616e 203d 2046 616c 7365 290d 0a20 2020  an = False)..   
-00001be0: 2020 2020 2020 2020 2073 656c 662e 746f           self.to
-00001bf0: 6c5f 7665 635b 7365 6c66 2e69 7465 7261  l_vec[self.itera
-00001c00: 7469 6f6e 5d20 3d20 746f 6c5f 690d 0a0d  tion] = tol_i...
-00001c10: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00001c20: 2874 6f6c 5f69 3c73 656c 662e 746f 6c29  (tol_i<self.tol)
-00001c30: 2026 2028 6e6f 7420 7365 6c66 2e64 6f5f   & (not self.do_
-00001c40: 616c 6c5f 6974 6572 293a 0d0a 2020 2020  all_iter):..    
-00001c50: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-00001c60: 6b0d 0a20 2020 2020 2020 2020 2020 200d  k..            .
-00001c70: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00001c80: 662e 6974 6572 6174 696f 6e2b 3d31 0d0a  f.iteration+=1..
-00001c90: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00001ca0: 2070 7369 2069 7320 4e6f 6e65 3a0d 0a20   psi is None:.. 
-00001cb0: 2020 2020 2020 2020 2020 2020 2020 2050                 P
-00001cc0: 7369 5f70 7265 203d 2050 7369 5f65 7374  si_pre = Psi_est
-00001cd0: 2e63 6f70 7928 290d 0a0d 0a20 2020 2020  .copy()....     
-00001ce0: 2020 2020 2020 2043 5f70 7265 203d 2043         C_pre = C
-00001cf0: 2e63 6f70 7928 290d 0a0d 0a20 2020 2020  .copy()....     
-00001d00: 2020 2073 656c 662e 4120 3d20 4e6f 6e65     self.A = None
-00001d10: 0d0a 2020 2020 2020 2020 7365 6c66 2e42  ..        self.B
-00001d20: 203d 2043 0d0a 2020 2020 2020 2020 7365   = C..        se
-00001d30: 6c66 2e50 7369 203d 2050 7369 5f65 7374  lf.Psi = Psi_est
-00001d40: 0d0a 0d0a 2020 2020 6465 6620 6669 745f  ....    def fit_
-00001d50: 686f 6666 2873 656c 662c 2058 312c 2058  hoff(self, X1, X
-00001d60: 322c 2070 7369 203d 204e 6f6e 652c 2058  2, psi = None, X
-00001d70: 5f66 696c 7465 7220 3d20 4e6f 6e65 292d  _filter = None)-
-00001d80: 3e20 4e6f 6e65 3a0d 0a20 2020 2020 2020  > None:..       
-00001d90: 2022 2222 0d0a 2020 2020 2020 2020 486f   """..        Ho
-00001da0: 6666 2077 6974 6820 6c61 7373 6f0d 0a20  ff with lasso.. 
-00001db0: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-00001dc0: 2020 2020 2020 6320 3d20 4e6f 6e65 0d0a        c = None..
-00001dd0: 2020 2020 2020 2020 7365 6c66 2e72 3120          self.r1 
-00001de0: 3d20 5831 2e73 6861 7065 5b31 5d0d 0a20  = X1.shape[1].. 
-00001df0: 2020 2020 2020 2073 656c 662e 7232 203d         self.r2 =
-00001e00: 2058 322e 7368 6170 655b 315d 0d0a 0d0a   X2.shape[1]....
-00001e10: 2020 2020 2020 2020 595f 7469 6c64 6520          Y_tilde 
-00001e20: 3d20 6e70 2e76 7374 6163 6b28 2873 656c  = np.vstack((sel
-00001e30: 662e 592c 206e 702e 7a65 726f 7328 2873  f.Y, np.zeros((s
-00001e40: 656c 662e 6e2c 7365 6c66 2e64 2929 2929  elf.n,self.d))))
-00001e50: 0d0a 0d0a 2020 2020 2020 2020 6966 2070  ....        if p
-00001e60: 7369 2069 7320 4e6f 6e65 3a0d 0a20 2020  si is None:..   
-00001e70: 2020 2020 2020 2020 2050 7369 5f70 7265           Psi_pre
-00001e80: 203d 206e 702e 6964 656e 7469 7479 2873   = np.identity(s
-00001e90: 656c 662e 6429 0d0a 2020 2020 2020 2020  elf.d)..        
-00001ea0: 2020 2020 5073 695f 7072 655f 696e 7620      Psi_pre_inv 
-00001eb0: 3d20 6e70 2e6c 696e 616c 672e 696e 7628  = np.linalg.inv(
-00001ec0: 5073 695f 7072 6529 0d0a 2020 2020 2020  Psi_pre)..      
-00001ed0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00001ee0: 2020 2020 2050 7369 5f70 7265 203d 2070       Psi_pre = p
-00001ef0: 7369 0d0a 2020 2020 2020 2020 2020 2020  si..            
-00001f00: 5073 695f 7072 655f 696e 7620 3d20 6e70  Psi_pre_inv = np
-00001f10: 2e6c 696e 616c 672e 696e 7628 5073 695f  .linalg.inv(Psi_
-00001f20: 7072 6529 0d0a 0d0a 2020 2020 2020 2020  pre)....        
-00001f30: 7620 3d20 6e70 2e6f 6e65 7328 7365 6c66  v = np.ones(self
-00001f40: 2e6e 290d 0a20 2020 2020 2020 206d 203d  .n)..        m =
-00001f50: 206e 702e 6f6e 6573 2873 656c 662e 6e29   np.ones(self.n)
-00001f60: 0d0a 2020 2020 2020 2020 585f 7469 6c64  ..        X_tild
-00001f70: 6520 3d20 206e 702e 7673 7461 636b 2828  e =  np.vstack((
-00001f80: 6e70 2e68 7374 6163 6b28 2858 312c 206d  np.hstack((X1, m
-00001f90: 5b3a 2c6e 702e 6e65 7761 7869 735d 2a58  [:,np.newaxis]*X
-00001fa0: 3229 292c 6e70 2e68 7374 6163 6b28 286e  2)),np.hstack((n
-00001fb0: 702e 7a65 726f 7328 2873 656c 662e 6e2c  p.zeros((self.n,
-00001fc0: 2073 656c 662e 7231 2929 2c76 5b3a 2c6e   self.r1)),v[:,n
-00001fd0: 702e 6e65 7761 7869 735d 2a58 3229 2929  p.newaxis]*X2)))
-00001fe0: 290d 0a20 2020 2020 2020 2023 2054 6865  )..        # The
-00001ff0: 2073 6f6c 7574 696f 6e20 6973 2065 7672   solution is evr
-00002000: 7920 7365 6e73 6974 6976 6520 746f 2074  y sensitive to t
-00002010: 6865 2069 6e69 7461 6c20 6d61 7472 6978  he inital matrix
-00002020: 2c20 7468 6520 6c32 2072 6567 756c 6172  , the l2 regular
-00002030: 697a 6174 696f 6e20 666f 7220 425f 7072  ization for B_pr
-00002040: 6520 6566 6665 6374 7320 616c 7068 610d  e effects alpha.
-00002050: 0a20 2020 2020 2020 2043 5f70 7265 203d  .        C_pre =
-00002060: 206e 702e 6f6e 6573 2828 7365 6c66 2e64   np.ones((self.d
-00002070: 2c20 7365 6c66 2e72 312b 7365 6c66 2e72  , self.r1+self.r
-00002080: 3229 2923 206e 702e 646f 7428 595f 7469  2))# np.dot(Y_ti
-00002090: 6c64 652e 542c 2058 5f74 696c 6465 292e  lde.T, X_tilde).
-000020a0: 646f 7428 6e70 2e6c 696e 616c 672e 696e  dot(np.linalg.in
-000020b0: 7628 6e70 2e64 6f74 2858 5f74 696c 6465  v(np.dot(X_tilde
-000020c0: 2e54 2c20 585f 7469 6c64 6529 202b 2061  .T, X_tilde) + a
-000020d0: 6c70 6861 2a6e 702e 6964 656e 7469 7479  lpha*np.identity
-000020e0: 2872 2929 290d 0a20 2020 2020 2020 200d  (r)))..        .
-000020f0: 0a20 2020 2020 2020 2073 656c 662e 6974  .        self.it
-00002100: 6572 6174 696f 6e20 3d20 300d 0a20 2020  eration = 0..   
-00002110: 2020 2020 2073 656c 662e 746f 6c5f 7665       self.tol_ve
-00002120: 6320 3d20 6e70 2e7a 6572 6f73 2873 656c  c = np.zeros(sel
-00002130: 662e 6d61 785f 6974 6572 290d 0a20 2020  f.max_iter)..   
-00002140: 2020 2020 2077 6869 6c65 2073 656c 662e       while self.
-00002150: 6974 6572 6174 696f 6e20 3c73 656c 662e  iteration <self.
-00002160: 6d61 785f 6974 6572 3a0d 0a20 2020 2020  max_iter:..     
-00002170: 2020 2020 2020 2043 2c20 5073 695f 6573         C, Psi_es
-00002180: 742c 205f 2c20 746f 6c5f 6920 3d20 7365  t, _, tol_i = se
-00002190: 6c66 2e6f 6e65 5f69 7465 7261 7469 6f6e  lf.one_iteration
-000021a0: 286e 702e 6c69 6e61 6c67 2e69 6e76 2850  (np.linalg.inv(P
-000021b0: 7369 5f70 7265 5f69 6e76 292c 2070 7369  si_pre_inv), psi
-000021c0: 2c20 435f 7072 652c 2063 2c20 595f 7469  , C_pre, c, Y_ti
-000021d0: 6c64 652c 2058 3120 3d20 5831 2c20 5832  lde, X1 = X1, X2
-000021e0: 203d 2058 322c 2077 6974 685f 6d65 616e   = X2, with_mean
-000021f0: 203d 2054 7275 6529 0d0a 2020 2020 2020   = True)..      
-00002200: 2020 2020 2020 7365 6c66 2e74 6f6c 5f76        self.tol_v
-00002210: 6563 5b73 656c 662e 6974 6572 6174 696f  ec[self.iteratio
-00002220: 6e5d 203d 2074 6f6c 5f69 0d0a 2020 2020  n] = tol_i..    
-00002230: 2020 2020 2020 2020 6966 2028 746f 6c5f          if (tol_
-00002240: 693c 7365 6c66 2e74 6f6c 2920 2620 286e  i<self.tol) & (n
-00002250: 6f74 2073 656c 662e 646f 5f61 6c6c 5f69  ot self.do_all_i
-00002260: 7465 7229 3a0d 0a20 2020 2020 2020 2020  ter):..         
-00002270: 2020 2020 2020 2062 7265 616b 0d0a 2020         break..  
-00002280: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00002290: 2020 2020 2020 2020 7365 6c66 2e69 7465          self.ite
-000022a0: 7261 7469 6f6e 2b3d 310d 0a0d 0a20 2020  ration+=1....   
-000022b0: 2020 2020 2020 2020 2069 6620 7073 6920           if psi 
-000022c0: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-000022d0: 2020 2020 2020 2020 2020 5073 695f 7072            Psi_pr
-000022e0: 6520 3d20 5073 695f 6573 742e 636f 7079  e = Psi_est.copy
-000022f0: 2829 0d0a 0d0a 2020 2020 2020 2020 2020  ()....          
-00002300: 2020 435f 7072 6520 3d20 432e 636f 7079    C_pre = C.copy
-00002310: 2829 0d0a 0d0a 2020 2020 2020 2020 7365  ()....        se
-00002320: 6c66 2e41 203d 2043 5b3a 2c3a 7365 6c66  lf.A = C[:,:self
-00002330: 2e72 315d 0d0a 2020 2020 2020 2020 7365  .r1]..        se
-00002340: 6c66 2e42 203d 2043 5b3a 2c73 656c 662e  lf.B = C[:,self.
-00002350: 7231 3a5d 0d0a 2020 2020 2020 2020 7365  r1:]..        se
-00002360: 6c66 2e50 7369 203d 2050 7369 5f65 7374  lf.Psi = Psi_est
-00002370: 0d0a 0d0a                                ....
+00000000: 0d0a 0d0a 696d 706f 7274 206e 756d 7079  ....import numpy
+00000010: 2061 7320 6e70 0d0a 6672 6f6d 2073 6369   as np..from sci
+00000020: 7079 2e6f 7074 696d 697a 6520 696d 706f  py.optimize impo
+00000030: 7274 206d 696e 696d 697a 650d 0a0d 0a0d  rt minimize.....
+00000040: 0a0d 0a63 6c61 7373 2043 6f76 5265 6728  ...class CovReg(
+00000050: 293a 0d0a 0d0a 2020 2020 0d0a 2020 2020  ):....    ..    
+00000060: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00000070: 662c 2059 2c20 616c 7068 612c 206d 6178  f, Y, alpha, max
+00000080: 5f69 7465 7220 3d20 3130 302c 2074 6f6c  _iter = 100, tol
+00000090: 203d 2031 652d 362c 2064 6f5f 616c 6c5f   = 1e-6, do_all_
+000000a0: 6974 6572 203d 2046 616c 7365 2920 2d3e  iter = False) ->
+000000b0: 204e 6f6e 653a 0d0a 0d0a 2020 2020 2020   None:....      
+000000c0: 2020 7365 6c66 2e59 203d 2059 0d0a 2020    self.Y = Y..  
+000000d0: 2020 2020 2020 7365 6c66 2e6d 6178 5f69        self.max_i
+000000e0: 7465 7220 3d20 6d61 785f 6974 6572 0d0a  ter = max_iter..
+000000f0: 2020 2020 2020 2020 7365 6c66 2e74 6f6c          self.tol
+00000100: 203d 2074 6f6c 0d0a 0d0a 2020 2020 2020   = tol....      
+00000110: 2020 7365 6c66 2e64 203d 2059 2e73 6861    self.d = Y.sha
+00000120: 7065 5b31 5d0d 0a20 2020 2020 2020 2073  pe[1]..        s
+00000130: 656c 662e 6e20 3d20 592e 7368 6170 655b  elf.n = Y.shape[
+00000140: 305d 0d0a 0d0a 2020 2020 2020 2020 7365  0]....        se
+00000150: 6c66 2e61 6c70 6861 203d 2073 656c 662e  lf.alpha = self.
+00000160: 6e2a 616c 7068 610d 0a0d 0a20 2020 2020  n*alpha....     
+00000170: 2020 2073 656c 662e 7769 7468 5f67 7261     self.with_gra
+00000180: 7068 203d 2046 616c 7365 0d0a 2020 2020  ph = False..    
+00000190: 2020 2020 7365 6c66 2e64 6f5f 616c 6c5f      self.do_all_
+000001a0: 6974 6572 203d 2064 6f5f 616c 6c5f 6974  iter = do_all_it
+000001b0: 6572 0d0a 0d0a 0d0a 0d0a 2020 2020 4073  er........    @s
+000001c0: 7461 7469 636d 6574 686f 640d 0a20 2020  taticmethod..   
+000001d0: 2064 6566 206c 6173 736f 5f6f 626a 6563   def lasso_objec
+000001e0: 7469 7665 2870 6172 616d 2c20 582c 2059  tive(param, X, Y
+000001f0: 2c50 7369 5f69 6e76 2c20 642c 722c 2061  ,Psi_inv, d,r, a
+00000200: 6c70 6861 292d 3e74 7570 6c65 3a0d 0a20  lpha)->tuple:.. 
+00000210: 2020 2020 2020 2022 2222 220d 0a20 2020         """"..   
+00000220: 2020 2020 204f 626a 6563 7469 7665 2061       Objective a
+00000230: 6e64 2067 7261 6469 656e 7420 746f 2070  nd gradient to p
+00000240: 6173 7320 696e 746f 2074 6865 204c 2d42  ass into the L-B
+00000250: 4647 532d 4220 736f 6c76 6572 2074 6f20  FGS-B solver to 
+00000260: 736f 6c76 6520 7468 6520 6c61 7373 6f20  solve the lasso 
+00000270: 7072 6f62 6c65 6d2e 0d0a 2020 2020 2020  problem...      
+00000280: 2020 2222 220d 0a20 2020 2020 2020 2043    """..        C
+00000290: 203d 206e 702e 7265 7368 6170 6528 7061   = np.reshape(pa
+000002a0: 7261 6d5b 3a72 2a64 5d2d 7061 7261 6d5b  ram[:r*d]-param[
+000002b0: 722a 643a 5d2c 2864 2c72 2929 0d0a 2020  r*d:],(d,r))..  
+000002c0: 2020 2020 2020 6f62 6a20 3d20 206e 702e        obj =  np.
+000002d0: 7472 6163 6528 6e70 2e64 6f74 2828 592d  trace(np.dot((Y-
+000002e0: 206e 702e 646f 7428 582c 432e 5429 292e   np.dot(X,C.T)).
+000002f0: 542c 2859 2d20 6e70 2e64 6f74 2858 2c43  T,(Y- np.dot(X,C
+00000300: 2e54 2929 292e 646f 7428 5073 695f 696e  .T))).dot(Psi_in
+00000310: 7629 2920 2b20 616c 7068 612a 7061 7261  v)) + alpha*para
+00000320: 6d2e 7375 6d28 290d 0a20 2020 2020 2020  m.sum()..       
+00000330: 2074 5f30 203d 2059 2e54 2d6e 702e 646f   t_0 = Y.T-np.do
+00000340: 7428 432c 582e 5429 0d0a 2020 2020 2020  t(C,X.T)..      
+00000350: 2020 6772 6164 203d 2028 2d30 2e35 2a6e    grad = (-0.5*n
+00000360: 702e 646f 7428 745f 302c 5829 292e 666c  p.dot(t_0,X)).fl
+00000370: 6174 7465 6e28 290d 0a20 2020 2020 2020  atten()..       
+00000380: 2072 6574 7572 6e20 6f62 6a2c 206e 702e   return obj, np.
+00000390: 636f 6e63 6174 656e 6174 6528 2867 7261  concatenate((gra
+000003a0: 6420 2b20 616c 7068 6120 2c20 2d20 6772  d + alpha , - gr
+000003b0: 6164 202b 2061 6c70 6861 2029 2c20 6178  ad + alpha ), ax
+000003c0: 6973 3d4e 6f6e 6529 0d0a 2020 2020 2020  is=None)..      
+000003d0: 2020 0d0a 0d0a 2020 2020 6465 6620 6669    ....    def fi
+000003e0: 6c74 6572 5f78 2873 656c 6629 3a0d 0a20  lter_x(self):.. 
+000003f0: 2020 2020 2020 2070 6173 730d 0a0d 0a20         pass.... 
+00000400: 2020 2064 6566 2066 6974 2873 656c 6629     def fit(self)
+00000410: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
+00000420: 2020 2020 2020 2020 5772 6170 7065 720d          Wrapper.
+00000430: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00000440: 2020 2020 2020 7061 7373 0d0a 0d0a 0d0a        pass......
+00000450: 2020 2020 6465 6620 6f6e 655f 6974 6572      def one_iter
+00000460: 6174 696f 6e28 7365 6c66 2c20 5073 695f  ation(self, Psi_
+00000470: 7072 655f 696e 762c 2070 7369 2c20 435f  pre_inv, psi, C_
+00000480: 7072 652c 2063 2c20 595f 7469 6c64 652c  pre, c, Y_tilde,
+00000490: 2058 3120 3d20 4e6f 6e65 2c20 5832 203d   X1 = None, X2 =
+000004a0: 204e 6f6e 652c 2046 5f70 7265 203d 204e   None, F_pre = N
+000004b0: 6f6e 652c 2077 6974 685f 6d65 616e 203d  one, with_mean =
+000004c0: 2054 7275 6529 3a0d 0a0d 0a0d 0a20 2020   True):......   
+000004d0: 2020 2020 2076 203d 206e 702e 6f6e 6573       v = np.ones
+000004e0: 2873 656c 662e 6e29 0d0a 2020 2020 2020  (self.n)..      
+000004f0: 2020 6d20 3d20 6e70 2e6f 6e65 7328 7365    m = np.ones(se
+00000500: 6c66 2e6e 290d 0a0d 0a0d 0a20 2020 2020  lf.n)......     
+00000510: 2020 2069 6620 7769 7468 5f6d 6561 6e3a     if with_mean:
+00000520: 0d0a 2020 2020 2020 2020 2020 2020 4120  ..            A 
+00000530: 3d20 435f 7072 655b 3a2c 3a73 656c 662e  = C_pre[:,:self.
+00000540: 7231 5d0d 0a20 2020 2020 2020 2020 2020  r1]..           
+00000550: 2042 203d 2043 5f70 7265 5b3a 2c73 656c   B = C_pre[:,sel
+00000560: 662e 7231 3a5d 0d0a 2020 2020 2020 2020  f.r1:]..        
+00000570: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00000580: 2020 2041 203d 2030 0d0a 2020 2020 2020     A = 0..      
+00000590: 2020 2020 2020 4220 3d20 435f 7072 650d        B = C_pre.
+000005a0: 0a0d 0a0d 0a20 2020 2020 2020 2043 5f74  .....        C_t
+000005b0: 6d70 203d 2043 5f70 7265 2e66 6c61 7474  mp = C_pre.flatt
+000005c0: 656e 2829 0d0a 2020 2020 2020 2020 435f  en()..        C_
+000005d0: 7665 6320 3d20 6e70 2e7a 6572 6f73 2832  vec = np.zeros(2
+000005e0: 2a28 7365 6c66 2e72 312b 7365 6c66 2e72  *(self.r1+self.r
+000005f0: 3229 2a73 656c 662e 6429 0d0a 2020 2020  2)*self.d)..    
+00000600: 2020 2020 435f 7665 635b 3a28 7365 6c66      C_vec[:(self
+00000610: 2e72 312b 7365 6c66 2e72 3229 2a73 656c  .r1+self.r2)*sel
+00000620: 662e 645d 203d 206e 702e 6162 7328 435f  f.d] = np.abs(C_
+00000630: 746d 7029 202a 2028 435f 746d 703e 3029  tmp) * (C_tmp>0)
+00000640: 0d0a 2020 2020 2020 2020 435f 7665 635b  ..        C_vec[
+00000650: 2873 656c 662e 7231 2b73 656c 662e 7232  (self.r1+self.r2
+00000660: 292a 7365 6c66 2e64 3a5d 203d 206e 702e  )*self.d:] = np.
+00000670: 6162 7328 435f 746d 7029 202a 2028 435f  abs(C_tmp) * (C_
+00000680: 746d 703c 3029 0d0a 0d0a 0d0a 2020 2020  tmp<0)......    
+00000690: 2020 2020 2320 452d 7374 6570 0d0a 2020      # E-step..  
+000006a0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+000006b0: 616e 6765 2873 656c 662e 6e29 3a0d 0a20  ange(self.n):.. 
+000006c0: 2020 2020 2020 2020 2020 2069 6620 7769             if wi
+000006d0: 7468 5f6d 6561 6e20 2620 286e 6f74 2073  th_mean & (not s
+000006e0: 656c 662e 7769 7468 5f67 7261 7068 293a  elf.with_graph):
+000006f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00000700: 2020 785f 6920 3d20 6e70 2e68 7374 6163    x_i = np.hstac
+00000710: 6b28 2858 315b 695d 2c20 5832 5b69 5d29  k((X1[i], X2[i])
+00000720: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00000730: 2020 2076 5b69 5d20 3d20 2831 2b6e 702e     v[i] = (1+np.
+00000740: 646f 7428 785f 692e 542c 2043 5f70 7265  dot(x_i.T, C_pre
+00000750: 2e54 292e 646f 7428 5073 695f 7072 655f  .T).dot(Psi_pre_
+00000760: 696e 7629 2e64 6f74 2843 5f70 7265 292e  inv).dot(C_pre).
+00000770: 646f 7428 785f 6929 2920 2a2a 2028 2d31  dot(x_i)) ** (-1
+00000780: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00000790: 2020 206d 5b69 5d20 3d20 765b 695d 2a6e     m[i] = v[i]*n
+000007a0: 702e 646f 7428 2873 656c 662e 595b 695d  p.dot((self.Y[i]
+000007b0: 2d6e 702e 646f 7428 412c 2058 315b 695d  -np.dot(A, X1[i]
+000007c0: 2929 2e54 2c50 7369 5f70 7265 5f69 6e76  )).T,Psi_pre_inv
+000007d0: 292e 646f 7428 435f 7072 6529 2e64 6f74  ).dot(C_pre).dot
+000007e0: 2878 5f69 290d 0a20 2020 2020 2020 2020  (x_i)..         
+000007f0: 2020 2065 6c69 6620 286e 6f74 2077 6974     elif (not wit
+00000800: 685f 6d65 616e 2920 2620 286e 6f74 2073  h_mean) & (not s
+00000810: 656c 662e 7769 7468 5f67 7261 7068 293a  elf.with_graph):
+00000820: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00000830: 2020 785f 6920 3d20 5832 5b69 5d0d 0a20    x_i = X2[i].. 
+00000840: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00000850: 5b69 5d20 3d20 2831 2b6e 702e 646f 7428  [i] = (1+np.dot(
+00000860: 785f 692e 542c 2043 5f70 7265 2e54 292e  x_i.T, C_pre.T).
+00000870: 646f 7428 5073 695f 7072 655f 696e 7629  dot(Psi_pre_inv)
+00000880: 2e64 6f74 2843 5f70 7265 292e 646f 7428  .dot(C_pre).dot(
+00000890: 785f 6929 2920 2a2a 2028 2d31 290d 0a20  x_i)) ** (-1).. 
+000008a0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+000008b0: 5b69 5d20 3d20 765b 695d 2a6e 702e 646f  [i] = v[i]*np.do
+000008c0: 7428 2873 656c 662e 595b 695d 2d30 292e  t((self.Y[i]-0).
+000008d0: 542c 5073 695f 7072 655f 696e 7629 2e64  T,Psi_pre_inv).d
+000008e0: 6f74 2843 5f70 7265 292e 646f 7428 785f  ot(C_pre).dot(x_
+000008f0: 6929 0d0a 2020 2020 2020 2020 2020 2020  i)..            
+00000900: 656c 6966 2077 6974 685f 6d65 616e 2026  elif with_mean &
+00000910: 2073 656c 662e 7769 7468 5f67 7261 7068   self.with_graph
+00000920: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00000930: 2020 2078 5f69 203d 206e 702e 6873 7461     x_i = np.hsta
+00000940: 636b 2828 465f 7072 655b 695d 2c20 465f  ck((F_pre[i], F_
+00000950: 7072 655b 695d 2929 0d0a 2020 2020 2020  pre[i]))..      
+00000960: 2020 2020 2020 2020 2020 765b 695d 203d            v[i] =
+00000970: 2028 312b 6e70 2e64 6f74 2878 5f69 2e54   (1+np.dot(x_i.T
+00000980: 2c20 435f 7072 652e 5429 2e64 6f74 2850  , C_pre.T).dot(P
+00000990: 7369 5f70 7265 5f69 6e76 292e 646f 7428  si_pre_inv).dot(
+000009a0: 435f 7072 6529 2e64 6f74 2878 5f69 2929  C_pre).dot(x_i))
+000009b0: 202a 2a20 282d 3129 0d0a 2020 2020 2020   ** (-1)..      
+000009c0: 2020 2020 2020 2020 2020 6d5b 695d 203d            m[i] =
+000009d0: 2076 5b69 5d2a 6e70 2e64 6f74 2828 7365   v[i]*np.dot((se
+000009e0: 6c66 2e59 5b69 5d2d 6e70 2e64 6f74 2841  lf.Y[i]-np.dot(A
+000009f0: 2c20 465f 7072 655b 695d 2929 2e54 2c50  , F_pre[i])).T,P
+00000a00: 7369 5f70 7265 5f69 6e76 292e 646f 7428  si_pre_inv).dot(
+00000a10: 435f 7072 6529 2e64 6f74 2878 5f69 290d  C_pre).dot(x_i).
+00000a20: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00000a30: 6620 286e 6f74 2077 6974 685f 6d65 616e  f (not with_mean
+00000a40: 2920 2620 7365 6c66 2e77 6974 685f 6772  ) & self.with_gr
+00000a50: 6170 683a 0d0a 2020 2020 2020 2020 2020  aph:..          
+00000a60: 2020 2020 2020 785f 6920 3d20 465f 7072        x_i = F_pr
+00000a70: 655b 695d 0d0a 2020 2020 2020 2020 2020  e[i]..          
+00000a80: 2020 2020 2020 765b 695d 203d 2028 312b        v[i] = (1+
+00000a90: 6e70 2e64 6f74 2878 5f69 2e54 2c20 435f  np.dot(x_i.T, C_
+00000aa0: 7072 652e 5429 2e64 6f74 2850 7369 5f70  pre.T).dot(Psi_p
+00000ab0: 7265 5f69 6e76 292e 646f 7428 435f 7072  re_inv).dot(C_pr
+00000ac0: 6529 2e64 6f74 2878 5f69 2929 202a 2a20  e).dot(x_i)) ** 
+00000ad0: 282d 3129 0d0a 2020 2020 2020 2020 2020  (-1)..          
+00000ae0: 2020 2020 2020 6d5b 695d 203d 2076 5b69        m[i] = v[i
+00000af0: 5d2a 6e70 2e64 6f74 2828 7365 6c66 2e59  ]*np.dot((self.Y
+00000b00: 5b69 5d2d 3029 2e54 2c50 7369 5f70 7265  [i]-0).T,Psi_pre
+00000b10: 5f69 6e76 292e 646f 7428 435f 7072 6529  _inv).dot(C_pre)
+00000b20: 2e64 6f74 2878 5f69 290d 0a0d 0a20 2020  .dot(x_i)....   
+00000b30: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
+00000b40: 204d 2d73 7465 700d 0a0d 0a0d 0a20 2020   M-step......   
+00000b50: 2020 2020 2069 6620 7769 7468 5f6d 6561       if with_mea
+00000b60: 6e20 2620 286e 6f74 2073 656c 662e 7769  n & (not self.wi
+00000b70: 7468 5f67 7261 7068 293a 0d0a 2020 2020  th_graph):..    
+00000b80: 2020 2020 2020 2020 585f 7469 6c64 6520          X_tilde 
+00000b90: 3d20 206e 702e 7673 7461 636b 2828 6e70  =  np.vstack((np
+00000ba0: 2e68 7374 6163 6b28 2858 312c 206d 5b3a  .hstack((X1, m[:
+00000bb0: 2c6e 702e 6e65 7761 7869 735d 2a58 3229  ,np.newaxis]*X2)
+00000bc0: 292c 6e70 2e68 7374 6163 6b28 286e 702e  ),np.hstack((np.
+00000bd0: 7a65 726f 7328 2873 656c 662e 6e2c 2073  zeros((self.n, s
+00000be0: 656c 662e 7231 2929 2c76 5b3a 2c6e 702e  elf.r1)),v[:,np.
+00000bf0: 6e65 7761 7869 735d 2a58 3229 2929 290d  newaxis]*X2)))).
+00000c00: 0a20 2020 2020 2020 2065 6c69 6620 286e  .        elif (n
+00000c10: 6f74 2077 6974 685f 6d65 616e 2920 2620  ot with_mean) & 
+00000c20: 286e 6f74 2073 656c 662e 7769 7468 5f67  (not self.with_g
+00000c30: 7261 7068 293a 0d0a 2020 2020 2020 2020  raph):..        
+00000c40: 2020 2020 585f 7469 6c64 6520 3d20 206e      X_tilde =  n
+00000c50: 702e 7673 7461 636b 2828 6d5b 3a2c 6e70  p.vstack((m[:,np
+00000c60: 2e6e 6577 6178 6973 5d2a 5832 2c76 5b3a  .newaxis]*X2,v[:
+00000c70: 2c6e 702e 6e65 7761 7869 735d 2a58 3229  ,np.newaxis]*X2)
+00000c80: 290d 0a20 2020 2020 2020 2065 6c69 6620  )..        elif 
+00000c90: 7769 7468 5f6d 6561 6e20 2620 7365 6c66  with_mean & self
+00000ca0: 2e77 6974 685f 6772 6170 683a 0d0a 2020  .with_graph:..  
+00000cb0: 2020 2020 2020 2020 2020 585f 7469 6c64            X_tild
+00000cc0: 6520 3d20 206e 702e 7673 7461 636b 2828  e =  np.vstack((
+00000cd0: 6e70 2e68 7374 6163 6b28 2846 5f70 7265  np.hstack((F_pre
+00000ce0: 2c20 6d5b 3a2c 6e70 2e6e 6577 6178 6973  , m[:,np.newaxis
+00000cf0: 5d2a 465f 7072 6529 292c 6e70 2e68 7374  ]*F_pre)),np.hst
+00000d00: 6163 6b28 286e 702e 7a65 726f 7328 2873  ack((np.zeros((s
+00000d10: 656c 662e 6e2c 2073 656c 662e 7231 2929  elf.n, self.r1))
+00000d20: 2c76 5b3a 2c6e 702e 6e65 7761 7869 735d  ,v[:,np.newaxis]
+00000d30: 2a46 5f70 7265 2929 2929 0d0a 2020 2020  *F_pre))))..    
+00000d40: 2020 2020 656c 6966 2028 6e6f 7420 7769      elif (not wi
+00000d50: 7468 5f6d 6561 6e29 2026 2073 656c 662e  th_mean) & self.
+00000d60: 7769 7468 5f67 7261 7068 3a0d 0a20 2020  with_graph:..   
+00000d70: 2020 2020 2020 2020 2058 5f74 696c 6465           X_tilde
+00000d80: 203d 2020 6e70 2e76 7374 6163 6b28 286d   =  np.vstack((m
+00000d90: 5b3a 2c6e 702e 6e65 7761 7869 735d 2a46  [:,np.newaxis]*F
+00000da0: 5f70 7265 2c76 5b3a 2c6e 702e 6e65 7761  _pre,v[:,np.newa
+00000db0: 7869 735d 2a46 5f70 7265 2929 0d0a 0d0a  xis]*F_pre))....
+00000dc0: 0d0a 2020 2020 2020 2020 6966 2063 2069  ..        if c i
+00000dd0: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
+00000de0: 2020 2020 2069 6620 7365 6c66 2e61 6c70       if self.alp
+00000df0: 6861 2021 3d20 303a 0d0a 2020 2020 2020  ha != 0:..      
+00000e00: 2020 2020 2020 2020 2020 6f75 7420 3d20            out = 
+00000e10: 6d69 6e69 6d69 7a65 2873 656c 662e 6c61  minimize(self.la
+00000e20: 7373 6f5f 6f62 6a65 6374 6976 652c 2043  sso_objective, C
+00000e30: 5f76 6563 2c20 6172 6773 203d 2028 585f  _vec, args = (X_
+00000e40: 7469 6c64 652c 2059 5f74 696c 6465 2c20  tilde, Y_tilde, 
+00000e50: 5073 695f 7072 655f 696e 762c 7365 6c66  Psi_pre_inv,self
+00000e60: 2e64 2c73 656c 662e 7231 2b73 656c 662e  .d,self.r1+self.
+00000e70: 7232 2c20 7365 6c66 2e61 6c70 6861 292c  r2, self.alpha),
+00000e80: 206d 6574 686f 643d 274c 2d42 4647 532d   method='L-BFGS-
+00000e90: 4227 2c20 6a61 633d 5472 7565 2c20 626f  B', jac=True, bo
+00000ea0: 756e 6473 203d 205b 2830 2e30 2c4e 6f6e  unds = [(0.0,Non
+00000eb0: 6529 5d2a 2832 2a28 7365 6c66 2e72 312b  e)]*(2*(self.r1+
+00000ec0: 7365 6c66 2e72 3229 2a73 656c 662e 6429  self.r2)*self.d)
+00000ed0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00000ee0: 2020 2043 5f76 6563 203d 206f 7574 2e78     C_vec = out.x
+00000ef0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00000f00: 2020 4320 3d20 6e70 2e72 6573 6861 7065    C = np.reshape
+00000f10: 286f 7574 2e78 5b3a 2873 656c 662e 7231  (out.x[:(self.r1
+00000f20: 2b73 656c 662e 7232 292a 7365 6c66 2e64  +self.r2)*self.d
+00000f30: 5d20 2d20 6f75 742e 785b 2873 656c 662e  ] - out.x[(self.
+00000f40: 7231 2b73 656c 662e 7232 292a 7365 6c66  r1+self.r2)*self
+00000f50: 2e64 3a5d 2c20 2873 656c 662e 642c 7365  .d:], (self.d,se
+00000f60: 6c66 2e72 312b 7365 6c66 2e72 3229 290d  lf.r1+self.r2)).
+00000f70: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00000f80: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00000f90: 2020 2020 4320 3d20 6e70 2e64 6f74 2859      C = np.dot(Y
+00000fa0: 5f74 696c 6465 2e54 2c20 585f 7469 6c64  _tilde.T, X_tild
+00000fb0: 6529 2e64 6f74 286e 702e 6c69 6e61 6c67  e).dot(np.linalg
+00000fc0: 2e69 6e76 286e 702e 646f 7428 585f 7469  .inv(np.dot(X_ti
+00000fd0: 6c64 652e 542c 585f 7469 6c64 6529 202b  lde.T,X_tilde) +
+00000fe0: 2030 2e30 3031 2a6e 702e 6964 656e 7469   0.001*np.identi
+00000ff0: 7479 2873 656c 662e 7231 2b73 656c 662e  ty(self.r1+self.
+00001000: 7232 2929 290d 0a20 2020 2020 2020 2065  r2)))..        e
+00001010: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00001020: 2020 4320 3d20 630d 0a0d 0a20 2020 2020    C = c....     
+00001030: 2020 2023 696e 765f 6d20 3d20 6e70 2e6c     #inv_m = np.l
+00001040: 696e 616c 672e 696e 7628 6e70 2e64 6f74  inalg.inv(np.dot
+00001050: 2858 5f74 696c 6465 2e54 2c20 585f 7469  (X_tilde.T, X_ti
+00001060: 6c64 6529 290d 0a20 2020 2020 2020 2023  lde))..        #
+00001070: 4220 3d20 6e70 2e64 6f74 2859 5f74 696c  B = np.dot(Y_til
+00001080: 6465 2e54 2c58 5f74 696c 6465 292e 646f  de.T,X_tilde).do
+00001090: 7428 696e 765f 6d29 0d0a 0d0a 2020 2020  t(inv_m)....    
+000010a0: 2020 2020 6966 2070 7369 2069 7320 4e6f      if psi is No
+000010b0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+000010c0: 2050 7369 5f65 7374 203d 206e 702e 636f   Psi_est = np.co
+000010d0: 7628 2859 5f74 696c 6465 2d6e 702e 646f  v((Y_tilde-np.do
+000010e0: 7428 585f 7469 6c64 652c 432e 5429 292e  t(X_tilde,C.T)).
+000010f0: 5429 2a28 7365 6c66 2e6e 2d31 292f 7365  T)*(self.n-1)/se
+00001100: 6c66 2e6e 0d0a 2020 2020 2020 2020 656c  lf.n..        el
+00001110: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00001120: 2050 7369 5f65 7374 203d 2070 7369 0d0a   Psi_est = psi..
+00001130: 0d0a 0d0a 2020 2020 2020 2020 6966 2077  ....        if w
+00001140: 6974 685f 6d65 616e 3a0d 0a20 2020 2020  ith_mean:..     
+00001150: 2020 2020 2020 2041 203d 2043 5b3a 2c3a         A = C[:,:
+00001160: 7365 6c66 2e72 315d 0d0a 2020 2020 2020  self.r1]..      
+00001170: 2020 2020 2020 4220 3d20 435b 3a2c 7365        B = C[:,se
+00001180: 6c66 2e72 313a 5d0d 0a20 2020 2020 2020  lf.r1:]..       
+00001190: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+000011a0: 2020 2020 4120 3d20 300d 0a20 2020 2020      A = 0..     
+000011b0: 2020 2020 2020 2042 203d 2043 0d0a 0d0a         B = C....
+000011c0: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+000011d0: 662e 7769 7468 5f67 7261 7068 3a0d 0a20  f.with_graph:.. 
+000011e0: 2020 2020 2020 2020 2020 2069 6620 2873             if (s
+000011f0: 656c 662e 465f 6d65 7468 6f64 203d 3d20  elf.F_method == 
+00001200: 2764 6972 6563 7427 2920 2620 7769 7468  'direct') & with
+00001210: 5f6d 6561 6e3a 0d0a 2020 2020 2020 2020  _mean:..        
+00001220: 2020 2020 2020 2020 4620 3d20 7365 6c66          F = self
+00001230: 2e46 5f64 6972 6563 7428 2042 2c20 412c  .F_direct( B, A,
+00001240: 206d 2c76 2c20 5073 695f 7072 655f 696e   m,v, Psi_pre_in
+00001250: 7629 0d0a 2020 2020 2020 2020 2020 2020  v)..            
+00001260: 656c 6966 2028 7365 6c66 2e46 5f6d 6574  elif (self.F_met
+00001270: 686f 6420 3d3d 2027 6469 7265 6374 2729  hod == 'direct')
+00001280: 2026 2028 6e6f 7420 7769 7468 5f6d 6561   & (not with_mea
+00001290: 6e29 3a0d 0a20 2020 2020 2020 2020 2020  n):..           
+000012a0: 2020 2020 2046 203d 2073 656c 662e 465f       F = self.F_
+000012b0: 6469 7265 6374 5f63 6f76 5f6f 6e6c 7928  direct_cov_only(
+000012c0: 2042 2c20 6d2c 762c 2050 7369 5f70 7265   B, m,v, Psi_pre
+000012d0: 5f69 6e76 290d 0a20 2020 2020 2020 2020  _inv)..         
+000012e0: 2020 2065 6c69 6620 2873 656c 662e 465f     elif (self.F_
+000012f0: 6d65 7468 6f64 203d 3d20 2773 6563 616e  method == 'secan
+00001300: 7427 2920 2620 7769 7468 5f6d 6561 6e3a  t') & with_mean:
+00001310: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001320: 2020 4620 3d20 7365 6c66 2e46 5f73 6563    F = self.F_sec
+00001330: 616e 745f 6f70 7469 6d28 422c 2041 2c20  ant_optim(B, A, 
+00001340: 6d2c 762c 2050 7369 5f70 7265 5f69 6e76  m,v, Psi_pre_inv
+00001350: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00001360: 6c69 6620 2873 656c 662e 465f 6d65 7468  lif (self.F_meth
+00001370: 6f64 203d 3d20 2773 6563 616e 7427 2920  od == 'secant') 
+00001380: 2620 286e 6f74 2077 6974 685f 6d65 616e  & (not with_mean
+00001390: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+000013a0: 2020 2020 4620 3d20 7365 6c66 2e46 5f73      F = self.F_s
+000013b0: 6563 616e 745f 6f70 7469 6d28 422c 206e  ecant_optim(B, n
+000013c0: 702e 7a65 726f 7328 2873 656c 662e 642c  p.zeros((self.d,
+000013d0: 2073 656c 662e 7229 292c 206d 2c76 2c20   self.r)), m,v, 
+000013e0: 5073 695f 7072 655f 696e 7629 0d0a 2020  Psi_pre_inv)..  
+000013f0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00001400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001410: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00001420: 7228 6622 465f 6d65 7468 6f64 207b 7365  r(f"F_method {se
+00001430: 6c66 2e46 5f6d 6574 686f 647d 206e 6f74  lf.F_method} not
+00001440: 206b 6e6f 776e 2229 0d0a 2020 2020 2020   known")..      
+00001450: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00001460: 2020 2020 2046 203d 204e 6f6e 650d 0a0d       F = None...
+00001470: 0a0d 0a20 2020 2020 2020 2069 6620 7365  ...        if se
+00001480: 6c66 2e77 6974 685f 6772 6170 683a 0d0a  lf.with_graph:..
+00001490: 2020 2020 2020 2020 2020 2020 746f 6c5f              tol_
+000014a0: 6920 3d20 286e 702e 6c69 6e61 6c67 2e6e  i = (np.linalg.n
+000014b0: 6f72 6d28 432d 435f 7072 6529 202b 206e  orm(C-C_pre) + n
+000014c0: 702e 6c69 6e61 6c67 2e6e 6f72 6d28 462d  p.linalg.norm(F-
+000014d0: 465f 7072 6529 292f 286e 702e 6c69 6e61  F_pre))/(np.lina
+000014e0: 6c67 2e6e 6f72 6d28 465f 7072 6529 202b  lg.norm(F_pre) +
+000014f0: 206e 702e 6c69 6e61 6c67 2e6e 6f72 6d28   np.linalg.norm(
+00001500: 435f 7072 6529 290d 0a20 2020 2020 2020  C_pre))..       
+00001510: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00001520: 2020 2020 746f 6c5f 6920 3d20 6e70 2e6c      tol_i = np.l
+00001530: 696e 616c 672e 6e6f 726d 2843 2d43 5f70  inalg.norm(C-C_p
+00001540: 7265 292f 6e70 2e6c 696e 616c 672e 6e6f  re)/np.linalg.no
+00001550: 726d 2843 5f70 7265 290d 0a0d 0a0d 0a20  rm(C_pre)...... 
+00001560: 2020 2020 2020 2072 6574 7572 6e20 432c         return C,
+00001570: 2050 7369 5f65 7374 2c20 462c 2074 6f6c   Psi_est, F, tol
+00001580: 5f69 0d0a 0d0a 0d0a 0d0a 0d0a 0d0a 0d0a  _i..............
+00001590: 2020 2020 6465 6620 6669 745f 686f 6666      def fit_hoff
+000015a0: 5f62 5f6f 6e6c 7928 7365 6c66 2c20 5832  _b_only(self, X2
+000015b0: 2c20 7073 6920 3d20 4e6f 6e65 2c20 585f  , psi = None, X_
+000015c0: 6669 6c74 6572 203d 204e 6f6e 6529 2d3e  filter = None)->
+000015d0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+000015e0: 2222 220d 0a20 2020 2020 2020 2048 6f66  """..        Hof
+000015f0: 6620 6f6e 6c79 2066 6974 2063 6f76 6172  f only fit covar
+00001600: 6961 6e63 6520 7465 726d 0d0a 2020 2020  iance term..    
+00001610: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
+00001620: 2020 2063 203d 204e 6f6e 650d 0a0d 0a20     c = None.... 
+00001630: 2020 2020 2020 2073 656c 662e 7232 203d         self.r2 =
+00001640: 2058 322e 7368 6170 655b 315d 0d0a 2020   X2.shape[1]..  
+00001650: 2020 2020 2020 7365 6c66 2e72 3120 3d20        self.r1 = 
+00001660: 300d 0a20 2020 2020 2020 200d 0a20 2020  0..        ..   
+00001670: 2020 2020 2059 5f74 696c 6465 203d 206e       Y_tilde = n
+00001680: 702e 7673 7461 636b 2828 7365 6c66 2e59  p.vstack((self.Y
+00001690: 2c20 6e70 2e7a 6572 6f73 2828 7365 6c66  , np.zeros((self
+000016a0: 2e6e 2c73 656c 662e 6429 2929 290d 0a0d  .n,self.d))))...
+000016b0: 0a20 2020 2020 2020 2069 6620 7073 6920  .        if psi 
+000016c0: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
+000016d0: 2020 2020 2020 5073 695f 7072 6520 3d20        Psi_pre = 
+000016e0: 6e70 2e69 6465 6e74 6974 7928 7365 6c66  np.identity(self
+000016f0: 2e64 290d 0a20 2020 2020 2020 2020 2020  .d)..           
+00001700: 2050 7369 5f70 7265 5f69 6e76 203d 206e   Psi_pre_inv = n
+00001710: 702e 6c69 6e61 6c67 2e69 6e76 2850 7369  p.linalg.inv(Psi
+00001720: 5f70 7265 290d 0a20 2020 2020 2020 2065  _pre)..        e
+00001730: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00001740: 2020 5073 695f 7072 6520 3d20 7073 690d    Psi_pre = psi.
+00001750: 0a20 2020 2020 2020 2020 2020 2050 7369  .            Psi
+00001760: 5f70 7265 5f69 6e76 203d 206e 702e 6c69  _pre_inv = np.li
+00001770: 6e61 6c67 2e69 6e76 2850 7369 5f70 7265  nalg.inv(Psi_pre
+00001780: 290d 0a0d 0a20 2020 2020 2020 2076 203d  )....        v =
+00001790: 206e 702e 6f6e 6573 2873 656c 662e 6e29   np.ones(self.n)
+000017a0: 0d0a 2020 2020 2020 2020 6d20 3d20 6e70  ..        m = np
+000017b0: 2e6f 6e65 7328 7365 6c66 2e6e 290d 0a20  .ones(self.n).. 
+000017c0: 2020 2020 2020 2058 5f74 696c 6465 203d         X_tilde =
+000017d0: 2020 6e70 2e76 7374 6163 6b28 286d 5b3a    np.vstack((m[:
+000017e0: 2c6e 702e 6e65 7761 7869 735d 2a58 322c  ,np.newaxis]*X2,
+000017f0: 765b 3a2c 6e70 2e6e 6577 6178 6973 5d2a  v[:,np.newaxis]*
+00001800: 5832 2929 0d0a 2020 2020 2020 2020 2320  X2))..        # 
+00001810: 5468 6520 736f 6c75 7469 6f6e 2069 7320  The solution is 
+00001820: 6576 7279 2073 656e 7369 7469 7665 2074  evry sensitive t
+00001830: 6f20 7468 6520 696e 6974 616c 206d 6174  o the inital mat
+00001840: 7269 782c 2074 6865 206c 3220 7265 6775  rix, the l2 regu
+00001850: 6c61 7269 7a61 7469 6f6e 2066 6f72 2042  larization for B
+00001860: 5f70 7265 2065 6666 6563 7473 2061 6c70  _pre effects alp
+00001870: 6861 0d0a 2020 2020 2020 2020 0d0a 2020  ha..        ..  
+00001880: 2020 2020 2020 435f 7072 6520 3d20 6e70        C_pre = np
+00001890: 2e6f 6e65 7328 2873 656c 662e 642c 2073  .ones((self.d, s
+000018a0: 656c 662e 7232 2929 2320 6e70 2e64 6f74  elf.r2))# np.dot
+000018b0: 2859 5f74 696c 6465 2e54 2c20 585f 7469  (Y_tilde.T, X_ti
+000018c0: 6c64 6529 2e64 6f74 286e 702e 6c69 6e61  lde).dot(np.lina
+000018d0: 6c67 2e69 6e76 286e 702e 646f 7428 585f  lg.inv(np.dot(X_
+000018e0: 7469 6c64 652e 542c 2058 5f74 696c 6465  tilde.T, X_tilde
+000018f0: 2920 2b20 616c 7068 612a 6e70 2e69 6465  ) + alpha*np.ide
+00001900: 6e74 6974 7928 7229 2929 0d0a 2020 2020  ntity(r)))..    
+00001910: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
+00001920: 6c66 2e69 7465 7261 7469 6f6e 203d 2030  lf.iteration = 0
+00001930: 0d0a 2020 2020 2020 2020 7365 6c66 2e74  ..        self.t
+00001940: 6f6c 5f76 6563 203d 206e 702e 7a65 726f  ol_vec = np.zero
+00001950: 7328 7365 6c66 2e6d 6178 5f69 7465 7229  s(self.max_iter)
+00001960: 0d0a 2020 2020 2020 2020 7768 696c 6520  ..        while 
+00001970: 7365 6c66 2e69 7465 7261 7469 6f6e 203c  self.iteration <
+00001980: 7365 6c66 2e6d 6178 5f69 7465 723a 0d0a  self.max_iter:..
+00001990: 0d0a 2020 2020 2020 2020 2020 2020 432c  ..            C,
+000019a0: 2050 7369 5f65 7374 2c20 5f2c 2074 6f6c   Psi_est, _, tol
+000019b0: 5f69 203d 2073 656c 662e 6f6e 655f 6974  _i = self.one_it
+000019c0: 6572 6174 696f 6e28 6e70 2e6c 696e 616c  eration(np.linal
+000019d0: 672e 696e 7628 5073 695f 7072 655f 696e  g.inv(Psi_pre_in
+000019e0: 7629 2c20 7073 692c 2043 5f70 7265 2c20  v), psi, C_pre, 
+000019f0: 632c 2059 5f74 696c 6465 2c20 5831 203d  c, Y_tilde, X1 =
+00001a00: 204e 6f6e 652c 2058 3220 3d20 5832 2c20   None, X2 = X2, 
+00001a10: 7769 7468 5f6d 6561 6e20 3d20 4661 6c73  with_mean = Fals
+00001a20: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00001a30: 7365 6c66 2e74 6f6c 5f76 6563 5b73 656c  self.tol_vec[sel
+00001a40: 662e 6974 6572 6174 696f 6e5d 203d 2074  f.iteration] = t
+00001a50: 6f6c 5f69 0d0a 0d0a 2020 2020 2020 2020  ol_i....        
+00001a60: 2020 2020 6966 2028 746f 6c5f 693c 7365      if (tol_i<se
+00001a70: 6c66 2e74 6f6c 2920 2620 286e 6f74 2073  lf.tol) & (not s
+00001a80: 656c 662e 646f 5f61 6c6c 5f69 7465 7229  elf.do_all_iter)
+00001a90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00001aa0: 2020 2062 7265 616b 0d0a 2020 2020 2020     break..      
+00001ab0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00001ac0: 2020 2020 7365 6c66 2e69 7465 7261 7469      self.iterati
+00001ad0: 6f6e 2b3d 310d 0a0d 0a20 2020 2020 2020  on+=1....       
+00001ae0: 2020 2020 2069 6620 7073 6920 6973 204e       if psi is N
+00001af0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+00001b00: 2020 2020 2020 5073 695f 7072 6520 3d20        Psi_pre = 
+00001b10: 5073 695f 6573 742e 636f 7079 2829 0d0a  Psi_est.copy()..
+00001b20: 0d0a 2020 2020 2020 2020 2020 2020 435f  ..            C_
+00001b30: 7072 6520 3d20 432e 636f 7079 2829 0d0a  pre = C.copy()..
+00001b40: 0d0a 2020 2020 2020 2020 7365 6c66 2e41  ..        self.A
+00001b50: 203d 204e 6f6e 650d 0a20 2020 2020 2020   = None..       
+00001b60: 2073 656c 662e 4220 3d20 430d 0a20 2020   self.B = C..   
+00001b70: 2020 2020 2073 656c 662e 5073 6920 3d20       self.Psi = 
+00001b80: 5073 695f 6573 740d 0a0d 0a20 2020 2064  Psi_est....    d
+00001b90: 6566 2066 6974 5f68 6f66 6628 7365 6c66  ef fit_hoff(self
+00001ba0: 2c20 5831 2c20 5832 2c20 7073 6920 3d20  , X1, X2, psi = 
+00001bb0: 4e6f 6e65 2c20 585f 6669 6c74 6572 203d  None, X_filter =
+00001bc0: 204e 6f6e 6529 2d3e 204e 6f6e 653a 0d0a   None)-> None:..
+00001bd0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00001be0: 2020 2020 2048 6f66 6620 7769 7468 206c       Hoff with l
+00001bf0: 6173 736f 0d0a 2020 2020 2020 2020 2222  asso..        ""
+00001c00: 220d 0a0d 0a20 2020 2020 2020 2063 203d  "....        c =
+00001c10: 204e 6f6e 650d 0a20 2020 2020 2020 2073   None..        s
+00001c20: 656c 662e 7231 203d 2058 312e 7368 6170  elf.r1 = X1.shap
+00001c30: 655b 315d 0d0a 2020 2020 2020 2020 7365  e[1]..        se
+00001c40: 6c66 2e72 3220 3d20 5832 2e73 6861 7065  lf.r2 = X2.shape
+00001c50: 5b31 5d0d 0a0d 0a20 2020 2020 2020 2059  [1]....        Y
+00001c60: 5f74 696c 6465 203d 206e 702e 7673 7461  _tilde = np.vsta
+00001c70: 636b 2828 7365 6c66 2e59 2c20 6e70 2e7a  ck((self.Y, np.z
+00001c80: 6572 6f73 2828 7365 6c66 2e6e 2c73 656c  eros((self.n,sel
+00001c90: 662e 6429 2929 290d 0a0d 0a20 2020 2020  f.d))))....     
+00001ca0: 2020 2069 6620 7073 6920 6973 204e 6f6e     if psi is Non
+00001cb0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00001cc0: 5073 695f 7072 6520 3d20 6e70 2e69 6465  Psi_pre = np.ide
+00001cd0: 6e74 6974 7928 7365 6c66 2e64 290d 0a20  ntity(self.d).. 
+00001ce0: 2020 2020 2020 2020 2020 2050 7369 5f70             Psi_p
+00001cf0: 7265 5f69 6e76 203d 206e 702e 6c69 6e61  re_inv = np.lina
+00001d00: 6c67 2e69 6e76 2850 7369 5f70 7265 290d  lg.inv(Psi_pre).
+00001d10: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00001d20: 2020 2020 2020 2020 2020 2020 5073 695f              Psi_
+00001d30: 7072 6520 3d20 7073 690d 0a20 2020 2020  pre = psi..     
+00001d40: 2020 2020 2020 2050 7369 5f70 7265 5f69         Psi_pre_i
+00001d50: 6e76 203d 206e 702e 6c69 6e61 6c67 2e69  nv = np.linalg.i
+00001d60: 6e76 2850 7369 5f70 7265 290d 0a0d 0a20  nv(Psi_pre).... 
+00001d70: 2020 2020 2020 2076 203d 206e 702e 6f6e         v = np.on
+00001d80: 6573 2873 656c 662e 6e29 0d0a 2020 2020  es(self.n)..    
+00001d90: 2020 2020 6d20 3d20 6e70 2e6f 6e65 7328      m = np.ones(
+00001da0: 7365 6c66 2e6e 290d 0a20 2020 2020 2020  self.n)..       
+00001db0: 2058 5f74 696c 6465 203d 2020 6e70 2e76   X_tilde =  np.v
+00001dc0: 7374 6163 6b28 286e 702e 6873 7461 636b  stack((np.hstack
+00001dd0: 2828 5831 2c20 6d5b 3a2c 6e70 2e6e 6577  ((X1, m[:,np.new
+00001de0: 6178 6973 5d2a 5832 2929 2c6e 702e 6873  axis]*X2)),np.hs
+00001df0: 7461 636b 2828 6e70 2e7a 6572 6f73 2828  tack((np.zeros((
+00001e00: 7365 6c66 2e6e 2c20 7365 6c66 2e72 3129  self.n, self.r1)
+00001e10: 292c 765b 3a2c 6e70 2e6e 6577 6178 6973  ),v[:,np.newaxis
+00001e20: 5d2a 5832 2929 2929 0d0a 2020 2020 2020  ]*X2))))..      
+00001e30: 2020 2320 5468 6520 736f 6c75 7469 6f6e    # The solution
+00001e40: 2069 7320 6576 7279 2073 656e 7369 7469   is evry sensiti
+00001e50: 7665 2074 6f20 7468 6520 696e 6974 616c  ve to the inital
+00001e60: 206d 6174 7269 782c 2074 6865 206c 3220   matrix, the l2 
+00001e70: 7265 6775 6c61 7269 7a61 7469 6f6e 2066  regularization f
+00001e80: 6f72 2042 5f70 7265 2065 6666 6563 7473  or B_pre effects
+00001e90: 2061 6c70 6861 0d0a 2020 2020 2020 2020   alpha..        
+00001ea0: 435f 7072 6520 3d20 6e70 2e6f 6e65 7328  C_pre = np.ones(
+00001eb0: 2873 656c 662e 642c 2073 656c 662e 7231  (self.d, self.r1
+00001ec0: 2b73 656c 662e 7232 2929 2320 6e70 2e64  +self.r2))# np.d
+00001ed0: 6f74 2859 5f74 696c 6465 2e54 2c20 585f  ot(Y_tilde.T, X_
+00001ee0: 7469 6c64 6529 2e64 6f74 286e 702e 6c69  tilde).dot(np.li
+00001ef0: 6e61 6c67 2e69 6e76 286e 702e 646f 7428  nalg.inv(np.dot(
+00001f00: 585f 7469 6c64 652e 542c 2058 5f74 696c  X_tilde.T, X_til
+00001f10: 6465 2920 2b20 616c 7068 612a 6e70 2e69  de) + alpha*np.i
+00001f20: 6465 6e74 6974 7928 7229 2929 0d0a 2020  dentity(r)))..  
+00001f30: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00001f40: 7365 6c66 2e69 7465 7261 7469 6f6e 203d  self.iteration =
+00001f50: 2030 0d0a 2020 2020 2020 2020 7365 6c66   0..        self
+00001f60: 2e74 6f6c 5f76 6563 203d 206e 702e 7a65  .tol_vec = np.ze
+00001f70: 726f 7328 7365 6c66 2e6d 6178 5f69 7465  ros(self.max_ite
+00001f80: 7229 0d0a 2020 2020 2020 2020 7768 696c  r)..        whil
+00001f90: 6520 7365 6c66 2e69 7465 7261 7469 6f6e  e self.iteration
+00001fa0: 203c 7365 6c66 2e6d 6178 5f69 7465 723a   <self.max_iter:
+00001fb0: 0d0a 2020 2020 2020 2020 2020 2020 432c  ..            C,
+00001fc0: 2050 7369 5f65 7374 2c20 5f2c 2074 6f6c   Psi_est, _, tol
+00001fd0: 5f69 203d 2073 656c 662e 6f6e 655f 6974  _i = self.one_it
+00001fe0: 6572 6174 696f 6e28 6e70 2e6c 696e 616c  eration(np.linal
+00001ff0: 672e 696e 7628 5073 695f 7072 655f 696e  g.inv(Psi_pre_in
+00002000: 7629 2c20 7073 692c 2043 5f70 7265 2c20  v), psi, C_pre, 
+00002010: 632c 2059 5f74 696c 6465 2c20 5831 203d  c, Y_tilde, X1 =
+00002020: 2058 312c 2058 3220 3d20 5832 2c20 7769   X1, X2 = X2, wi
+00002030: 7468 5f6d 6561 6e20 3d20 5472 7565 290d  th_mean = True).
+00002040: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00002050: 662e 746f 6c5f 7665 635b 7365 6c66 2e69  f.tol_vec[self.i
+00002060: 7465 7261 7469 6f6e 5d20 3d20 746f 6c5f  teration] = tol_
+00002070: 690d 0a20 2020 2020 2020 2020 2020 2069  i..            i
+00002080: 6620 2874 6f6c 5f69 3c73 656c 662e 746f  f (tol_i<self.to
+00002090: 6c29 2026 2028 6e6f 7420 7365 6c66 2e64  l) & (not self.d
+000020a0: 6f5f 616c 6c5f 6974 6572 293a 0d0a 2020  o_all_iter):..  
+000020b0: 2020 2020 2020 2020 2020 2020 2020 6272                br
+000020c0: 6561 6b0d 0a20 2020 2020 2020 2020 2020  eak..           
+000020d0: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
+000020e0: 656c 662e 6974 6572 6174 696f 6e2b 3d31  elf.iteration+=1
+000020f0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00002100: 6966 2070 7369 2069 7320 4e6f 6e65 3a0d  if psi is None:.
+00002110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002120: 2050 7369 5f70 7265 203d 2050 7369 5f65   Psi_pre = Psi_e
+00002130: 7374 2e63 6f70 7928 290d 0a0d 0a20 2020  st.copy()....   
+00002140: 2020 2020 2020 2020 2043 5f70 7265 203d           C_pre =
+00002150: 2043 2e63 6f70 7928 290d 0a0d 0a20 2020   C.copy()....   
+00002160: 2020 2020 2073 656c 662e 4120 3d20 435b       self.A = C[
+00002170: 3a2c 3a73 656c 662e 7231 5d0d 0a20 2020  :,:self.r1]..   
+00002180: 2020 2020 2073 656c 662e 4220 3d20 435b       self.B = C[
+00002190: 3a2c 7365 6c66 2e72 313a 5d0d 0a20 2020  :,self.r1:]..   
+000021a0: 2020 2020 2073 656c 662e 5073 6920 3d20       self.Psi = 
+000021b0: 5073 695f 6573 740d 0a0d 0a              Psi_est....
```

### Comparing `DyGraph-0.0.2/src/CovReg/graphcovreg.py` & `DyGraph-0.0.3/src/CovReg/graphcovreg.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,827 +1,815 @@
 00000000: 0d0a 0d0a 0d0a 0d0a 0d0a 696d 706f 7274  ..........import
 00000010: 206e 756d 7079 2061 7320 6e70 0d0a 0d0a   numpy as np....
-00000020: 696d 706f 7274 206e 6574 776f 726b 7820  import networkx 
-00000030: 6173 206e 780d 0a69 6d70 6f72 7420 7379  as nx..import sy
-00000040: 730d 0a73 7973 2e70 6174 682e 696e 7365  s..sys.path.inse
-00000050: 7274 2830 2c20 2743 3a2f 5573 6572 732f  rt(0, 'C:/Users/
-00000060: 5573 6572 2f43 6f64 652f 4479 4772 6170  User/Code/DyGrap
-00000070: 6827 290d 0a73 7973 2e70 6174 682e 696e  h')..sys.path.in
-00000080: 7365 7274 2830 2c20 2743 3a2f 5573 6572  sert(0, 'C:/User
-00000090: 732f 5573 6572 2f43 6f64 652f 4479 4772  s/User/Code/DyGr
-000000a0: 6170 682f 7372 6327 290d 0a0d 0a0d 0a0d  aph/src').......
-000000b0: 0a69 6d70 6f72 7420 7471 646d 0d0a 696d  .import tqdm..im
-000000c0: 706f 7274 2073 6369 7079 0d0a 6672 6f6d  port scipy..from
-000000d0: 2073 6369 7079 2e6f 7074 696d 697a 6520   scipy.optimize 
-000000e0: 696d 706f 7274 206d 696e 696d 697a 650d  import minimize.
-000000f0: 0a66 726f 6d20 736b 6c65 6172 6e20 696d  .from sklearn im
-00000100: 706f 7274 206c 696e 6561 725f 6d6f 6465  port linear_mode
-00000110: 6c0d 0a66 726f 6d20 6465 6369 6d61 6c20  l..from decimal 
-00000120: 696d 706f 7274 2044 6563 696d 616c 0d0a  import Decimal..
-00000130: 0d0a 0d0a 6672 6f6d 2043 6f76 5265 672e  ....from CovReg.
-00000140: 636f 7672 6567 2069 6d70 6f72 7420 436f  covreg import Co
-00000150: 7652 6567 0d0a 0d0a 0d0a 0d0a 636c 6173  vReg........clas
-00000160: 7320 4772 6170 6843 6f76 5265 6728 436f  s GraphCovReg(Co
-00000170: 7652 6567 293a 0d0a 0d0a 2020 2020 0d0a  vReg):....    ..
-00000180: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-00000190: 2873 656c 662c 2059 2c20 616c 7068 612c  (self, Y, alpha,
-000001a0: 204b 2c20 4c2c 206f 6d65 6761 2c20 6265   K, L, omega, be
-000001b0: 7461 2c20 722c 206d 6178 5f69 7465 7220  ta, r, max_iter 
-000001c0: 3d20 3130 302c 2074 6f6c 203d 2031 652d  = 100, tol = 1e-
-000001d0: 3329 202d 3e20 4e6f 6e65 3a0d 0a0d 0a20  3) -> None:.... 
-000001e0: 2020 2020 2020 2043 6f76 5265 672e 5f5f         CovReg.__
-000001f0: 696e 6974 5f5f 2873 656c 662c 2059 2c20  init__(self, Y, 
-00000200: 616c 7068 612c 206d 6178 5f69 7465 722c  alpha, max_iter,
-00000210: 2074 6f6c 2920 0d0a 0d0a 2020 2020 2020   tol) ....      
-00000220: 2020 7365 6c66 2e77 6974 685f 6772 6170    self.with_grap
-00000230: 6820 3d20 5472 7565 0d0a 2020 2020 2020  h = True..      
-00000240: 2020 7365 6c66 2e4b 203d 204b 0d0a 2020    self.K = K..  
-00000250: 2020 2020 2020 7365 6c66 2e4b 5f69 6e76        self.K_inv
-00000260: 203d 206e 702e 6c69 6e61 6c67 2e69 6e76   = np.linalg.inv
-00000270: 284b 290d 0a20 2020 2020 2020 2073 656c  (K)..        sel
-00000280: 662e 4c20 3d20 4c0d 0a20 2020 2020 2020  f.L = L..       
-00000290: 2073 656c 662e 6f6d 6567 6120 3d20 6f6d   self.omega = om
-000002a0: 6567 610d 0a20 2020 2020 2020 2073 656c  ega..        sel
-000002b0: 662e 6265 7461 203d 2062 6574 610d 0a20  f.beta = beta.. 
-000002c0: 2020 2020 2020 2073 656c 662e 7220 3d20         self.r = 
-000002d0: 720d 0a0d 0a0d 0a20 2020 2020 2020 2076  r......        v
-000002e0: 2c20 7520 3d20 6e70 2e6c 696e 616c 672e  , u = np.linalg.
-000002f0: 6569 6768 284c 290d 0a0d 0a20 2020 2020  eigh(L)....     
-00000300: 2020 2073 656c 662e 4820 3d20 6e70 2e61     self.H = np.a
-00000310: 7272 6179 286e 702e 646f 7428 752c 206e  rray(np.dot(u, n
-00000320: 702e 6469 6167 286e 702e 6578 7028 2d62  p.diag(np.exp(-b
-00000330: 6574 612a 7629 2929 2e64 6f74 2875 2e54  eta*v))).dot(u.T
-00000340: 2929 0d0a 2020 2020 2020 2020 7365 6c66  ))..        self
-00000350: 2e48 5f73 715f 696e 7620 3d20 6e70 2e6c  .H_sq_inv = np.l
-00000360: 696e 616c 672e 696e 7628 6e70 2e64 6f74  inalg.inv(np.dot
-00000370: 2873 656c 662e 482c 7365 6c66 2e48 2920  (self.H,self.H) 
-00000380: 2b20 302e 3030 312a 6e70 2e69 6465 6e74  + 0.001*np.ident
-00000390: 6974 7928 7365 6c66 2e72 2929 0d0a 2020  ity(self.r))..  
-000003a0: 0d0a 0d0a 2020 2020 4073 7461 7469 636d  ....    @staticm
-000003b0: 6574 686f 640d 0a20 2020 2064 6566 2073  ethod..    def s
-000003c0: 6563 616e 745f 6f62 6a65 6374 6976 6528  ecant_objective(
-000003d0: 7061 7261 6d2c 2072 2c20 6d2c 2076 2c20  param, r, m, v, 
-000003e0: 592c 2070 7369 5f69 6e76 2c20 422c 412c  Y, psi_inv, B,A,
-000003f0: 204b 5f69 6e76 2c20 6f6d 6567 612c 2048   K_inv, omega, H
-00000400: 5f73 715f 696e 7629 3a0d 0a0d 0a20 2020  _sq_inv):....   
-00000410: 2020 2020 200d 0a20 2020 2020 2020 206e       ..        n
-00000420: 203d 2059 2e73 6861 7065 5b30 5d0d 0a20   = Y.shape[0].. 
-00000430: 2020 2020 2020 2064 203d 2059 2e73 6861         d = Y.sha
-00000440: 7065 5b31 5d0d 0a0d 0a20 2020 2020 2020  pe[1]....       
-00000450: 204d 203d 206e 702e 6469 6167 286d 290d   M = np.diag(m).
-00000460: 0a20 2020 2020 2020 2053 203d 206e 702e  .        S = np.
-00000470: 6469 6167 2876 290d 0a0d 0a0d 0a20 2020  diag(v)......   
-00000480: 2020 2020 2059 5f74 696c 6465 203d 206e       Y_tilde = n
-00000490: 702e 7673 7461 636b 2828 592c 206e 702e  p.vstack((Y, np.
-000004a0: 7a65 726f 7328 286e 2c64 2929 2929 0d0a  zeros((n,d))))..
-000004b0: 0d0a 2020 2020 2020 2020 4620 3d20 6e70  ..        F = np
-000004c0: 2e72 6573 6861 7065 2870 6172 616d 2c28  .reshape(param,(
-000004d0: 6e2c 7229 2c20 6f72 6465 723d 2746 2729  n,r), order='F')
-000004e0: 0d0a 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
-000004f0: 465f 7469 6c64 6520 3d20 206e 702e 7673  F_tilde =  np.vs
-00000500: 7461 636b 2828 6e70 2e68 7374 6163 6b28  tack((np.hstack(
-00000510: 2846 2c20 6d5b 3a2c 6e70 2e6e 6577 6178  (F, m[:,np.newax
-00000520: 6973 5d2a 4629 292c 6e70 2e68 7374 6163  is]*F)),np.hstac
-00000530: 6b28 286e 702e 7a65 726f 7328 286e 2c20  k((np.zeros((n, 
-00000540: 7229 292c 765b 3a2c 6e70 2e6e 6577 6178  r)),v[:,np.newax
-00000550: 6973 5d2a 4629 2929 290d 0a20 2020 2020  is]*F))))..     
-00000560: 2020 2043 203d 206e 702e 6873 7461 636b     C = np.hstack
-00000570: 2828 412c 4229 290d 0a0d 0a20 2020 2020  ((A,B))....     
-00000580: 2020 206f 626a 203d 2030 2e35 2a6e 702e     obj = 0.5*np.
-00000590: 7472 6163 6528 6e70 2e64 6f74 2828 595f  trace(np.dot((Y_
-000005a0: 7469 6c64 652d 6e70 2e64 6f74 2846 5f74  tilde-np.dot(F_t
-000005b0: 696c 6465 2c20 432e 5429 292e 542c 2028  ilde, C.T)).T, (
-000005c0: 595f 7469 6c64 652d 6e70 2e64 6f74 2846  Y_tilde-np.dot(F
-000005d0: 5f74 696c 6465 2c20 432e 5429 2929 2e64  _tilde, C.T))).d
-000005e0: 6f74 2870 7369 5f69 6e76 2929 2020 2b20  ot(psi_inv))  + 
-000005f0: 302e 352a 6f6d 6567 612a 6e70 2e74 7261  0.5*omega*np.tra
-00000600: 6365 286e 702e 646f 7428 4b5f 696e 762c  ce(np.dot(K_inv,
-00000610: 2046 292e 646f 7428 485f 7371 5f69 6e76   F).dot(H_sq_inv
-00000620: 292e 646f 7428 462e 5429 290d 0a20 2020  ).dot(F.T))..   
-00000630: 2020 2020 200d 0a20 2020 2020 2020 2067       ..        g
-00000640: 7261 6431 203d 202d 6e70 2e64 6f74 284d  rad1 = -np.dot(M
-00000650: 2c59 292e 646f 7428 7073 695f 696e 7629  ,Y).dot(psi_inv)
-00000660: 2e64 6f74 2842 2920 2d6e 702e 646f 7428  .dot(B) -np.dot(
-00000670: 592c 7073 695f 696e 7629 2e64 6f74 2841  Y,psi_inv).dot(A
-00000680: 2920 0d0a 2020 2020 2020 2020 6772 6164  ) ..        grad
-00000690: 3220 3d20 6e70 2e64 6f74 2846 2c41 2e54  2 = np.dot(F,A.T
-000006a0: 292e 646f 7428 7073 695f 696e 7629 2e64  ).dot(psi_inv).d
-000006b0: 6f74 2841 290d 0a20 2020 2020 2020 2067  ot(A)..        g
-000006c0: 7261 6433 203d 206e 702e 646f 7428 4d2c  rad3 = np.dot(M,
-000006d0: 2046 292e 646f 7428 412e 5429 2e64 6f74   F).dot(A.T).dot
-000006e0: 2870 7369 5f69 6e76 292e 646f 7428 4229  (psi_inv).dot(B)
-000006f0: 202b 206e 702e 646f 7428 4d2c 2046 292e   + np.dot(M, F).
-00000700: 646f 7428 422e 5429 2e64 6f74 2870 7369  dot(B.T).dot(psi
-00000710: 5f69 6e76 292e 646f 7428 4129 0d0a 2020  _inv).dot(A)..  
-00000720: 2020 2020 2020 6772 6164 3420 3d20 6e70        grad4 = np
-00000730: 2e64 6f74 284d 2a2a 322b 532a 2a32 2c46  .dot(M**2+S**2,F
-00000740: 292e 646f 7428 422e 5429 2e64 6f74 2870  ).dot(B.T).dot(p
-00000750: 7369 5f69 6e76 292e 646f 7428 4229 0d0a  si_inv).dot(B)..
-00000760: 0d0a 2020 2020 2020 2020 6772 6164 203d  ..        grad =
-00000770: 2028 6772 6164 3120 2b67 7261 6432 2b67   (grad1 +grad2+g
-00000780: 7261 6433 2b67 7261 6434 2b20 6f6d 6567  rad3+grad4+ omeg
-00000790: 612a 6e70 2e64 6f74 284b 5f69 6e76 2c20  a*np.dot(K_inv, 
-000007a0: 4629 2e64 6f74 2848 5f73 715f 696e 7629  F).dot(H_sq_inv)
-000007b0: 292e 666c 6174 7465 6e28 6f72 6465 723d  ).flatten(order=
-000007c0: 2746 2729 0d0a 0d0a 2020 2020 2020 2020  'F')....        
-000007d0: 7265 7475 726e 206f 626a 2c20 6772 6164  return obj, grad
-000007e0: 0d0a 0d0a 2020 2020 0d0a 2020 2020 6465  ....    ..    de
-000007f0: 6620 465f 7365 6361 6e74 5f6f 7074 696d  f F_secant_optim
-00000800: 2873 656c 662c 422c 2041 2c20 6d2c 762c  (self,B, A, m,v,
-00000810: 2070 7369 5f69 6e76 293a 0d0a 0d0a 0d0a   psi_inv):......
-00000820: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00000830: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00000840: 6f75 7420 3d20 6d69 6e69 6d69 7a65 2873  out = minimize(s
-00000850: 656c 662e 7365 6361 6e74 5f6f 626a 6563  elf.secant_objec
-00000860: 7469 7665 2c20 6e70 2e6f 6e65 7328 7365  tive, np.ones(se
-00000870: 6c66 2e6e 2a73 656c 662e 7229 2c20 6172  lf.n*self.r), ar
-00000880: 6773 203d 2028 7365 6c66 2e72 2c20 6d2c  gs = (self.r, m,
-00000890: 2076 2c20 7365 6c66 2e59 2c20 7073 695f   v, self.Y, psi_
-000008a0: 696e 762c 2042 2c41 2c20 7365 6c66 2e4b  inv, B,A, self.K
-000008b0: 5f69 6e76 2c20 7365 6c66 2e6f 6d65 6761  _inv, self.omega
-000008c0: 2c20 7365 6c66 2e48 5f73 715f 696e 7629  , self.H_sq_inv)
-000008d0: 2c20 6a61 633d 5472 7565 2c20 6d65 7468  , jac=True, meth
-000008e0: 6f64 3d20 274c 2d42 4647 532d 4227 290d  od= 'L-BFGS-B').
-000008f0: 0a0d 0a0d 0a20 2020 2020 2020 2020 2020  .....           
-00000900: 2072 6574 7572 6e20 6e70 2e72 6573 6861   return np.resha
-00000910: 7065 286f 7574 2e78 2c28 7365 6c66 2e6e  pe(out.x,(self.n
-00000920: 2c73 656c 662e 7229 2c20 6f72 6465 723d  ,self.r), order=
-00000930: 2746 2729 0d0a 0d0a 0d0a 2020 2020 6465  'F')......    de
-00000940: 6620 465f 6c73 2873 656c 662c 2041 2c20  f F_ls(self, A, 
-00000950: 7073 695f 696e 7629 3a0d 0a0d 0a20 2020  psi_inv):....   
-00000960: 2020 2020 2041 5f71 7561 6420 3d20 6e70       A_quad = np
-00000970: 2e64 6f74 2841 2e54 2c20 7073 695f 696e  .dot(A.T, psi_in
-00000980: 7629 2e64 6f74 2841 290d 0a20 2020 2020  v).dot(A)..     
-00000990: 2020 2046 5f6c 735f 6e6f 5f67 7261 7068     F_ls_no_graph
-000009a0: 203d 206e 702e 646f 7428 7365 6c66 2e59   = np.dot(self.Y
-000009b0: 2c20 7073 695f 696e 7629 2e64 6f74 2841  , psi_inv).dot(A
-000009c0: 292e 646f 7428 6e70 2e6c 696e 616c 672e  ).dot(np.linalg.
-000009d0: 7069 6e76 2841 5f71 7561 6429 2b30 2e30  pinv(A_quad)+0.0
-000009e0: 3031 2a6e 702e 6964 656e 7469 7479 2841  01*np.identity(A
-000009f0: 2e73 6861 7065 5b31 5d29 2920 0d0a 0d0a  .shape[1])) ....
-00000a00: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00000a10: 2046 5f6c 735f 6e6f 5f67 7261 7068 0d0a   F_ls_no_graph..
-00000a20: 0d0a 0d0a 2020 2020 0d0a 0d0a 2020 2020  ....    ....    
-00000a30: 6465 6620 465f 6c73 5f72 6567 2873 656c  def F_ls_reg(sel
-00000a40: 662c 2041 2c20 7073 695f 696e 7629 3a0d  f, A, psi_inv):.
-00000a50: 0a0d 0a20 2020 2020 2020 2049 5f6e 203d  ...        I_n =
-00000a60: 206e 702e 6964 656e 7469 7479 2873 656c   np.identity(sel
-00000a70: 662e 6e29 0d0a 0d0a 0d0a 2020 2020 2020  f.n)......      
-00000a80: 2020 415f 7175 6164 203d 206e 702e 646f    A_quad = np.do
-00000a90: 7428 412e 542c 2070 7369 5f69 6e76 292e  t(A.T, psi_inv).
-00000aa0: 646f 7428 4129 0d0a 0d0a 2020 2020 2020  dot(A)....      
-00000ab0: 2020 6d61 7420 3d20 6e70 2e6b 726f 6e28    mat = np.kron(
-00000ac0: 415f 7175 6164 2c20 495f 6e29 202b 206e  A_quad, I_n) + n
-00000ad0: 702e 6b72 6f6e 2873 656c 662e 485f 7371  p.kron(self.H_sq
-00000ae0: 5f69 6e76 2c73 656c 662e 4b5f 696e 7629  _inv,self.K_inv)
-00000af0: 0d0a 2020 2020 2020 2020 6c2c 2075 203d  ..        l, u =
-00000b00: 206e 702e 6c69 6e61 6c67 2e65 6967 6828   np.linalg.eigh(
-00000b10: 6d61 7429 0d0a 2020 2020 2020 2020 6966  mat)..        if
-00000b20: 2073 656c 662e 7479 7065 5f72 6567 203d   self.type_reg =
-00000b30: 3d20 2754 696b 616e 6f76 273a 0d0a 2020  = 'Tikanov':..  
-00000b40: 2020 2020 2020 2020 2020 696e 765f 6d61            inv_ma
-00000b50: 7420 3d20 6e70 2e64 6f74 2875 2c20 6e70  t = np.dot(u, np
-00000b60: 2e64 6961 6728 312f 286c 2b73 656c 662e  .diag(1/(l+self.
-00000b70: 7265 6729 2929 2e64 6f74 2875 2e54 290d  reg))).dot(u.T).
-00000b80: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-00000b90: 6c66 2e74 7970 655f 7265 6720 3d3d 2027  lf.type_reg == '
-00000ba0: 7370 6563 7472 616c 273a 0d0a 2020 2020  spectral':..    
-00000bb0: 2020 2020 2020 2020 6c5f 696e 7620 3d20          l_inv = 
-00000bc0: 312f 6c0d 0a20 2020 2020 2020 2020 2020  1/l..           
-00000bd0: 206c 5f69 6e76 5b6c 3c73 656c 662e 7265   l_inv[l<self.re
-00000be0: 675d 203d 2030 0d0a 2020 2020 2020 2020  g] = 0..        
-00000bf0: 2020 2020 696e 765f 6d61 7420 3d20 6e70      inv_mat = np
-00000c00: 2e64 6f74 2875 2c20 6e70 2e64 6961 6728  .dot(u, np.diag(
-00000c10: 6c5f 696e 7629 292e 646f 7428 752e 5429  l_inv)).dot(u.T)
-00000c20: 0d0a 0d0a 2020 2020 2020 2020 4620 3d20  ....        F = 
-00000c30: 6e70 2e64 6f74 2869 6e76 5f6d 6174 2c20  np.dot(inv_mat, 
-00000c40: 6e70 2e64 6f74 2873 656c 662e 592c 2070  np.dot(self.Y, p
-00000c50: 7369 5f69 6e76 292e 646f 7428 4129 2e66  si_inv).dot(A).f
-00000c60: 6c61 7474 656e 286f 7264 6572 3d27 4627  latten(order='F'
-00000c70: 2929 0d0a 2020 2020 2020 2020 0d0a 2020  ))..        ..  
-00000c80: 2020 2020 2020 7265 7475 726e 206e 702e        return np.
-00000c90: 7265 7368 6170 6528 462c 2873 656c 662e  reshape(F,(self.
-00000ca0: 6e2c 7365 6c66 2e72 292c 206f 7264 6572  n,self.r), order
-00000cb0: 3d27 4627 290d 0a0d 0a0d 0a0d 0a20 2020  ='F')........   
-00000cc0: 2064 6566 2046 5f63 6f76 5f6e 6f5f 6772   def F_cov_no_gr
-00000cd0: 6170 6828 7365 6c66 2c20 2042 2c20 6d2c  aph(self,  B, m,
-00000ce0: 762c 7073 695f 696e 7629 3a0d 0a0d 0a20  v,psi_inv):.... 
-00000cf0: 2020 2020 2020 204d 203d 206e 702e 6469         M = np.di
-00000d00: 6167 286d 290d 0a20 2020 2020 2020 2053  ag(m)..        S
-00000d10: 203d 206e 702e 6469 6167 2876 290d 0a20   = np.diag(v).. 
-00000d20: 2020 2020 2020 2069 6e76 5f65 6d20 3d20         inv_em = 
-00000d30: 6e70 2e6c 696e 616c 672e 696e 7628 4d2a  np.linalg.inv(M*
-00000d40: 2a32 2b53 2a2a 3229 0d0a 2020 2020 2020  *2+S**2)..      
-00000d50: 2020 425f 7175 6164 203d 206e 702e 646f    B_quad = np.do
-00000d60: 7428 422e 542c 2070 7369 5f69 6e76 292e  t(B.T, psi_inv).
-00000d70: 646f 7428 4229 0d0a 0d0a 2020 2020 2020  dot(B)....      
-00000d80: 2020 4620 3d20 6e70 2e64 6f74 2869 6e76    F = np.dot(inv
-00000d90: 5f65 6d2c 204d 292e 646f 7428 7365 6c66  _em, M).dot(self
-00000da0: 2e59 292e 646f 7428 7073 695f 696e 7629  .Y).dot(psi_inv)
-00000db0: 2e64 6f74 2842 292e 646f 7428 6e70 2e6c  .dot(B).dot(np.l
-00000dc0: 696e 616c 672e 7069 6e76 2842 5f71 7561  inalg.pinv(B_qua
-00000dd0: 6429 290d 0a20 2020 2020 2020 2072 6574  d))..        ret
-00000de0: 7572 6e20 460d 0a0d 0a0d 0a20 2020 2064  urn F......    d
-00000df0: 6566 2046 5f64 6972 6563 745f 636f 765f  ef F_direct_cov_
-00000e00: 6f6e 6c79 2873 656c 662c 2020 422c 206d  only(self,  B, m
-00000e10: 2c76 2c20 7073 695f 696e 7620 293a 0d0a  ,v, psi_inv ):..
-00000e20: 2020 2020 2020 2020 4d20 3d20 6e70 2e64          M = np.d
-00000e30: 6961 6728 6d29 0d0a 2020 2020 2020 2020  iag(m)..        
-00000e40: 5320 3d20 6e70 2e64 6961 6728 7629 0d0a  S = np.diag(v)..
-00000e50: 0d0a 2020 2020 2020 2020 425f 7175 6164  ..        B_quad
-00000e60: 203d 206e 702e 646f 7428 422e 542c 2070   = np.dot(B.T, p
-00000e70: 7369 5f69 6e76 292e 646f 7428 4229 0d0a  si_inv).dot(B)..
-00000e80: 0d0a 2020 2020 2020 2020 2320 6d61 7420  ..        # mat 
-00000e90: 3d20 6e70 2e6b 726f 6e28 485f 7371 5f69  = np.kron(H_sq_i
-00000ea0: 6e76 2b30 2e31 2a6e 702e 6964 656e 7469  nv+0.1*np.identi
-00000eb0: 7479 2872 292c 204b 5f69 6e76 2b30 2e31  ty(r), K_inv+0.1
-00000ec0: 2a6e 702e 6964 656e 7469 7479 286e 2929  *np.identity(n))
-00000ed0: 202b 206e 702e 6b72 6f6e 2841 5f71 7561   + np.kron(A_qua
-00000ee0: 642b 302e 312a 6e70 2e69 6465 6e74 6974  d+0.1*np.identit
-00000ef0: 7928 7229 2c20 6e70 2e69 6465 6e74 6974  y(r), np.identit
-00000f00: 7928 6e29 290d 0a20 2020 2020 2020 206d  y(n))..        m
-00000f10: 6174 203d 206e 702e 6b72 6f6e 2873 656c  at = np.kron(sel
-00000f20: 662e 485f 7371 5f69 6e76 2c20 7365 6c66  f.H_sq_inv, self
-00000f30: 2e4b 5f69 6e76 2920 2b20 6e70 2e6b 726f  .K_inv) + np.kro
-00000f40: 6e28 425f 7175 6164 2c20 4d2a 2a32 2b53  n(B_quad, M**2+S
-00000f50: 2a2a 3229 0d0a 2020 2020 2020 2020 6c2c  **2)..        l,
-00000f60: 2075 203d 206e 702e 6c69 6e61 6c67 2e65   u = np.linalg.e
-00000f70: 6967 6828 6d61 7429 0d0a 2020 2020 2020  igh(mat)..      
-00000f80: 2020 6966 2073 656c 662e 7479 7065 5f72    if self.type_r
-00000f90: 6567 203d 3d20 2754 696b 616e 6f76 273a  eg == 'Tikanov':
-00000fa0: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
-00000fb0: 765f 6d61 7420 3d20 6e70 2e64 6f74 2875  v_mat = np.dot(u
-00000fc0: 2c20 6e70 2e64 6961 6728 312f 286c 2b73  , np.diag(1/(l+s
-00000fd0: 656c 662e 7265 6729 2929 2e64 6f74 2875  elf.reg))).dot(u
-00000fe0: 2e54 290d 0a20 2020 2020 2020 2065 6c69  .T)..        eli
-00000ff0: 6620 7365 6c66 2e74 7970 655f 7265 6720  f self.type_reg 
-00001000: 3d3d 2027 7370 6563 7472 616c 273a 0d0a  == 'spectral':..
-00001010: 2020 2020 2020 2020 2020 2020 6c5f 696e              l_in
-00001020: 7620 3d20 312f 6c0d 0a20 2020 2020 2020  v = 1/l..       
-00001030: 2020 2020 206c 5f69 6e76 5b6c 3c73 656c       l_inv[l<sel
-00001040: 662e 7265 675d 203d 2030 0d0a 2020 2020  f.reg] = 0..    
-00001050: 2020 2020 2020 2020 696e 765f 6d61 7420          inv_mat 
-00001060: 3d20 6e70 2e64 6f74 2875 2c20 6e70 2e64  = np.dot(u, np.d
-00001070: 6961 6728 6c5f 696e 7629 292e 646f 7428  iag(l_inv)).dot(
-00001080: 752e 5429 0d0a 2020 2020 2020 2020 465f  u.T)..        F_
-00001090: 6c73 203d 206e 702e 646f 7428 2069 6e76  ls = np.dot( inv
-000010a0: 5f6d 6174 2c20 6e70 2e64 6f74 284d 2c20  _mat, np.dot(M, 
-000010b0: 7365 6c66 2e59 292e 646f 7428 7073 695f  self.Y).dot(psi_
-000010c0: 696e 7629 2e64 6f74 2842 292e 666c 6174  inv).dot(B).flat
-000010d0: 7465 6e28 6f72 6465 723d 2746 2729 290d  ten(order='F')).
-000010e0: 0a20 2020 2020 2020 2046 5f6c 7320 3d20  .        F_ls = 
-000010f0: 6e70 2e72 6573 6861 7065 2846 5f6c 732c  np.reshape(F_ls,
-00001100: 2873 656c 662e 6e2c 7365 6c66 2e72 292c  (self.n,self.r),
-00001110: 206f 7264 6572 3d27 4627 290d 0a0d 0a20   order='F').... 
-00001120: 2020 2020 2020 2072 6574 7572 6e20 465f         return F_
-00001130: 6c73 0d0a 0d0a 0d0a 2020 2020 6465 6620  ls......    def 
-00001140: 465f 6469 7265 6374 2873 656c 662c 422c  F_direct(self,B,
-00001150: 2041 2c20 6d2c 762c 2070 7369 5f69 6e76   A, m,v, psi_inv
-00001160: 293a 0d0a 0d0a 2020 2020 2020 2020 495f  ):....        I_
-00001170: 6e20 3d20 6e70 2e69 6465 6e74 6974 7928  n = np.identity(
-00001180: 7365 6c66 2e6e 290d 0a20 2020 2020 2020  self.n)..       
-00001190: 204d 203d 206e 702e 6469 6167 286d 290d   M = np.diag(m).
-000011a0: 0a20 2020 2020 2020 2053 203d 206e 702e  .        S = np.
-000011b0: 6469 6167 2876 290d 0a0d 0a0d 0a20 2020  diag(v)......   
-000011c0: 2020 2020 2042 5f71 7561 6420 3d20 6e70       B_quad = np
-000011d0: 2e64 6f74 2842 2e54 2c20 7073 695f 696e  .dot(B.T, psi_in
-000011e0: 7629 2e64 6f74 2842 290d 0a20 2020 2020  v).dot(B)..     
-000011f0: 2020 2041 5f71 7561 6420 3d20 6e70 2e64     A_quad = np.d
-00001200: 6f74 2841 2e54 2c20 7073 695f 696e 7629  ot(A.T, psi_inv)
-00001210: 2e64 6f74 2841 290d 0a20 2020 2020 2020  .dot(A)..       
-00001220: 2041 425f 7175 6164 203d 206e 702e 646f   AB_quad = np.do
-00001230: 7428 412e 542c 2070 7369 5f69 6e76 292e  t(A.T, psi_inv).
-00001240: 646f 7428 4229 0d0a 0d0a 2020 2020 2020  dot(B)....      
-00001250: 2020 6d61 7420 3d20 6e70 2e6b 726f 6e28    mat = np.kron(
-00001260: 415f 7175 6164 2c20 495f 6e29 202b 206e  A_quad, I_n) + n
-00001270: 702e 6b72 6f6e 2841 425f 7175 6164 2b41  p.kron(AB_quad+A
-00001280: 425f 7175 6164 2e54 2c20 4d29 202b 206e  B_quad.T, M) + n
-00001290: 702e 6b72 6f6e 2842 5f71 7561 642c 204d  p.kron(B_quad, M
-000012a0: 2a2a 322b 532a 2a32 2920 2b20 6e70 2e6b  **2+S**2) + np.k
-000012b0: 726f 6e28 7365 6c66 2e48 5f73 715f 696e  ron(self.H_sq_in
-000012c0: 762c 7365 6c66 2e4b 5f69 6e76 290d 0a20  v,self.K_inv).. 
-000012d0: 2020 2020 2020 206c 2c20 7520 3d20 6e70         l, u = np
-000012e0: 2e6c 696e 616c 672e 6569 6768 286d 6174  .linalg.eigh(mat
-000012f0: 290d 0a20 2020 2020 2020 2069 6620 7365  )..        if se
-00001300: 6c66 2e74 7970 655f 7265 6720 3d3d 2027  lf.type_reg == '
-00001310: 5469 6b61 6e6f 7627 3a0d 0a20 2020 2020  Tikanov':..     
-00001320: 2020 2020 2020 2069 6e76 5f6d 6174 203d         inv_mat =
-00001330: 206e 702e 646f 7428 752c 206e 702e 6469   np.dot(u, np.di
-00001340: 6167 2831 2f28 6c2b 7365 6c66 2e72 6567  ag(1/(l+self.reg
-00001350: 2929 292e 646f 7428 752e 5429 0d0a 2020  ))).dot(u.T)..  
-00001360: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-00001370: 7479 7065 5f72 6567 203d 3d20 2773 7065  type_reg == 'spe
-00001380: 6374 7261 6c27 3a0d 0a20 2020 2020 2020  ctral':..       
-00001390: 2020 2020 206c 5f69 6e76 203d 2031 2f6c       l_inv = 1/l
-000013a0: 0d0a 2020 2020 2020 2020 2020 2020 6c5f  ..            l_
-000013b0: 696e 765b 6c3c 7365 6c66 2e72 6567 5d20  inv[l<self.reg] 
-000013c0: 3d20 300d 0a20 2020 2020 2020 2020 2020  = 0..           
-000013d0: 2069 6e76 5f6d 6174 203d 206e 702e 646f   inv_mat = np.do
-000013e0: 7428 752c 206e 702e 6469 6167 286c 5f69  t(u, np.diag(l_i
-000013f0: 6e76 2929 2e64 6f74 2875 2e54 290d 0a0d  nv)).dot(u.T)...
-00001400: 0a20 2020 2020 2020 2046 203d 206e 702e  .        F = np.
-00001410: 646f 7428 696e 765f 6d61 742c 2028 6e70  dot(inv_mat, (np
-00001420: 2e64 6f74 2873 656c 662e 592c 2070 7369  .dot(self.Y, psi
-00001430: 5f69 6e76 292e 646f 7428 4129 202b 206e  _inv).dot(A) + n
-00001440: 702e 646f 7428 4d2c 2073 656c 662e 5929  p.dot(M, self.Y)
-00001450: 2e64 6f74 2870 7369 5f69 6e76 292e 646f  .dot(psi_inv).do
-00001460: 7428 4229 292e 666c 6174 7465 6e28 6f72  t(B)).flatten(or
-00001470: 6465 723d 2746 2729 290d 0a20 2020 2020  der='F'))..     
-00001480: 2020 2072 6574 7572 6e20 6e70 2e72 6573     return np.res
-00001490: 6861 7065 2846 2c28 7365 6c66 2e6e 2c73  hape(F,(self.n,s
-000014a0: 656c 662e 7229 2c20 6f72 6465 723d 2746  elf.r), order='F
-000014b0: 2729 0d0a 2020 2020 0d0a 0d0a 2020 2020  ')..    ....    
-000014c0: 6465 6620 6669 745f 6767 7028 7365 6c66  def fit_ggp(self
-000014d0: 2c20 7073 6920 3d20 4e6f 6e65 2c20 465f  , psi = None, F_
-000014e0: 7374 6172 7420 3d20 4e6f 6e65 2c20 7265  start = None, re
-000014f0: 6720 3d20 4e6f 6e65 2c20 7479 7065 5f72  g = None, type_r
-00001500: 6567 203d 204e 6f6e 652c 2046 5f6d 6574  eg = None, F_met
-00001510: 686f 6420 3d20 2764 6972 6563 7427 2c20  hod = 'direct', 
-00001520: 6320 3d20 4e6f 6e65 2c20 7665 7262 6f73  c = None, verbos
-00001530: 6520 3d20 5472 7565 292d 3e20 4e6f 6e65  e = True)-> None
-00001540: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
-00001550: 2020 2020 2020 2020 4772 6170 6820 4750          Graph GP
-00001560: 206f 6e6c 7920 6669 7420 636f 7661 7269   only fit covari
-00001570: 616e 6365 2074 6572 6d0d 0a20 2020 2020  ance term..     
-00001580: 2020 2022 2222 0d0a 0d0a 0d0a 2020 2020     """......    
-00001590: 2020 2020 7365 6c66 2e72 6567 203d 2072      self.reg = r
-000015a0: 6567 0d0a 2020 2020 2020 2020 7365 6c66  eg..        self
-000015b0: 2e74 7970 655f 7265 6720 3d20 7479 7065  .type_reg = type
-000015c0: 5f72 6567 0d0a 0d0a 2020 2020 2020 2020  _reg....        
-000015d0: 7365 6c66 2e46 5f6d 6574 686f 6420 3d20  self.F_method = 
-000015e0: 465f 6d65 7468 6f64 0d0a 0d0a 0d0a 2020  F_method......  
-000015f0: 2020 2020 2020 7365 6c66 2e72 3120 3d20        self.r1 = 
-00001600: 7365 6c66 2e72 0d0a 2020 2020 2020 2020  self.r..        
-00001610: 7365 6c66 2e72 3220 3d20 7365 6c66 2e72  self.r2 = self.r
-00001620: 0d0a 0d0a 0d0a 2020 2020 2020 2020 6966  ......        if
-00001630: 2046 5f73 7461 7274 2069 7320 4e6f 6e65   F_start is None
-00001640: 3a0d 0a20 2020 2020 2020 2020 2020 2046  :..            F
-00001650: 5f70 7265 203d 206e 702e 6f6e 6573 2828  _pre = np.ones((
-00001660: 7365 6c66 2e6e 2c20 7365 6c66 2e72 2929  self.n, self.r))
-00001670: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00001680: 0a20 2020 2020 2020 2020 2020 2046 5f70  .            F_p
-00001690: 7265 203d 2046 5f73 7461 7274 0d0a 0d0a  re = F_start....
-000016a0: 0d0a 2020 2020 2020 2020 595f 7469 6c64  ..        Y_tild
-000016b0: 6520 3d20 6e70 2e76 7374 6163 6b28 2873  e = np.vstack((s
-000016c0: 656c 662e 592c 206e 702e 7a65 726f 7328  elf.Y, np.zeros(
-000016d0: 2873 656c 662e 6e2c 7365 6c66 2e64 2929  (self.n,self.d))
-000016e0: 2929 0d0a 0d0a 0d0a 2020 2020 2020 2020  ))......        
-000016f0: 6966 2070 7369 2069 7320 4e6f 6e65 3a0d  if psi is None:.
-00001700: 0a20 2020 2020 2020 2020 2020 2050 7369  .            Psi
-00001710: 5f70 7265 203d 206e 702e 6964 656e 7469  _pre = np.identi
-00001720: 7479 2873 656c 662e 6429 0d0a 2020 2020  ty(self.d)..    
-00001730: 2020 2020 2020 2020 5073 695f 7072 655f          Psi_pre_
-00001740: 696e 7620 3d20 6e70 2e6c 696e 616c 672e  inv = np.linalg.
-00001750: 696e 7628 5073 695f 7072 6529 0d0a 2020  inv(Psi_pre)..  
-00001760: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00001770: 2020 2020 2020 2020 2050 7369 5f70 7265           Psi_pre
-00001780: 203d 2070 7369 0d0a 2020 2020 2020 2020   = psi..        
-00001790: 2020 2020 5073 695f 7072 655f 696e 7620      Psi_pre_inv 
-000017a0: 3d20 6e70 2e6c 696e 616c 672e 696e 7628  = np.linalg.inv(
-000017b0: 5073 695f 7072 6529 0d0a 0d0a 2020 2020  Psi_pre)....    
-000017c0: 2020 2020 7620 3d20 6e70 2e6f 6e65 7328      v = np.ones(
-000017d0: 7365 6c66 2e6e 290d 0a20 2020 2020 2020  self.n)..       
-000017e0: 206d 203d 206e 702e 6f6e 6573 2873 656c   m = np.ones(sel
-000017f0: 662e 6e29 0d0a 2020 2020 2020 2020 2320  f.n)..        # 
-00001800: 5468 6520 736f 6c75 7469 6f6e 2069 7320  The solution is 
-00001810: 6576 7279 2073 656e 7369 7469 7665 2074  evry sensitive t
-00001820: 6f20 7468 6520 696e 6974 616c 206d 6174  o the inital mat
-00001830: 7269 782c 2074 6865 206c 3220 7265 6775  rix, the l2 regu
-00001840: 6c61 7269 7a61 7469 6f6e 2066 6f72 2042  larization for B
-00001850: 5f70 7265 2065 6666 6563 7473 2061 6c70  _pre effects alp
-00001860: 6861 0d0a 2020 2020 2020 2020 6966 2063  ha..        if c
-00001870: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
-00001880: 2020 2020 2020 2043 5f70 7265 203d 206e         C_pre = n
-00001890: 702e 6f6e 6573 2828 7365 6c66 2e64 2c20  p.ones((self.d, 
-000018a0: 7365 6c66 2e72 2b73 656c 662e 7229 2923  self.r+self.r))#
-000018b0: 206e 702e 646f 7428 595f 7469 6c64 652e   np.dot(Y_tilde.
-000018c0: 542c 2058 5f74 696c 6465 292e 646f 7428  T, X_tilde).dot(
-000018d0: 6e70 2e6c 696e 616c 672e 696e 7628 6e70  np.linalg.inv(np
-000018e0: 2e64 6f74 2858 5f74 696c 6465 2e54 2c20  .dot(X_tilde.T, 
-000018f0: 585f 7469 6c64 6529 202b 2061 6c70 6861  X_tilde) + alpha
-00001900: 2a6e 702e 6964 656e 7469 7479 2872 2929  *np.identity(r))
-00001910: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-00001920: 0d0a 2020 2020 2020 2020 2020 2020 435f  ..            C_
-00001930: 7072 6520 3d20 630d 0a0d 0a20 2020 2020  pre = c....     
-00001940: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
-00001950: 662e 6974 6572 6174 696f 6e20 3d20 300d  f.iteration = 0.
-00001960: 0a20 2020 2020 2020 2073 656c 662e 746f  .        self.to
-00001970: 6c5f 7665 6320 3d20 6e70 2e7a 6572 6f73  l_vec = np.zeros
-00001980: 2873 656c 662e 6d61 785f 6974 6572 290d  (self.max_iter).
-00001990: 0a0d 0a20 2020 2020 2020 2069 6620 7665  ...        if ve
-000019a0: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-000019b0: 2020 2020 7062 6172 203d 2074 7164 6d2e      pbar = tqdm.
-000019c0: 7471 646d 2874 6f74 616c 203d 2073 656c  tqdm(total = sel
-000019d0: 662e 6d61 785f 6974 6572 290d 0a20 2020  f.max_iter)..   
-000019e0: 2020 2020 2077 6869 6c65 2073 656c 662e       while self.
-000019f0: 6974 6572 6174 696f 6e20 3c73 656c 662e  iteration <self.
-00001a00: 6d61 785f 6974 6572 3a0d 0a20 2020 2020  max_iter:..     
-00001a10: 2020 2020 2020 2043 2c20 5073 695f 6573         C, Psi_es
-00001a20: 742c 2046 2c20 746f 6c5f 6920 3d20 7365  t, F, tol_i = se
-00001a30: 6c66 2e6f 6e65 5f69 7465 7261 7469 6f6e  lf.one_iteration
-00001a40: 286e 702e 6c69 6e61 6c67 2e69 6e76 2850  (np.linalg.inv(P
-00001a50: 7369 5f70 7265 5f69 6e76 292c 2070 7369  si_pre_inv), psi
-00001a60: 2c20 435f 7072 652c 2063 2c20 595f 7469  , C_pre, c, Y_ti
-00001a70: 6c64 652c 2046 5f70 7265 203d 2046 5f70  lde, F_pre = F_p
-00001a80: 7265 2c20 7769 7468 5f6d 6561 6e20 3d20  re, with_mean = 
-00001a90: 5472 7565 2920 2020 200d 0a20 2020 2020  True)    ..     
-00001aa0: 2020 2020 2020 2073 656c 662e 746f 6c5f         self.tol_
-00001ab0: 7665 635b 7365 6c66 2e69 7465 7261 7469  vec[self.iterati
-00001ac0: 6f6e 5d20 3d20 746f 6c5f 690d 0a0d 0a20  on] = tol_i.... 
-00001ad0: 2020 2020 2020 2020 2020 2069 6620 7665             if ve
-00001ae0: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-00001af0: 2020 2020 2020 2020 7062 6172 2e73 6574          pbar.set
-00001b00: 5f64 6573 6372 6970 7469 6f6e 2866 2245  _description(f"E
-00001b10: 7272 6f72 207b 4465 6369 6d61 6c28 746f  rror {Decimal(to
-00001b20: 6c5f 6929 3a2e 3245 7d22 290d 0a20 2020  l_i):.2E}")..   
-00001b30: 2020 2020 2020 2020 2020 2020 2070 6261               pba
-00001b40: 722e 7570 6461 7465 2829 0d0a 0d0a 2020  r.update()....  
-00001b50: 2020 2020 2020 2020 2020 6966 2028 746f            if (to
-00001b60: 6c5f 693c 7365 6c66 2e74 6f6c 2920 2620  l_i<self.tol) & 
-00001b70: 286e 6f74 2073 656c 662e 646f 5f61 6c6c  (not self.do_all
-00001b80: 5f69 7465 7229 3a0d 0a20 2020 2020 2020  _iter):..       
-00001b90: 2020 2020 2020 2020 2062 7265 616b 0d0a           break..
-00001ba0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00001bb0: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
-00001bc0: 7465 7261 7469 6f6e 2b3d 310d 0a0d 0a20  teration+=1.... 
-00001bd0: 2020 2020 2020 2020 2020 2069 6620 7073             if ps
-00001be0: 6920 6973 204e 6f6e 653a 0d0a 2020 2020  i is None:..    
-00001bf0: 2020 2020 2020 2020 2020 2020 5073 695f              Psi_
-00001c00: 7072 6520 3d20 5073 695f 6573 742e 636f  pre = Psi_est.co
-00001c10: 7079 2829 0d0a 0d0a 2020 2020 2020 2020  py()....        
-00001c20: 2020 2020 435f 7072 6520 3d20 432e 636f      C_pre = C.co
-00001c30: 7079 2829 0d0a 2020 2020 2020 2020 2020  py()..          
-00001c40: 2020 465f 7072 6520 3d20 462e 636f 7079    F_pre = F.copy
-00001c50: 2829 0d0a 0d0a 2020 2020 2020 2020 7365  ()....        se
-00001c60: 6c66 2e41 203d 2043 5b3a 2c3a 7365 6c66  lf.A = C[:,:self
-00001c70: 2e72 5d0d 0a20 2020 2020 2020 2073 656c  .r]..        sel
-00001c80: 662e 4220 3d20 435b 3a2c 7365 6c66 2e72  f.B = C[:,self.r
-00001c90: 3a5d 0d0a 2020 2020 2020 2020 7365 6c66  :]..        self
-00001ca0: 2e46 203d 2046 0d0a 2020 2020 2020 2020  .F = F..        
-00001cb0: 7365 6c66 2e50 7369 203d 2050 7369 5f65  self.Psi = Psi_e
-00001cc0: 7374 0d0a 0d0a 2020 2020 2020 2020 6966  st....        if
-00001cd0: 2076 6572 626f 7365 3a0d 0a20 2020 2020   verbose:..     
-00001ce0: 2020 2020 2020 2070 6261 722e 636c 6f73         pbar.clos
-00001cf0: 6528 290d 0a0d 0a0d 0a0d 0a20 2020 2064  e()........    d
-00001d00: 6566 206d 6172 675f 6c69 6b28 7365 6c66  ef marg_lik(self
-00001d10: 293a 0d0a 0d0a 2020 2020 2020 2020 7620  ):....        v 
-00001d20: 3d20 6e70 2e6f 6e65 7328 7365 6c66 2e6e  = np.ones(self.n
-00001d30: 290d 0a20 2020 2020 2020 206d 203d 206e  )..        m = n
-00001d40: 702e 6f6e 6573 2873 656c 662e 6e29 0d0a  p.ones(self.n)..
-00001d50: 0d0a 2020 2020 2020 2020 7073 695f 696e  ..        psi_in
-00001d60: 7620 3d20 6e70 2e6c 696e 616c 672e 696e  v = np.linalg.in
-00001d70: 7628 7365 6c66 2e50 7369 290d 0a0d 0a20  v(self.Psi).... 
-00001d80: 2020 2020 2020 2069 6620 7365 6c66 2e41         if self.A
-00001d90: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
-00001da0: 2020 2020 2020 2043 203d 2073 656c 662e         C = self.
-00001db0: 420d 0a20 2020 2020 2020 2065 6c73 653a  B..        else:
-00001dc0: 0d0a 2020 2020 2020 2020 2020 2020 4320  ..            C 
-00001dd0: 3d20 6e70 2e68 7374 6163 6b28 2873 656c  = np.hstack((sel
-00001de0: 662e 412c 2073 656c 662e 4229 290d 0a20  f.A, self.B)).. 
-00001df0: 2020 2020 2020 200d 0a0d 0a20 2020 2020         ....     
-00001e00: 2020 2023 2045 2d73 7465 700d 0a20 2020     # E-step..   
-00001e10: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-00001e20: 6e67 6528 7365 6c66 2e6e 293a 0d0a 2020  nge(self.n):..  
-00001e30: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00001e40: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00001e50: 4120 6973 206e 6f74 204e 6f6e 653a 0d0a  A is not None:..
-00001e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001e70: 785f 6920 3d20 6e70 2e68 7374 6163 6b28  x_i = np.hstack(
-00001e80: 2873 656c 662e 465b 695d 2c20 7365 6c66  (self.F[i], self
-00001e90: 2e46 5b69 5d29 290d 0a20 2020 2020 2020  .F[i]))..       
-00001ea0: 2020 2020 2020 2020 2076 5b69 5d20 3d20           v[i] = 
-00001eb0: 2831 2b6e 702e 646f 7428 785f 692e 542c  (1+np.dot(x_i.T,
-00001ec0: 2043 2e54 292e 646f 7428 7073 695f 696e   C.T).dot(psi_in
-00001ed0: 7629 2e64 6f74 2843 292e 646f 7428 785f  v).dot(C).dot(x_
-00001ee0: 6929 2920 2a2a 2028 2d31 290d 0a20 2020  i)) ** (-1)..   
-00001ef0: 2020 2020 2020 2020 2020 2020 206d 5b69               m[i
-00001f00: 5d20 3d20 765b 695d 2a6e 702e 646f 7428  ] = v[i]*np.dot(
-00001f10: 2873 656c 662e 595b 695d 2d6e 702e 646f  (self.Y[i]-np.do
-00001f20: 7428 7365 6c66 2e41 2c20 7365 6c66 2e46  t(self.A, self.F
-00001f30: 5b69 5d29 292e 542c 7073 695f 696e 7629  [i])).T,psi_inv)
-00001f40: 2e64 6f74 2843 292e 646f 7428 785f 6929  .dot(C).dot(x_i)
-00001f50: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00001f60: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00001f70: 2020 2020 2078 5f69 203d 2073 656c 662e       x_i = self.
-00001f80: 465b 695d 0d0a 2020 2020 2020 2020 2020  F[i]..          
-00001f90: 2020 2020 2020 765b 695d 203d 2028 312b        v[i] = (1+
-00001fa0: 6e70 2e64 6f74 2878 5f69 2e54 2c20 432e  np.dot(x_i.T, C.
-00001fb0: 5429 2e64 6f74 2870 7369 5f69 6e76 292e  T).dot(psi_inv).
-00001fc0: 646f 7428 4329 2e64 6f74 2878 5f69 2929  dot(C).dot(x_i))
-00001fd0: 202a 2a20 282d 3129 0d0a 2020 2020 2020   ** (-1)..      
-00001fe0: 2020 2020 2020 2020 2020 6d5b 695d 203d            m[i] =
-00001ff0: 2076 5b69 5d2a 6e70 2e64 6f74 2828 7365   v[i]*np.dot((se
-00002000: 6c66 2e59 5b69 5d29 2e54 2c70 7369 5f69  lf.Y[i]).T,psi_i
-00002010: 6e76 292e 646f 7428 4329 2e64 6f74 2878  nv).dot(C).dot(x
-00002020: 5f69 290d 0a0d 0a20 2020 2020 2020 200d  _i)....        .
-00002030: 0a20 2020 2020 2020 2023 204d 2d73 7465  .        # M-ste
-00002040: 700d 0a0d 0a20 2020 2020 2020 2059 5f74  p....        Y_t
-00002050: 696c 6465 203d 206e 702e 7673 7461 636b  ilde = np.vstack
-00002060: 2828 7365 6c66 2e59 2c20 6e70 2e7a 6572  ((self.Y, np.zer
-00002070: 6f73 2828 7365 6c66 2e6e 2c73 656c 662e  os((self.n,self.
-00002080: 6429 2929 290d 0a20 2020 2020 2020 2069  d))))..        i
-00002090: 6620 7365 6c66 2e41 2069 7320 6e6f 7420  f self.A is not 
-000020a0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-000020b0: 2020 2058 5f74 696c 6465 203d 2020 6e70     X_tilde =  np
-000020c0: 2e76 7374 6163 6b28 286e 702e 6873 7461  .vstack((np.hsta
-000020d0: 636b 2828 7365 6c66 2e46 2c20 6d5b 3a2c  ck((self.F, m[:,
-000020e0: 6e70 2e6e 6577 6178 6973 5d2a 7365 6c66  np.newaxis]*self
-000020f0: 2e46 2929 2c6e 702e 6873 7461 636b 2828  .F)),np.hstack((
-00002100: 6e70 2e7a 6572 6f73 2828 7365 6c66 2e6e  np.zeros((self.n
-00002110: 2c20 7365 6c66 2e72 3129 292c 765b 3a2c  , self.r1)),v[:,
-00002120: 6e70 2e6e 6577 6178 6973 5d2a 7365 6c66  np.newaxis]*self
-00002130: 2e46 2929 2929 0d0a 2020 2020 2020 2020  .F))))..        
-00002140: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00002150: 2020 2058 5f74 696c 6465 203d 2020 6e70     X_tilde =  np
-00002160: 2e76 7374 6163 6b28 286d 5b3a 2c6e 702e  .vstack((m[:,np.
-00002170: 6e65 7761 7869 735d 2a73 656c 662e 462c  newaxis]*self.F,
-00002180: 765b 3a2c 6e70 2e6e 6577 6178 6973 5d2a  v[:,np.newaxis]*
-00002190: 7365 6c66 2e46 2929 0d0a 0d0a 0d0a 2020  self.F))......  
-000021a0: 2020 2020 2020 6f62 6a20 3d20 302e 352a        obj = 0.5*
-000021b0: 6e70 2e74 7261 6365 286e 702e 646f 7428  np.trace(np.dot(
-000021c0: 2859 5f74 696c 6465 2d6e 702e 646f 7428  (Y_tilde-np.dot(
-000021d0: 585f 7469 6c64 652c 2043 2e54 2929 2e54  X_tilde, C.T)).T
-000021e0: 2c20 2859 5f74 696c 6465 2d6e 702e 646f  , (Y_tilde-np.do
-000021f0: 7428 585f 7469 6c64 652c 2043 2e54 2929  t(X_tilde, C.T))
-00002200: 292e 646f 7428 7073 695f 696e 7629 2920  ).dot(psi_inv)) 
-00002210: 2b20 302e 352a 7365 6c66 2e6f 6d65 6761  + 0.5*self.omega
-00002220: 2a6e 702e 7472 6163 6528 6e70 2e64 6f74  *np.trace(np.dot
-00002230: 2873 656c 662e 4b5f 696e 762c 2073 656c  (self.K_inv, sel
-00002240: 662e 4629 2e64 6f74 2873 656c 662e 485f  f.F).dot(self.H_
-00002250: 7371 5f69 6e76 292e 646f 7428 7365 6c66  sq_inv).dot(self
-00002260: 2e46 2e54 2929 0d0a 2020 2020 2020 2020  .F.T))..        
-00002270: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00002280: 206f 626a 0d0a 0d0a 0d0a 0d0a 0d0a 0d0a   obj............
-00002290: 0d0a 0d0a 2020 2020 6465 6620 6669 745f  ....    def fit_
-000022a0: 6767 705f 625f 6f6e 6c79 2873 656c 662c  ggp_b_only(self,
-000022b0: 2070 7369 203d 204e 6f6e 652c 2046 5f73   psi = None, F_s
-000022c0: 7461 7274 203d 204e 6f6e 652c 2020 7265  tart = None,  re
-000022d0: 6720 3d20 4e6f 6e65 2c20 7479 7065 5f72  g = None, type_r
-000022e0: 6567 203d 204e 6f6e 652c 2046 5f6d 6574  eg = None, F_met
-000022f0: 686f 6420 3d20 2764 6972 6563 7427 2c20  hod = 'direct', 
-00002300: 6320 3d20 4e6f 6e65 292d 3e20 4e6f 6e65  c = None)-> None
-00002310: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
-00002320: 2020 2020 2020 2020 4772 6170 6820 4750          Graph GP
-00002330: 206f 6e6c 7920 6669 7420 636f 7661 7269   only fit covari
-00002340: 616e 6365 2074 6572 6d0d 0a20 2020 2020  ance term..     
-00002350: 2020 2022 2222 0d0a 0d0a 2020 2020 2020     """....      
-00002360: 2020 7365 6c66 2e46 5f6d 6574 686f 6420    self.F_method 
-00002370: 3d20 465f 6d65 7468 6f64 0d0a 2020 2020  = F_method..    
-00002380: 2020 2020 7365 6c66 2e72 6567 203d 2072      self.reg = r
-00002390: 6567 0d0a 2020 2020 2020 2020 7365 6c66  eg..        self
-000023a0: 2e74 7970 655f 7265 6720 3d20 7479 7065  .type_reg = type
-000023b0: 5f72 6567 0d0a 0d0a 2020 2020 2020 2020  _reg....        
-000023c0: 7365 6c66 2e72 3120 3d20 300d 0a20 2020  self.r1 = 0..   
-000023d0: 2020 2020 2073 656c 662e 7232 203d 2073       self.r2 = s
-000023e0: 656c 662e 720d 0a0d 0a20 2020 2020 2020  elf.r....       
-000023f0: 200d 0a0d 0a20 2020 2020 2020 2069 6620   ....        if 
-00002400: 465f 7374 6172 7420 6973 204e 6f6e 653a  F_start is None:
-00002410: 0d0a 2020 2020 2020 2020 2020 2020 465f  ..            F_
-00002420: 7072 6520 3d20 6e70 2e6f 6e65 7328 2873  pre = np.ones((s
-00002430: 656c 662e 6e2c 2073 656c 662e 7229 290d  elf.n, self.r)).
-00002440: 0a0d 0a20 2020 2020 2020 2059 5f74 696c  ...        Y_til
-00002450: 6465 203d 206e 702e 7673 7461 636b 2828  de = np.vstack((
-00002460: 7365 6c66 2e59 2c20 6e70 2e7a 6572 6f73  self.Y, np.zeros
-00002470: 2828 7365 6c66 2e6e 2c73 656c 662e 6429  ((self.n,self.d)
-00002480: 2929 290d 0a0d 0a0d 0a20 2020 2020 2020  )))......       
-00002490: 2069 6620 7073 6920 6973 204e 6f6e 653a   if psi is None:
-000024a0: 0d0a 2020 2020 2020 2020 2020 2020 5073  ..            Ps
-000024b0: 695f 7072 6520 3d20 6e70 2e69 6465 6e74  i_pre = np.ident
-000024c0: 6974 7928 7365 6c66 2e64 290d 0a20 2020  ity(self.d)..   
-000024d0: 2020 2020 2020 2020 2050 7369 5f70 7265           Psi_pre
-000024e0: 5f69 6e76 203d 206e 702e 6c69 6e61 6c67  _inv = np.linalg
-000024f0: 2e69 6e76 2850 7369 5f70 7265 290d 0a20  .inv(Psi_pre).. 
-00002500: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00002510: 2020 2020 2020 2020 2020 5073 695f 7072            Psi_pr
-00002520: 6520 3d20 7073 690d 0a20 2020 2020 2020  e = psi..       
-00002530: 2020 2020 2050 7369 5f70 7265 5f69 6e76       Psi_pre_inv
-00002540: 203d 206e 702e 6c69 6e61 6c67 2e69 6e76   = np.linalg.inv
-00002550: 2850 7369 5f70 7265 290d 0a0d 0a20 2020  (Psi_pre)....   
-00002560: 2020 2020 2076 203d 206e 702e 6f6e 6573       v = np.ones
-00002570: 2873 656c 662e 6e29 0d0a 2020 2020 2020  (self.n)..      
-00002580: 2020 6d20 3d20 6e70 2e6f 6e65 7328 7365    m = np.ones(se
-00002590: 6c66 2e6e 290d 0a20 2020 2020 2020 2023  lf.n)..        #
-000025a0: 2054 6865 2073 6f6c 7574 696f 6e20 6973   The solution is
-000025b0: 2065 7672 7920 7365 6e73 6974 6976 6520   evry sensitive 
-000025c0: 746f 2074 6865 2069 6e69 7461 6c20 6d61  to the inital ma
-000025d0: 7472 6978 2c20 7468 6520 6c32 2072 6567  trix, the l2 reg
-000025e0: 756c 6172 697a 6174 696f 6e20 666f 7220  ularization for 
-000025f0: 425f 7072 6520 6566 6665 6374 7320 616c  B_pre effects al
-00002600: 7068 610d 0a20 2020 2020 2020 200d 0a20  pha..        .. 
-00002610: 2020 2020 2020 2069 6620 6320 6973 204e         if c is N
-00002620: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-00002630: 2020 435f 7072 6520 3d20 6e70 2e6f 6e65    C_pre = np.one
-00002640: 7328 2873 656c 662e 642c 2073 656c 662e  s((self.d, self.
-00002650: 7229 2923 206e 702e 646f 7428 595f 7469  r))# np.dot(Y_ti
-00002660: 6c64 652e 542c 2058 5f74 696c 6465 292e  lde.T, X_tilde).
-00002670: 646f 7428 6e70 2e6c 696e 616c 672e 696e  dot(np.linalg.in
-00002680: 7628 6e70 2e64 6f74 2858 5f74 696c 6465  v(np.dot(X_tilde
-00002690: 2e54 2c20 585f 7469 6c64 6529 202b 2061  .T, X_tilde) + a
-000026a0: 6c70 6861 2a6e 702e 6964 656e 7469 7479  lpha*np.identity
-000026b0: 2872 2929 290d 0a20 2020 2020 2020 2065  (r)))..        e
-000026c0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-000026d0: 2020 435f 7072 6520 3d20 630d 0a20 2020    C_pre = c..   
-000026e0: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-000026f0: 656c 662e 6974 6572 6174 696f 6e20 3d20  elf.iteration = 
-00002700: 300d 0a20 2020 2020 2020 2073 656c 662e  0..        self.
-00002710: 746f 6c5f 7665 6320 3d20 6e70 2e7a 6572  tol_vec = np.zer
-00002720: 6f73 2873 656c 662e 6d61 785f 6974 6572  os(self.max_iter
-00002730: 290d 0a20 2020 2020 2020 2077 6869 6c65  )..        while
-00002740: 2073 656c 662e 6974 6572 6174 696f 6e20   self.iteration 
-00002750: 3c73 656c 662e 6d61 785f 6974 6572 3a0d  <self.max_iter:.
-00002760: 0a20 2020 2020 2020 2020 2020 2043 2c20  .            C, 
-00002770: 5073 695f 6573 742c 2046 2c20 746f 6c5f  Psi_est, F, tol_
-00002780: 6920 3d20 7365 6c66 2e6f 6e65 5f69 7465  i = self.one_ite
-00002790: 7261 7469 6f6e 286e 702e 6c69 6e61 6c67  ration(np.linalg
-000027a0: 2e69 6e76 2850 7369 5f70 7265 292c 2070  .inv(Psi_pre), p
-000027b0: 7369 2c20 435f 7072 652c 2063 2c20 595f  si, C_pre, c, Y_
-000027c0: 7469 6c64 652c 2046 5f70 7265 203d 2046  tilde, F_pre = F
-000027d0: 5f70 7265 2c20 7769 7468 5f6d 6561 6e20  _pre, with_mean 
-000027e0: 3d20 4661 6c73 6529 0d0a 2020 2020 2020  = False)..      
-000027f0: 2020 2020 2020 7365 6c66 2e74 6f6c 5f76        self.tol_v
-00002800: 6563 5b73 656c 662e 6974 6572 6174 696f  ec[self.iteratio
-00002810: 6e5d 203d 2074 6f6c 5f69 0d0a 2020 2020  n] = tol_i..    
-00002820: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00002830: 2020 2020 2020 6966 2028 746f 6c5f 693c        if (tol_i<
-00002840: 7365 6c66 2e74 6f6c 2920 2620 286e 6f74  self.tol) & (not
-00002850: 2073 656c 662e 646f 5f61 6c6c 5f69 7465   self.do_all_ite
-00002860: 7229 3a0d 0a20 2020 2020 2020 2020 2020  r):..           
-00002870: 2020 2020 2062 7265 616b 0d0a 2020 2020       break..    
-00002880: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00002890: 2020 2020 2020 7365 6c66 2e69 7465 7261        self.itera
-000028a0: 7469 6f6e 2b3d 310d 0a0d 0a20 2020 2020  tion+=1....     
-000028b0: 2020 2020 2020 2069 6620 7073 6920 6973         if psi is
-000028c0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-000028d0: 2020 2020 2020 2020 5073 695f 7072 6520          Psi_pre 
-000028e0: 3d20 5073 695f 6573 742e 636f 7079 2829  = Psi_est.copy()
-000028f0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00002900: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00002910: 2020 2020 2050 7369 5f70 7265 203d 2070       Psi_pre = p
-00002920: 7369 0d0a 0d0a 2020 2020 2020 2020 2020  si....          
-00002930: 2020 435f 7072 6520 3d20 432e 636f 7079    C_pre = C.copy
-00002940: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00002950: 465f 7072 6520 3d20 462e 636f 7079 2829  F_pre = F.copy()
-00002960: 0d0a 0d0a 0d0a 0d0a 2020 2020 2020 2020  ........        
-00002970: 7365 6c66 2e41 203d 204e 6f6e 650d 0a20  self.A = None.. 
-00002980: 2020 2020 2020 2073 656c 662e 4220 3d20         self.B = 
-00002990: 435b 3a2c 7365 6c66 2e72 3a5d 0d0a 2020  C[:,self.r:]..  
-000029a0: 2020 2020 2020 7365 6c66 2e46 203d 2046        self.F = F
-000029b0: 0d0a 2020 2020 2020 2020 7365 6c66 2e50  ..        self.P
-000029c0: 7369 203d 2050 7369 5f65 7374 0d0a 0d0a  si = Psi_est....
-000029d0: 0d0a 0d0a 2020 2020 6465 6620 6669 745f  ....    def fit_
-000029e0: 6767 705f 615f 6f6e 6c79 2873 656c 662c  ggp_a_only(self,
-000029f0: 2070 7369 203d 204e 6f6e 652c 2046 5f73   psi = None, F_s
-00002a00: 7461 7274 203d 204e 6f6e 652c 2072 6567  tart = None, reg
-00002a10: 203d 204e 6f6e 652c 2074 7970 655f 7265   = None, type_re
-00002a20: 6720 3d20 4e6f 6e65 2c20 465f 6d65 7468  g = None, F_meth
-00002a30: 6f64 203d 2027 6469 7265 6374 272c 2063  od = 'direct', c
-00002a40: 203d 204e 6f6e 6529 202d 3e20 4e6f 6e65   = None) -> None
-00002a50: 3a0d 0a0d 0a0d 0a20 2020 2020 2020 2073  :......        s
-00002a60: 656c 662e 7265 6720 3d20 7265 670d 0a20  elf.reg = reg.. 
-00002a70: 2020 2020 2020 2073 656c 662e 7479 7065         self.type
-00002a80: 5f72 6567 203d 2074 7970 655f 7265 670d  _reg = type_reg.
-00002a90: 0a20 2020 2020 2020 2073 656c 662e 465f  .        self.F_
-00002aa0: 6d65 7468 6f64 203d 2046 5f6d 6574 686f  method = F_metho
-00002ab0: 640d 0a0d 0a20 2020 2020 2020 2073 656c  d....        sel
-00002ac0: 662e 7231 203d 2073 656c 662e 720d 0a20  f.r1 = self.r.. 
-00002ad0: 2020 2020 2020 2073 656c 662e 7232 203d         self.r2 =
-00002ae0: 2030 0d0a 0d0a 0d0a 2020 2020 2020 2020   0......        
-00002af0: 6966 2070 7369 2069 7320 4e6f 6e65 3a0d  if psi is None:.
-00002b00: 0a20 2020 2020 2020 2020 2020 2050 7369  .            Psi
-00002b10: 5f70 7265 203d 206e 702e 6964 656e 7469  _pre = np.identi
-00002b20: 7479 2873 656c 662e 6429 0d0a 2020 2020  ty(self.d)..    
-00002b30: 2020 2020 2020 2020 5073 695f 7072 655f          Psi_pre_
-00002b40: 696e 7620 3d20 6e70 2e6c 696e 616c 672e  inv = np.linalg.
-00002b50: 696e 7628 5073 695f 7072 6529 0d0a 2020  inv(Psi_pre)..  
-00002b60: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00002b70: 2020 2020 2020 2020 2050 7369 5f70 7265           Psi_pre
-00002b80: 203d 2070 7369 0d0a 2020 2020 2020 2020   = psi..        
-00002b90: 2020 2020 5073 695f 7072 655f 696e 7620      Psi_pre_inv 
-00002ba0: 3d20 6e70 2e6c 696e 616c 672e 696e 7628  = np.linalg.inv(
-00002bb0: 5073 695f 7072 6529 0d0a 0d0a 0d0a 0d0a  Psi_pre)........
-00002bc0: 2020 2020 2020 2020 6966 2063 2069 7320          if c is 
-00002bd0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-00002be0: 2020 2043 5f70 7265 203d 206e 702e 6f6e     C_pre = np.on
-00002bf0: 6573 2828 7365 6c66 2e64 2c20 7365 6c66  es((self.d, self
-00002c00: 2e72 2929 2320 6e70 2e64 6f74 2859 5f74  .r))# np.dot(Y_t
-00002c10: 696c 6465 2e54 2c20 585f 7469 6c64 6529  ilde.T, X_tilde)
-00002c20: 2e64 6f74 286e 702e 6c69 6e61 6c67 2e69  .dot(np.linalg.i
-00002c30: 6e76 286e 702e 646f 7428 585f 7469 6c64  nv(np.dot(X_tild
-00002c40: 652e 542c 2058 5f74 696c 6465 2920 2b20  e.T, X_tilde) + 
-00002c50: 616c 7068 612a 6e70 2e69 6465 6e74 6974  alpha*np.identit
-00002c60: 7928 7229 2929 0d0a 2020 2020 2020 2020  y(r)))..        
-00002c70: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00002c80: 2020 2043 5f70 7265 203d 2063 0d0a 0d0a     C_pre = c....
-00002c90: 0d0a 2020 2020 2020 2020 7365 6c66 2e69  ..        self.i
-00002ca0: 7465 7261 7469 6f6e 203d 2030 0d0a 2020  teration = 0..  
-00002cb0: 2020 2020 2020 7365 6c66 2e74 6f6c 5f76        self.tol_v
-00002cc0: 6563 203d 206e 702e 7a65 726f 7328 7365  ec = np.zeros(se
-00002cd0: 6c66 2e6d 6178 5f69 7465 7229 0d0a 2020  lf.max_iter)..  
-00002ce0: 2020 2020 2020 7768 696c 6520 7365 6c66        while self
-00002cf0: 2e69 7465 7261 7469 6f6e 203c 7365 6c66  .iteration <self
-00002d00: 2e6d 6178 5f69 7465 723a 0d0a 2020 2020  .max_iter:..    
-00002d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002d20: 2320 4d2d 7374 6570 0d0a 2020 2020 2020  # M-step..      
-00002d30: 2020 2020 2020 5073 695f 7072 655f 696e        Psi_pre_in
-00002d40: 7620 3d20 6e70 2e6c 696e 616c 672e 696e  v = np.linalg.in
-00002d50: 7628 5073 695f 7072 6529 0d0a 2020 2020  v(Psi_pre)..    
-00002d60: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00002d70: 465f 6d65 7468 6f64 203d 3d20 2764 6972  F_method == 'dir
-00002d80: 6563 7427 3a0d 0a20 2020 2020 2020 2020  ect':..         
-00002d90: 2020 2020 2020 2046 203d 2073 656c 662e         F = self.
-00002da0: 465f 6c73 5f72 6567 2820 435f 7072 652c  F_ls_reg( C_pre,
-00002db0: 2050 7369 5f70 7265 5f69 6e76 290d 0a20   Psi_pre_inv).. 
-00002dc0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00002dd0: 7365 6c66 2e46 5f6d 6574 686f 6420 3d3d  self.F_method ==
-00002de0: 2027 7365 6361 6e74 273a 0d0a 2020 2020   'secant':..    
-00002df0: 2020 2020 2020 2020 2020 2020 4620 3d20              F = 
-00002e00: 7365 6c66 2e46 5f73 6563 616e 745f 6f70  self.F_secant_op
-00002e10: 7469 6d28 6e70 2e7a 6572 6f73 2828 7365  tim(np.zeros((se
-00002e20: 6c66 2e64 2c20 7365 6c66 2e72 2929 2c20  lf.d, self.r)), 
-00002e30: 435f 7072 652c 206e 702e 6f6e 6573 2873  C_pre, np.ones(s
-00002e40: 656c 662e 6e29 2c6e 702e 6f6e 6573 2873  elf.n),np.ones(s
-00002e50: 656c 662e 6e29 2c20 5073 695f 7072 655f  elf.n), Psi_pre_
-00002e60: 696e 7629 0d0a 0d0a 2020 2020 2020 2020  inv)....        
-00002e70: 2020 2020 6966 2063 2069 7320 4e6f 6e65      if c is None
-00002e80: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00002e90: 2020 2043 5f74 6d70 203d 2043 5f70 7265     C_tmp = C_pre
-00002ea0: 2e66 6c61 7474 656e 2829 0d0a 2020 2020  .flatten()..    
-00002eb0: 2020 2020 2020 2020 2020 2020 435f 7665              C_ve
-00002ec0: 6320 3d20 6e70 2e7a 6572 6f73 2832 2a28  c = np.zeros(2*(
-00002ed0: 7365 6c66 2e72 312b 7365 6c66 2e72 3229  self.r1+self.r2)
-00002ee0: 2a73 656c 662e 6429 0d0a 2020 2020 2020  *self.d)..      
-00002ef0: 2020 2020 2020 2020 2020 435f 7665 635b            C_vec[
-00002f00: 3a28 7365 6c66 2e72 312b 7365 6c66 2e72  :(self.r1+self.r
-00002f10: 3229 2a73 656c 662e 645d 203d 206e 702e  2)*self.d] = np.
-00002f20: 6162 7328 435f 746d 7029 202a 2028 435f  abs(C_tmp) * (C_
-00002f30: 746d 703e 3029 0d0a 2020 2020 2020 2020  tmp>0)..        
-00002f40: 2020 2020 2020 2020 435f 7665 635b 2873          C_vec[(s
-00002f50: 656c 662e 7231 2b73 656c 662e 7232 292a  elf.r1+self.r2)*
-00002f60: 7365 6c66 2e64 3a5d 203d 206e 702e 6162  self.d:] = np.ab
-00002f70: 7328 435f 746d 7029 202a 2028 435f 746d  s(C_tmp) * (C_tm
-00002f80: 703c 3029 0d0a 0d0a 2020 2020 2020 2020  p<0)....        
-00002f90: 2020 2020 2020 2020 6f75 7420 3d20 6d69          out = mi
-00002fa0: 6e69 6d69 7a65 2873 656c 662e 6c61 7373  nimize(self.lass
-00002fb0: 6f5f 6f62 6a65 6374 6976 652c 2043 5f76  o_objective, C_v
-00002fc0: 6563 2c20 6172 6773 203d 2028 462c 2073  ec, args = (F, s
-00002fd0: 656c 662e 592c 2050 7369 5f70 7265 5f69  elf.Y, Psi_pre_i
-00002fe0: 6e76 2c73 656c 662e 642c 7365 6c66 2e72  nv,self.d,self.r
-00002ff0: 312b 7365 6c66 2e72 322c 2073 656c 662e  1+self.r2, self.
-00003000: 616c 7068 6129 2c20 6d65 7468 6f64 3d27  alpha), method='
-00003010: 4c2d 4246 4753 2d42 272c 206a 6163 3d54  L-BFGS-B', jac=T
-00003020: 7275 652c 2062 6f75 6e64 7320 3d20 5b28  rue, bounds = [(
-00003030: 302e 302c 4e6f 6e65 295d 2a28 322a 2873  0.0,None)]*(2*(s
-00003040: 656c 662e 7231 2b73 656c 662e 7232 292a  elf.r1+self.r2)*
-00003050: 7365 6c66 2e64 2929 0d0a 2020 2020 2020  self.d))..      
-00003060: 2020 2020 2020 2020 2020 435f 7665 6320            C_vec 
-00003070: 3d20 6f75 742e 780d 0a20 2020 2020 2020  = out.x..       
-00003080: 2020 2020 2020 2020 2043 203d 206e 702e           C = np.
-00003090: 7265 7368 6170 6528 6f75 742e 785b 3a28  reshape(out.x[:(
-000030a0: 7365 6c66 2e72 312b 7365 6c66 2e72 3229  self.r1+self.r2)
-000030b0: 2a73 656c 662e 645d 202d 206f 7574 2e78  *self.d] - out.x
-000030c0: 5b28 7365 6c66 2e72 312b 7365 6c66 2e72  [(self.r1+self.r
-000030d0: 3229 2a73 656c 662e 643a 5d2c 2028 7365  2)*self.d:], (se
-000030e0: 6c66 2e64 2c73 656c 662e 7231 2b73 656c  lf.d,self.r1+sel
-000030f0: 662e 7232 2929 0d0a 0d0a 2020 2020 2020  f.r2))....      
-00003100: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00003110: 2020 2020 2020 2020 2020 2020 2043 203d               C =
-00003120: 2063 0d0a 0d0a 0d0a 2020 2020 2020 2020   c......        
-00003130: 2020 2020 746f 6c5f 6920 3d20 286e 702e      tol_i = (np.
-00003140: 6c69 6e61 6c67 2e6e 6f72 6d28 432d 435f  linalg.norm(C-C_
-00003150: 7072 6529 292f 286e 702e 6c69 6e61 6c67  pre))/(np.linalg
-00003160: 2e6e 6f72 6d28 435f 7072 6529 290d 0a20  .norm(C_pre)).. 
-00003170: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00003180: 746f 6c5f 7665 635b 7365 6c66 2e69 7465  tol_vec[self.ite
-00003190: 7261 7469 6f6e 5d20 3d20 746f 6c5f 690d  ration] = tol_i.
-000031a0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-000031b0: 2020 2020 2020 2069 6620 2874 6f6c 5f69         if (tol_i
-000031c0: 3c73 656c 662e 746f 6c29 2026 2028 6e6f  <self.tol) & (no
-000031d0: 7420 7365 6c66 2e64 6f5f 616c 6c5f 6974  t self.do_all_it
-000031e0: 6572 293a 0d0a 2020 2020 2020 2020 2020  er):..          
-000031f0: 2020 2020 2020 6272 6561 6b0d 0a20 2020        break..   
-00003200: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00003210: 2020 2020 2020 2073 656c 662e 6974 6572         self.iter
-00003220: 6174 696f 6e2b 3d31 0d0a 2020 2020 2020  ation+=1..      
-00003230: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00003240: 2020 2020 6966 2070 7369 2069 7320 4e6f      if psi is No
-00003250: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-00003260: 2020 2020 2050 7369 5f65 7374 203d 206e       Psi_est = n
-00003270: 702e 636f 7628 2873 656c 662e 592d 6e70  p.cov((self.Y-np
-00003280: 2e64 6f74 2846 2c43 2e54 2929 2e54 292a  .dot(F,C.T)).T)*
-00003290: 2873 656c 662e 6e2d 3129 2f73 656c 662e  (self.n-1)/self.
-000032a0: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
-000032b0: 2020 2050 7369 5f70 7265 203d 2050 7369     Psi_pre = Psi
-000032c0: 5f65 7374 2e63 6f70 7928 290d 0a20 2020  _est.copy()..   
-000032d0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-000032e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000032f0: 5073 695f 6573 7420 3d20 7073 690d 0a0d  Psi_est = psi...
-00003300: 0a0d 0a20 2020 2020 2020 2020 2020 2043  ...            C
-00003310: 5f70 7265 203d 2043 2e63 6f70 7928 290d  _pre = C.copy().
-00003320: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00003330: 662e 6974 6572 6174 696f 6e2b 3d31 0d0a  f.iteration+=1..
-00003340: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-00003350: 2e41 203d 2043 0d0a 2020 2020 2020 2020  .A = C..        
-00003360: 7365 6c66 2e42 203d 204e 6f6e 650d 0a20  self.B = None.. 
-00003370: 2020 2020 2020 2073 656c 662e 4620 3d20         self.F = 
-00003380: 460d 0a20 2020 2020 2020 2073 656c 662e  F..        self.
-00003390: 5073 6920 3d20 5073 695f 6573 740d 0a0d  Psi = Psi_est...
-000033a0: 0a0d 0a0d 0a0d 0a0d 0a0d 0a              ...........
+00000020: 0d0a 696d 706f 7274 2074 7164 6d0d 0a66  ..import tqdm..f
+00000030: 726f 6d20 7363 6970 792e 6f70 7469 6d69  rom scipy.optimi
+00000040: 7a65 2069 6d70 6f72 7420 6d69 6e69 6d69  ze import minimi
+00000050: 7a65 0d0a 6672 6f6d 2064 6563 696d 616c  ze..from decimal
+00000060: 2069 6d70 6f72 7420 4465 6369 6d61 6c0d   import Decimal.
+00000070: 0a0d 0a0d 0a66 726f 6d20 436f 7652 6567  .....from CovReg
+00000080: 2e63 6f76 7265 6720 696d 706f 7274 2043  .covreg import C
+00000090: 6f76 5265 670d 0a0d 0a0d 0a0d 0a63 6c61  ovReg........cla
+000000a0: 7373 2047 7261 7068 436f 7652 6567 2843  ss GraphCovReg(C
+000000b0: 6f76 5265 6729 3a0d 0a0d 0a20 2020 200d  ovReg):....    .
+000000c0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+000000d0: 5f28 7365 6c66 2c20 592c 2061 6c70 6861  _(self, Y, alpha
+000000e0: 2c20 4b2c 204c 2c20 6f6d 6567 612c 2062  , K, L, omega, b
+000000f0: 6574 612c 2072 2c20 6d61 785f 6974 6572  eta, r, max_iter
+00000100: 203d 2031 3030 2c20 746f 6c20 3d20 3165   = 100, tol = 1e
+00000110: 2d33 2920 2d3e 204e 6f6e 653a 0d0a 0d0a  -3) -> None:....
+00000120: 2020 2020 2020 2020 436f 7652 6567 2e5f          CovReg._
+00000130: 5f69 6e69 745f 5f28 7365 6c66 2c20 592c  _init__(self, Y,
+00000140: 2061 6c70 6861 2c20 6d61 785f 6974 6572   alpha, max_iter
+00000150: 2c20 746f 6c29 200d 0a0d 0a20 2020 2020  , tol) ....     
+00000160: 2020 2073 656c 662e 7769 7468 5f67 7261     self.with_gra
+00000170: 7068 203d 2054 7275 650d 0a20 2020 2020  ph = True..     
+00000180: 2020 2073 656c 662e 4b20 3d20 4b0d 0a20     self.K = K.. 
+00000190: 2020 2020 2020 2073 656c 662e 4b5f 696e         self.K_in
+000001a0: 7620 3d20 6e70 2e6c 696e 616c 672e 696e  v = np.linalg.in
+000001b0: 7628 4b29 0d0a 2020 2020 2020 2020 7365  v(K)..        se
+000001c0: 6c66 2e4c 203d 204c 0d0a 2020 2020 2020  lf.L = L..      
+000001d0: 2020 7365 6c66 2e6f 6d65 6761 203d 206f    self.omega = o
+000001e0: 6d65 6761 0d0a 2020 2020 2020 2020 7365  mega..        se
+000001f0: 6c66 2e62 6574 6120 3d20 6265 7461 0d0a  lf.beta = beta..
+00000200: 2020 2020 2020 2020 7365 6c66 2e72 203d          self.r =
+00000210: 2072 0d0a 0d0a 0d0a 2020 2020 2020 2020   r......        
+00000220: 762c 2075 203d 206e 702e 6c69 6e61 6c67  v, u = np.linalg
+00000230: 2e65 6967 6828 4c29 0d0a 0d0a 2020 2020  .eigh(L)....    
+00000240: 2020 2020 7365 6c66 2e48 203d 206e 702e      self.H = np.
+00000250: 6172 7261 7928 6e70 2e64 6f74 2875 2c20  array(np.dot(u, 
+00000260: 6e70 2e64 6961 6728 6e70 2e65 7870 282d  np.diag(np.exp(-
+00000270: 6265 7461 2a76 2929 292e 646f 7428 752e  beta*v))).dot(u.
+00000280: 5429 290d 0a20 2020 2020 2020 2073 656c  T))..        sel
+00000290: 662e 485f 7371 5f69 6e76 203d 206e 702e  f.H_sq_inv = np.
+000002a0: 6c69 6e61 6c67 2e69 6e76 286e 702e 646f  linalg.inv(np.do
+000002b0: 7428 7365 6c66 2e48 2c73 656c 662e 4829  t(self.H,self.H)
+000002c0: 202b 2030 2e30 3031 2a6e 702e 6964 656e   + 0.001*np.iden
+000002d0: 7469 7479 2873 656c 662e 7229 290d 0a20  tity(self.r)).. 
+000002e0: 200d 0a0d 0a20 2020 2040 7374 6174 6963   ....    @static
+000002f0: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
+00000300: 7365 6361 6e74 5f6f 626a 6563 7469 7665  secant_objective
+00000310: 2870 6172 616d 2c20 722c 206d 2c20 762c  (param, r, m, v,
+00000320: 2059 2c20 7073 695f 696e 762c 2042 2c41   Y, psi_inv, B,A
+00000330: 2c20 4b5f 696e 762c 206f 6d65 6761 2c20  , K_inv, omega, 
+00000340: 485f 7371 5f69 6e76 293a 0d0a 0d0a 2020  H_sq_inv):....  
+00000350: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00000360: 6e20 3d20 592e 7368 6170 655b 305d 0d0a  n = Y.shape[0]..
+00000370: 2020 2020 2020 2020 6420 3d20 592e 7368          d = Y.sh
+00000380: 6170 655b 315d 0d0a 0d0a 2020 2020 2020  ape[1]....      
+00000390: 2020 4d20 3d20 6e70 2e64 6961 6728 6d29    M = np.diag(m)
+000003a0: 0d0a 2020 2020 2020 2020 5320 3d20 6e70  ..        S = np
+000003b0: 2e64 6961 6728 7629 0d0a 0d0a 0d0a 2020  .diag(v)......  
+000003c0: 2020 2020 2020 595f 7469 6c64 6520 3d20        Y_tilde = 
+000003d0: 6e70 2e76 7374 6163 6b28 2859 2c20 6e70  np.vstack((Y, np
+000003e0: 2e7a 6572 6f73 2828 6e2c 6429 2929 290d  .zeros((n,d)))).
+000003f0: 0a0d 0a20 2020 2020 2020 2046 203d 206e  ...        F = n
+00000400: 702e 7265 7368 6170 6528 7061 7261 6d2c  p.reshape(param,
+00000410: 286e 2c72 292c 206f 7264 6572 3d27 4627  (n,r), order='F'
+00000420: 290d 0a20 2020 200d 0a20 2020 2020 2020  )..    ..       
+00000430: 2046 5f74 696c 6465 203d 2020 6e70 2e76   F_tilde =  np.v
+00000440: 7374 6163 6b28 286e 702e 6873 7461 636b  stack((np.hstack
+00000450: 2828 462c 206d 5b3a 2c6e 702e 6e65 7761  ((F, m[:,np.newa
+00000460: 7869 735d 2a46 2929 2c6e 702e 6873 7461  xis]*F)),np.hsta
+00000470: 636b 2828 6e70 2e7a 6572 6f73 2828 6e2c  ck((np.zeros((n,
+00000480: 2072 2929 2c76 5b3a 2c6e 702e 6e65 7761   r)),v[:,np.newa
+00000490: 7869 735d 2a46 2929 2929 0d0a 2020 2020  xis]*F))))..    
+000004a0: 2020 2020 4320 3d20 6e70 2e68 7374 6163      C = np.hstac
+000004b0: 6b28 2841 2c42 2929 0d0a 0d0a 2020 2020  k((A,B))....    
+000004c0: 2020 2020 6f62 6a20 3d20 302e 352a 6e70      obj = 0.5*np
+000004d0: 2e74 7261 6365 286e 702e 646f 7428 2859  .trace(np.dot((Y
+000004e0: 5f74 696c 6465 2d6e 702e 646f 7428 465f  _tilde-np.dot(F_
+000004f0: 7469 6c64 652c 2043 2e54 2929 2e54 2c20  tilde, C.T)).T, 
+00000500: 2859 5f74 696c 6465 2d6e 702e 646f 7428  (Y_tilde-np.dot(
+00000510: 465f 7469 6c64 652c 2043 2e54 2929 292e  F_tilde, C.T))).
+00000520: 646f 7428 7073 695f 696e 7629 2920 202b  dot(psi_inv))  +
+00000530: 2030 2e35 2a6f 6d65 6761 2a6e 702e 7472   0.5*omega*np.tr
+00000540: 6163 6528 6e70 2e64 6f74 284b 5f69 6e76  ace(np.dot(K_inv
+00000550: 2c20 4629 2e64 6f74 2848 5f73 715f 696e  , F).dot(H_sq_in
+00000560: 7629 2e64 6f74 2846 2e54 2929 0d0a 2020  v).dot(F.T))..  
+00000570: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00000580: 6772 6164 3120 3d20 2d6e 702e 646f 7428  grad1 = -np.dot(
+00000590: 4d2c 5929 2e64 6f74 2870 7369 5f69 6e76  M,Y).dot(psi_inv
+000005a0: 292e 646f 7428 4229 202d 6e70 2e64 6f74  ).dot(B) -np.dot
+000005b0: 2859 2c70 7369 5f69 6e76 292e 646f 7428  (Y,psi_inv).dot(
+000005c0: 4129 200d 0a20 2020 2020 2020 2067 7261  A) ..        gra
+000005d0: 6432 203d 206e 702e 646f 7428 462c 412e  d2 = np.dot(F,A.
+000005e0: 5429 2e64 6f74 2870 7369 5f69 6e76 292e  T).dot(psi_inv).
+000005f0: 646f 7428 4129 0d0a 2020 2020 2020 2020  dot(A)..        
+00000600: 6772 6164 3320 3d20 6e70 2e64 6f74 284d  grad3 = np.dot(M
+00000610: 2c20 4629 2e64 6f74 2841 2e54 292e 646f  , F).dot(A.T).do
+00000620: 7428 7073 695f 696e 7629 2e64 6f74 2842  t(psi_inv).dot(B
+00000630: 2920 2b20 6e70 2e64 6f74 284d 2c20 4629  ) + np.dot(M, F)
+00000640: 2e64 6f74 2842 2e54 292e 646f 7428 7073  .dot(B.T).dot(ps
+00000650: 695f 696e 7629 2e64 6f74 2841 290d 0a20  i_inv).dot(A).. 
+00000660: 2020 2020 2020 2067 7261 6434 203d 206e         grad4 = n
+00000670: 702e 646f 7428 4d2a 2a32 2b53 2a2a 322c  p.dot(M**2+S**2,
+00000680: 4629 2e64 6f74 2842 2e54 292e 646f 7428  F).dot(B.T).dot(
+00000690: 7073 695f 696e 7629 2e64 6f74 2842 290d  psi_inv).dot(B).
+000006a0: 0a0d 0a20 2020 2020 2020 2067 7261 6420  ...        grad 
+000006b0: 3d20 2867 7261 6431 202b 6772 6164 322b  = (grad1 +grad2+
+000006c0: 6772 6164 332b 6772 6164 342b 206f 6d65  grad3+grad4+ ome
+000006d0: 6761 2a6e 702e 646f 7428 4b5f 696e 762c  ga*np.dot(K_inv,
+000006e0: 2046 292e 646f 7428 485f 7371 5f69 6e76   F).dot(H_sq_inv
+000006f0: 2929 2e66 6c61 7474 656e 286f 7264 6572  )).flatten(order
+00000700: 3d27 4627 290d 0a0d 0a20 2020 2020 2020  ='F')....       
+00000710: 2072 6574 7572 6e20 6f62 6a2c 2067 7261   return obj, gra
+00000720: 640d 0a0d 0a20 2020 200d 0a20 2020 2064  d....    ..    d
+00000730: 6566 2046 5f73 6563 616e 745f 6f70 7469  ef F_secant_opti
+00000740: 6d28 7365 6c66 2c42 2c20 412c 206d 2c76  m(self,B, A, m,v
+00000750: 2c20 7073 695f 696e 7629 3a0d 0a0d 0a0d  , psi_inv):.....
+00000760: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00000770: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00000780: 206f 7574 203d 206d 696e 696d 697a 6528   out = minimize(
+00000790: 7365 6c66 2e73 6563 616e 745f 6f62 6a65  self.secant_obje
+000007a0: 6374 6976 652c 206e 702e 6f6e 6573 2873  ctive, np.ones(s
+000007b0: 656c 662e 6e2a 7365 6c66 2e72 292c 2061  elf.n*self.r), a
+000007c0: 7267 7320 3d20 2873 656c 662e 722c 206d  rgs = (self.r, m
+000007d0: 2c20 762c 2073 656c 662e 592c 2070 7369  , v, self.Y, psi
+000007e0: 5f69 6e76 2c20 422c 412c 2073 656c 662e  _inv, B,A, self.
+000007f0: 4b5f 696e 762c 2073 656c 662e 6f6d 6567  K_inv, self.omeg
+00000800: 612c 2073 656c 662e 485f 7371 5f69 6e76  a, self.H_sq_inv
+00000810: 292c 206a 6163 3d54 7275 652c 206d 6574  ), jac=True, met
+00000820: 686f 643d 2027 4c2d 4246 4753 2d42 2729  hod= 'L-BFGS-B')
+00000830: 0d0a 0d0a 0d0a 2020 2020 2020 2020 2020  ......          
+00000840: 2020 7265 7475 726e 206e 702e 7265 7368    return np.resh
+00000850: 6170 6528 6f75 742e 782c 2873 656c 662e  ape(out.x,(self.
+00000860: 6e2c 7365 6c66 2e72 292c 206f 7264 6572  n,self.r), order
+00000870: 3d27 4627 290d 0a0d 0a0d 0a20 2020 2064  ='F')......    d
+00000880: 6566 2046 5f6c 7328 7365 6c66 2c20 412c  ef F_ls(self, A,
+00000890: 2070 7369 5f69 6e76 293a 0d0a 0d0a 2020   psi_inv):....  
+000008a0: 2020 2020 2020 415f 7175 6164 203d 206e        A_quad = n
+000008b0: 702e 646f 7428 412e 542c 2070 7369 5f69  p.dot(A.T, psi_i
+000008c0: 6e76 292e 646f 7428 4129 0d0a 2020 2020  nv).dot(A)..    
+000008d0: 2020 2020 465f 6c73 5f6e 6f5f 6772 6170      F_ls_no_grap
+000008e0: 6820 3d20 6e70 2e64 6f74 2873 656c 662e  h = np.dot(self.
+000008f0: 592c 2070 7369 5f69 6e76 292e 646f 7428  Y, psi_inv).dot(
+00000900: 4129 2e64 6f74 286e 702e 6c69 6e61 6c67  A).dot(np.linalg
+00000910: 2e70 696e 7628 415f 7175 6164 292b 302e  .pinv(A_quad)+0.
+00000920: 3030 312a 6e70 2e69 6465 6e74 6974 7928  001*np.identity(
+00000930: 412e 7368 6170 655b 315d 2929 200d 0a0d  A.shape[1])) ...
+00000940: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
+00000950: 6e20 465f 6c73 5f6e 6f5f 6772 6170 680d  n F_ls_no_graph.
+00000960: 0a0d 0a0d 0a20 2020 200d 0a0d 0a20 2020  .....    ....   
+00000970: 2064 6566 2046 5f6c 735f 7265 6728 7365   def F_ls_reg(se
+00000980: 6c66 2c20 412c 2070 7369 5f69 6e76 293a  lf, A, psi_inv):
+00000990: 0d0a 0d0a 2020 2020 2020 2020 495f 6e20  ....        I_n 
+000009a0: 3d20 6e70 2e69 6465 6e74 6974 7928 7365  = np.identity(se
+000009b0: 6c66 2e6e 290d 0a0d 0a0d 0a20 2020 2020  lf.n)......     
+000009c0: 2020 2041 5f71 7561 6420 3d20 6e70 2e64     A_quad = np.d
+000009d0: 6f74 2841 2e54 2c20 7073 695f 696e 7629  ot(A.T, psi_inv)
+000009e0: 2e64 6f74 2841 290d 0a0d 0a20 2020 2020  .dot(A)....     
+000009f0: 2020 206d 6174 203d 206e 702e 6b72 6f6e     mat = np.kron
+00000a00: 2841 5f71 7561 642c 2049 5f6e 2920 2b20  (A_quad, I_n) + 
+00000a10: 6e70 2e6b 726f 6e28 7365 6c66 2e48 5f73  np.kron(self.H_s
+00000a20: 715f 696e 762c 7365 6c66 2e4b 5f69 6e76  q_inv,self.K_inv
+00000a30: 290d 0a20 2020 2020 2020 206c 2c20 7520  )..        l, u 
+00000a40: 3d20 6e70 2e6c 696e 616c 672e 6569 6768  = np.linalg.eigh
+00000a50: 286d 6174 290d 0a20 2020 2020 2020 2069  (mat)..        i
+00000a60: 6620 7365 6c66 2e74 7970 655f 7265 6720  f self.type_reg 
+00000a70: 3d3d 2027 5469 6b61 6e6f 7627 3a0d 0a20  == 'Tikanov':.. 
+00000a80: 2020 2020 2020 2020 2020 2069 6e76 5f6d             inv_m
+00000a90: 6174 203d 206e 702e 646f 7428 752c 206e  at = np.dot(u, n
+00000aa0: 702e 6469 6167 2831 2f28 6c2b 7365 6c66  p.diag(1/(l+self
+00000ab0: 2e72 6567 2929 292e 646f 7428 752e 5429  .reg))).dot(u.T)
+00000ac0: 0d0a 2020 2020 2020 2020 656c 6966 2073  ..        elif s
+00000ad0: 656c 662e 7479 7065 5f72 6567 203d 3d20  elf.type_reg == 
+00000ae0: 2773 7065 6374 7261 6c27 3a0d 0a20 2020  'spectral':..   
+00000af0: 2020 2020 2020 2020 206c 5f69 6e76 203d           l_inv =
+00000b00: 2031 2f6c 0d0a 2020 2020 2020 2020 2020   1/l..          
+00000b10: 2020 6c5f 696e 765b 6c3c 7365 6c66 2e72    l_inv[l<self.r
+00000b20: 6567 5d20 3d20 300d 0a20 2020 2020 2020  eg] = 0..       
+00000b30: 2020 2020 2069 6e76 5f6d 6174 203d 206e       inv_mat = n
+00000b40: 702e 646f 7428 752c 206e 702e 6469 6167  p.dot(u, np.diag
+00000b50: 286c 5f69 6e76 2929 2e64 6f74 2875 2e54  (l_inv)).dot(u.T
+00000b60: 290d 0a0d 0a20 2020 2020 2020 2046 203d  )....        F =
+00000b70: 206e 702e 646f 7428 696e 765f 6d61 742c   np.dot(inv_mat,
+00000b80: 206e 702e 646f 7428 7365 6c66 2e59 2c20   np.dot(self.Y, 
+00000b90: 7073 695f 696e 7629 2e64 6f74 2841 292e  psi_inv).dot(A).
+00000ba0: 666c 6174 7465 6e28 6f72 6465 723d 2746  flatten(order='F
+00000bb0: 2729 290d 0a20 2020 2020 2020 200d 0a20  '))..        .. 
+00000bc0: 2020 2020 2020 2072 6574 7572 6e20 6e70         return np
+00000bd0: 2e72 6573 6861 7065 2846 2c28 7365 6c66  .reshape(F,(self
+00000be0: 2e6e 2c73 656c 662e 7229 2c20 6f72 6465  .n,self.r), orde
+00000bf0: 723d 2746 2729 0d0a 0d0a 0d0a 0d0a 2020  r='F')........  
+00000c00: 2020 6465 6620 465f 636f 765f 6e6f 5f67    def F_cov_no_g
+00000c10: 7261 7068 2873 656c 662c 2020 422c 206d  raph(self,  B, m
+00000c20: 2c76 2c70 7369 5f69 6e76 293a 0d0a 0d0a  ,v,psi_inv):....
+00000c30: 2020 2020 2020 2020 4d20 3d20 6e70 2e64          M = np.d
+00000c40: 6961 6728 6d29 0d0a 2020 2020 2020 2020  iag(m)..        
+00000c50: 5320 3d20 6e70 2e64 6961 6728 7629 0d0a  S = np.diag(v)..
+00000c60: 2020 2020 2020 2020 696e 765f 656d 203d          inv_em =
+00000c70: 206e 702e 6c69 6e61 6c67 2e69 6e76 284d   np.linalg.inv(M
+00000c80: 2a2a 322b 532a 2a32 290d 0a20 2020 2020  **2+S**2)..     
+00000c90: 2020 2042 5f71 7561 6420 3d20 6e70 2e64     B_quad = np.d
+00000ca0: 6f74 2842 2e54 2c20 7073 695f 696e 7629  ot(B.T, psi_inv)
+00000cb0: 2e64 6f74 2842 290d 0a0d 0a20 2020 2020  .dot(B)....     
+00000cc0: 2020 2046 203d 206e 702e 646f 7428 696e     F = np.dot(in
+00000cd0: 765f 656d 2c20 4d29 2e64 6f74 2873 656c  v_em, M).dot(sel
+00000ce0: 662e 5929 2e64 6f74 2870 7369 5f69 6e76  f.Y).dot(psi_inv
+00000cf0: 292e 646f 7428 4229 2e64 6f74 286e 702e  ).dot(B).dot(np.
+00000d00: 6c69 6e61 6c67 2e70 696e 7628 425f 7175  linalg.pinv(B_qu
+00000d10: 6164 2929 0d0a 2020 2020 2020 2020 7265  ad))..        re
+00000d20: 7475 726e 2046 0d0a 0d0a 0d0a 2020 2020  turn F......    
+00000d30: 6465 6620 465f 6469 7265 6374 5f63 6f76  def F_direct_cov
+00000d40: 5f6f 6e6c 7928 7365 6c66 2c20 2042 2c20  _only(self,  B, 
+00000d50: 6d2c 762c 2070 7369 5f69 6e76 2029 3a0d  m,v, psi_inv ):.
+00000d60: 0a20 2020 2020 2020 204d 203d 206e 702e  .        M = np.
+00000d70: 6469 6167 286d 290d 0a20 2020 2020 2020  diag(m)..       
+00000d80: 2053 203d 206e 702e 6469 6167 2876 290d   S = np.diag(v).
+00000d90: 0a0d 0a20 2020 2020 2020 2042 5f71 7561  ...        B_qua
+00000da0: 6420 3d20 6e70 2e64 6f74 2842 2e54 2c20  d = np.dot(B.T, 
+00000db0: 7073 695f 696e 7629 2e64 6f74 2842 290d  psi_inv).dot(B).
+00000dc0: 0a0d 0a20 2020 2020 2020 2023 206d 6174  ...        # mat
+00000dd0: 203d 206e 702e 6b72 6f6e 2848 5f73 715f   = np.kron(H_sq_
+00000de0: 696e 762b 302e 312a 6e70 2e69 6465 6e74  inv+0.1*np.ident
+00000df0: 6974 7928 7229 2c20 4b5f 696e 762b 302e  ity(r), K_inv+0.
+00000e00: 312a 6e70 2e69 6465 6e74 6974 7928 6e29  1*np.identity(n)
+00000e10: 2920 2b20 6e70 2e6b 726f 6e28 415f 7175  ) + np.kron(A_qu
+00000e20: 6164 2b30 2e31 2a6e 702e 6964 656e 7469  ad+0.1*np.identi
+00000e30: 7479 2872 292c 206e 702e 6964 656e 7469  ty(r), np.identi
+00000e40: 7479 286e 2929 0d0a 2020 2020 2020 2020  ty(n))..        
+00000e50: 6d61 7420 3d20 6e70 2e6b 726f 6e28 7365  mat = np.kron(se
+00000e60: 6c66 2e48 5f73 715f 696e 762c 2073 656c  lf.H_sq_inv, sel
+00000e70: 662e 4b5f 696e 7629 202b 206e 702e 6b72  f.K_inv) + np.kr
+00000e80: 6f6e 2842 5f71 7561 642c 204d 2a2a 322b  on(B_quad, M**2+
+00000e90: 532a 2a32 290d 0a20 2020 2020 2020 206c  S**2)..        l
+00000ea0: 2c20 7520 3d20 6e70 2e6c 696e 616c 672e  , u = np.linalg.
+00000eb0: 6569 6768 286d 6174 290d 0a20 2020 2020  eigh(mat)..     
+00000ec0: 2020 2069 6620 7365 6c66 2e74 7970 655f     if self.type_
+00000ed0: 7265 6720 3d3d 2027 5469 6b61 6e6f 7627  reg == 'Tikanov'
+00000ee0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00000ef0: 6e76 5f6d 6174 203d 206e 702e 646f 7428  nv_mat = np.dot(
+00000f00: 752c 206e 702e 6469 6167 2831 2f28 6c2b  u, np.diag(1/(l+
+00000f10: 7365 6c66 2e72 6567 2929 292e 646f 7428  self.reg))).dot(
+00000f20: 752e 5429 0d0a 2020 2020 2020 2020 656c  u.T)..        el
+00000f30: 6966 2073 656c 662e 7479 7065 5f72 6567  if self.type_reg
+00000f40: 203d 3d20 2773 7065 6374 7261 6c27 3a0d   == 'spectral':.
+00000f50: 0a20 2020 2020 2020 2020 2020 206c 5f69  .            l_i
+00000f60: 6e76 203d 2031 2f6c 0d0a 2020 2020 2020  nv = 1/l..      
+00000f70: 2020 2020 2020 6c5f 696e 765b 6c3c 7365        l_inv[l<se
+00000f80: 6c66 2e72 6567 5d20 3d20 300d 0a20 2020  lf.reg] = 0..   
+00000f90: 2020 2020 2020 2020 2069 6e76 5f6d 6174           inv_mat
+00000fa0: 203d 206e 702e 646f 7428 752c 206e 702e   = np.dot(u, np.
+00000fb0: 6469 6167 286c 5f69 6e76 2929 2e64 6f74  diag(l_inv)).dot
+00000fc0: 2875 2e54 290d 0a20 2020 2020 2020 2046  (u.T)..        F
+00000fd0: 5f6c 7320 3d20 6e70 2e64 6f74 2820 696e  _ls = np.dot( in
+00000fe0: 765f 6d61 742c 206e 702e 646f 7428 4d2c  v_mat, np.dot(M,
+00000ff0: 2073 656c 662e 5929 2e64 6f74 2870 7369   self.Y).dot(psi
+00001000: 5f69 6e76 292e 646f 7428 4229 2e66 6c61  _inv).dot(B).fla
+00001010: 7474 656e 286f 7264 6572 3d27 4627 2929  tten(order='F'))
+00001020: 0d0a 2020 2020 2020 2020 465f 6c73 203d  ..        F_ls =
+00001030: 206e 702e 7265 7368 6170 6528 465f 6c73   np.reshape(F_ls
+00001040: 2c28 7365 6c66 2e6e 2c73 656c 662e 7229  ,(self.n,self.r)
+00001050: 2c20 6f72 6465 723d 2746 2729 0d0a 0d0a  , order='F')....
+00001060: 2020 2020 2020 2020 7265 7475 726e 2046          return F
+00001070: 5f6c 730d 0a0d 0a0d 0a20 2020 2064 6566  _ls......    def
+00001080: 2046 5f64 6972 6563 7428 7365 6c66 2c42   F_direct(self,B
+00001090: 2c20 412c 206d 2c76 2c20 7073 695f 696e  , A, m,v, psi_in
+000010a0: 7629 3a0d 0a0d 0a20 2020 2020 2020 2049  v):....        I
+000010b0: 5f6e 203d 206e 702e 6964 656e 7469 7479  _n = np.identity
+000010c0: 2873 656c 662e 6e29 0d0a 2020 2020 2020  (self.n)..      
+000010d0: 2020 4d20 3d20 6e70 2e64 6961 6728 6d29    M = np.diag(m)
+000010e0: 0d0a 2020 2020 2020 2020 5320 3d20 6e70  ..        S = np
+000010f0: 2e64 6961 6728 7629 0d0a 0d0a 0d0a 2020  .diag(v)......  
+00001100: 2020 2020 2020 425f 7175 6164 203d 206e        B_quad = n
+00001110: 702e 646f 7428 422e 542c 2070 7369 5f69  p.dot(B.T, psi_i
+00001120: 6e76 292e 646f 7428 4229 0d0a 2020 2020  nv).dot(B)..    
+00001130: 2020 2020 415f 7175 6164 203d 206e 702e      A_quad = np.
+00001140: 646f 7428 412e 542c 2070 7369 5f69 6e76  dot(A.T, psi_inv
+00001150: 292e 646f 7428 4129 0d0a 2020 2020 2020  ).dot(A)..      
+00001160: 2020 4142 5f71 7561 6420 3d20 6e70 2e64    AB_quad = np.d
+00001170: 6f74 2841 2e54 2c20 7073 695f 696e 7629  ot(A.T, psi_inv)
+00001180: 2e64 6f74 2842 290d 0a0d 0a20 2020 2020  .dot(B)....     
+00001190: 2020 206d 6174 203d 206e 702e 6b72 6f6e     mat = np.kron
+000011a0: 2841 5f71 7561 642c 2049 5f6e 2920 2b20  (A_quad, I_n) + 
+000011b0: 6e70 2e6b 726f 6e28 4142 5f71 7561 642b  np.kron(AB_quad+
+000011c0: 4142 5f71 7561 642e 542c 204d 2920 2b20  AB_quad.T, M) + 
+000011d0: 6e70 2e6b 726f 6e28 425f 7175 6164 2c20  np.kron(B_quad, 
+000011e0: 4d2a 2a32 2b53 2a2a 3229 202b 206e 702e  M**2+S**2) + np.
+000011f0: 6b72 6f6e 2873 656c 662e 485f 7371 5f69  kron(self.H_sq_i
+00001200: 6e76 2c73 656c 662e 4b5f 696e 7629 0d0a  nv,self.K_inv)..
+00001210: 2020 2020 2020 2020 6c2c 2075 203d 206e          l, u = n
+00001220: 702e 6c69 6e61 6c67 2e65 6967 6828 6d61  p.linalg.eigh(ma
+00001230: 7429 0d0a 2020 2020 2020 2020 6966 2073  t)..        if s
+00001240: 656c 662e 7479 7065 5f72 6567 203d 3d20  elf.type_reg == 
+00001250: 2754 696b 616e 6f76 273a 0d0a 2020 2020  'Tikanov':..    
+00001260: 2020 2020 2020 2020 696e 765f 6d61 7420          inv_mat 
+00001270: 3d20 6e70 2e64 6f74 2875 2c20 6e70 2e64  = np.dot(u, np.d
+00001280: 6961 6728 312f 286c 2b73 656c 662e 7265  iag(1/(l+self.re
+00001290: 6729 2929 2e64 6f74 2875 2e54 290d 0a20  g))).dot(u.T).. 
+000012a0: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+000012b0: 2e74 7970 655f 7265 6720 3d3d 2027 7370  .type_reg == 'sp
+000012c0: 6563 7472 616c 273a 0d0a 2020 2020 2020  ectral':..      
+000012d0: 2020 2020 2020 6c5f 696e 7620 3d20 312f        l_inv = 1/
+000012e0: 6c0d 0a20 2020 2020 2020 2020 2020 206c  l..            l
+000012f0: 5f69 6e76 5b6c 3c73 656c 662e 7265 675d  _inv[l<self.reg]
+00001300: 203d 2030 0d0a 2020 2020 2020 2020 2020   = 0..          
+00001310: 2020 696e 765f 6d61 7420 3d20 6e70 2e64    inv_mat = np.d
+00001320: 6f74 2875 2c20 6e70 2e64 6961 6728 6c5f  ot(u, np.diag(l_
+00001330: 696e 7629 292e 646f 7428 752e 5429 0d0a  inv)).dot(u.T)..
+00001340: 0d0a 2020 2020 2020 2020 4620 3d20 6e70  ..        F = np
+00001350: 2e64 6f74 2869 6e76 5f6d 6174 2c20 286e  .dot(inv_mat, (n
+00001360: 702e 646f 7428 7365 6c66 2e59 2c20 7073  p.dot(self.Y, ps
+00001370: 695f 696e 7629 2e64 6f74 2841 2920 2b20  i_inv).dot(A) + 
+00001380: 6e70 2e64 6f74 284d 2c20 7365 6c66 2e59  np.dot(M, self.Y
+00001390: 292e 646f 7428 7073 695f 696e 7629 2e64  ).dot(psi_inv).d
+000013a0: 6f74 2842 2929 2e66 6c61 7474 656e 286f  ot(B)).flatten(o
+000013b0: 7264 6572 3d27 4627 2929 0d0a 2020 2020  rder='F'))..    
+000013c0: 2020 2020 7265 7475 726e 206e 702e 7265      return np.re
+000013d0: 7368 6170 6528 462c 2873 656c 662e 6e2c  shape(F,(self.n,
+000013e0: 7365 6c66 2e72 292c 206f 7264 6572 3d27  self.r), order='
+000013f0: 4627 290d 0a20 2020 200d 0a0d 0a20 2020  F')..    ....   
+00001400: 2064 6566 2066 6974 5f67 6770 2873 656c   def fit_ggp(sel
+00001410: 662c 2070 7369 203d 204e 6f6e 652c 2046  f, psi = None, F
+00001420: 5f73 7461 7274 203d 204e 6f6e 652c 2072  _start = None, r
+00001430: 6567 203d 204e 6f6e 652c 2074 7970 655f  eg = None, type_
+00001440: 7265 6720 3d20 4e6f 6e65 2c20 465f 6d65  reg = None, F_me
+00001450: 7468 6f64 203d 2027 6469 7265 6374 272c  thod = 'direct',
+00001460: 2063 203d 204e 6f6e 652c 2076 6572 626f   c = None, verbo
+00001470: 7365 203d 2054 7275 6529 2d3e 204e 6f6e  se = True)-> Non
+00001480: 653a 0d0a 2020 2020 2020 2020 2222 220d  e:..        """.
+00001490: 0a20 2020 2020 2020 2047 7261 7068 2047  .        Graph G
+000014a0: 5020 6f6e 6c79 2066 6974 2063 6f76 6172  P only fit covar
+000014b0: 6961 6e63 6520 7465 726d 0d0a 2020 2020  iance term..    
+000014c0: 2020 2020 2222 220d 0a0d 0a0d 0a20 2020      """......   
+000014d0: 2020 2020 2073 656c 662e 7265 6720 3d20       self.reg = 
+000014e0: 7265 670d 0a20 2020 2020 2020 2073 656c  reg..        sel
+000014f0: 662e 7479 7065 5f72 6567 203d 2074 7970  f.type_reg = typ
+00001500: 655f 7265 670d 0a0d 0a20 2020 2020 2020  e_reg....       
+00001510: 2073 656c 662e 465f 6d65 7468 6f64 203d   self.F_method =
+00001520: 2046 5f6d 6574 686f 640d 0a0d 0a0d 0a20   F_method...... 
+00001530: 2020 2020 2020 2073 656c 662e 7231 203d         self.r1 =
+00001540: 2073 656c 662e 720d 0a20 2020 2020 2020   self.r..       
+00001550: 2073 656c 662e 7232 203d 2073 656c 662e   self.r2 = self.
+00001560: 720d 0a0d 0a0d 0a20 2020 2020 2020 2069  r......        i
+00001570: 6620 465f 7374 6172 7420 6973 204e 6f6e  f F_start is Non
+00001580: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00001590: 465f 7072 6520 3d20 6e70 2e6f 6e65 7328  F_pre = np.ones(
+000015a0: 2873 656c 662e 6e2c 2073 656c 662e 7229  (self.n, self.r)
+000015b0: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+000015c0: 0d0a 2020 2020 2020 2020 2020 2020 465f  ..            F_
+000015d0: 7072 6520 3d20 465f 7374 6172 740d 0a0d  pre = F_start...
+000015e0: 0a0d 0a20 2020 2020 2020 2059 5f74 696c  ...        Y_til
+000015f0: 6465 203d 206e 702e 7673 7461 636b 2828  de = np.vstack((
+00001600: 7365 6c66 2e59 2c20 6e70 2e7a 6572 6f73  self.Y, np.zeros
+00001610: 2828 7365 6c66 2e6e 2c73 656c 662e 6429  ((self.n,self.d)
+00001620: 2929 290d 0a0d 0a0d 0a20 2020 2020 2020  )))......       
+00001630: 2069 6620 7073 6920 6973 204e 6f6e 653a   if psi is None:
+00001640: 0d0a 2020 2020 2020 2020 2020 2020 5073  ..            Ps
+00001650: 695f 7072 6520 3d20 6e70 2e69 6465 6e74  i_pre = np.ident
+00001660: 6974 7928 7365 6c66 2e64 290d 0a20 2020  ity(self.d)..   
+00001670: 2020 2020 2020 2020 2050 7369 5f70 7265           Psi_pre
+00001680: 5f69 6e76 203d 206e 702e 6c69 6e61 6c67  _inv = np.linalg
+00001690: 2e69 6e76 2850 7369 5f70 7265 290d 0a20  .inv(Psi_pre).. 
+000016a0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+000016b0: 2020 2020 2020 2020 2020 5073 695f 7072            Psi_pr
+000016c0: 6520 3d20 7073 690d 0a20 2020 2020 2020  e = psi..       
+000016d0: 2020 2020 2050 7369 5f70 7265 5f69 6e76       Psi_pre_inv
+000016e0: 203d 206e 702e 6c69 6e61 6c67 2e69 6e76   = np.linalg.inv
+000016f0: 2850 7369 5f70 7265 290d 0a0d 0a20 2020  (Psi_pre)....   
+00001700: 2020 2020 2076 203d 206e 702e 6f6e 6573       v = np.ones
+00001710: 2873 656c 662e 6e29 0d0a 2020 2020 2020  (self.n)..      
+00001720: 2020 6d20 3d20 6e70 2e6f 6e65 7328 7365    m = np.ones(se
+00001730: 6c66 2e6e 290d 0a20 2020 2020 2020 2023  lf.n)..        #
+00001740: 2054 6865 2073 6f6c 7574 696f 6e20 6973   The solution is
+00001750: 2065 7672 7920 7365 6e73 6974 6976 6520   evry sensitive 
+00001760: 746f 2074 6865 2069 6e69 7461 6c20 6d61  to the inital ma
+00001770: 7472 6978 2c20 7468 6520 6c32 2072 6567  trix, the l2 reg
+00001780: 756c 6172 697a 6174 696f 6e20 666f 7220  ularization for 
+00001790: 425f 7072 6520 6566 6665 6374 7320 616c  B_pre effects al
+000017a0: 7068 610d 0a20 2020 2020 2020 2069 6620  pha..        if 
+000017b0: 6320 6973 204e 6f6e 653a 0d0a 2020 2020  c is None:..    
+000017c0: 2020 2020 2020 2020 435f 7072 6520 3d20          C_pre = 
+000017d0: 6e70 2e6f 6e65 7328 2873 656c 662e 642c  np.ones((self.d,
+000017e0: 2073 656c 662e 722b 7365 6c66 2e72 2929   self.r+self.r))
+000017f0: 2320 6e70 2e64 6f74 2859 5f74 696c 6465  # np.dot(Y_tilde
+00001800: 2e54 2c20 585f 7469 6c64 6529 2e64 6f74  .T, X_tilde).dot
+00001810: 286e 702e 6c69 6e61 6c67 2e69 6e76 286e  (np.linalg.inv(n
+00001820: 702e 646f 7428 585f 7469 6c64 652e 542c  p.dot(X_tilde.T,
+00001830: 2058 5f74 696c 6465 2920 2b20 616c 7068   X_tilde) + alph
+00001840: 612a 6e70 2e69 6465 6e74 6974 7928 7229  a*np.identity(r)
+00001850: 2929 0d0a 2020 2020 2020 2020 656c 7365  ))..        else
+00001860: 3a0d 0a20 2020 2020 2020 2020 2020 2043  :..            C
+00001870: 5f70 7265 203d 2063 0d0a 0d0a 2020 2020  _pre = c....    
+00001880: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
+00001890: 6c66 2e69 7465 7261 7469 6f6e 203d 2030  lf.iteration = 0
+000018a0: 0d0a 2020 2020 2020 2020 7365 6c66 2e74  ..        self.t
+000018b0: 6f6c 5f76 6563 203d 206e 702e 7a65 726f  ol_vec = np.zero
+000018c0: 7328 7365 6c66 2e6d 6178 5f69 7465 7229  s(self.max_iter)
+000018d0: 0d0a 0d0a 2020 2020 2020 2020 6966 2076  ....        if v
+000018e0: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
+000018f0: 2020 2020 2070 6261 7220 3d20 7471 646d       pbar = tqdm
+00001900: 2e74 7164 6d28 746f 7461 6c20 3d20 7365  .tqdm(total = se
+00001910: 6c66 2e6d 6178 5f69 7465 7229 0d0a 2020  lf.max_iter)..  
+00001920: 2020 2020 2020 7768 696c 6520 7365 6c66        while self
+00001930: 2e69 7465 7261 7469 6f6e 203c 7365 6c66  .iteration <self
+00001940: 2e6d 6178 5f69 7465 723a 0d0a 2020 2020  .max_iter:..    
+00001950: 2020 2020 2020 2020 432c 2050 7369 5f65          C, Psi_e
+00001960: 7374 2c20 462c 2074 6f6c 5f69 203d 2073  st, F, tol_i = s
+00001970: 656c 662e 6f6e 655f 6974 6572 6174 696f  elf.one_iteratio
+00001980: 6e28 6e70 2e6c 696e 616c 672e 696e 7628  n(np.linalg.inv(
+00001990: 5073 695f 7072 655f 696e 7629 2c20 7073  Psi_pre_inv), ps
+000019a0: 692c 2043 5f70 7265 2c20 632c 2059 5f74  i, C_pre, c, Y_t
+000019b0: 696c 6465 2c20 465f 7072 6520 3d20 465f  ilde, F_pre = F_
+000019c0: 7072 652c 2077 6974 685f 6d65 616e 203d  pre, with_mean =
+000019d0: 2054 7275 6529 2020 2020 0d0a 2020 2020   True)    ..    
+000019e0: 2020 2020 2020 2020 7365 6c66 2e74 6f6c          self.tol
+000019f0: 5f76 6563 5b73 656c 662e 6974 6572 6174  _vec[self.iterat
+00001a00: 696f 6e5d 203d 2074 6f6c 5f69 0d0a 0d0a  ion] = tol_i....
+00001a10: 2020 2020 2020 2020 2020 2020 6966 2076              if v
+00001a20: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
+00001a30: 2020 2020 2020 2020 2070 6261 722e 7365           pbar.se
+00001a40: 745f 6465 7363 7269 7074 696f 6e28 6622  t_description(f"
+00001a50: 4572 726f 7220 7b44 6563 696d 616c 2874  Error {Decimal(t
+00001a60: 6f6c 5f69 293a 2e32 457d 2229 0d0a 2020  ol_i):.2E}")..  
+00001a70: 2020 2020 2020 2020 2020 2020 2020 7062                pb
+00001a80: 6172 2e75 7064 6174 6528 290d 0a0d 0a20  ar.update().... 
+00001a90: 2020 2020 2020 2020 2020 2069 6620 2874             if (t
+00001aa0: 6f6c 5f69 3c73 656c 662e 746f 6c29 2026  ol_i<self.tol) &
+00001ab0: 2028 6e6f 7420 7365 6c66 2e64 6f5f 616c   (not self.do_al
+00001ac0: 6c5f 6974 6572 293a 0d0a 2020 2020 2020  l_iter):..      
+00001ad0: 2020 2020 2020 2020 2020 6272 6561 6b0d            break.
+00001ae0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00001af0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00001b00: 6974 6572 6174 696f 6e2b 3d31 0d0a 0d0a  iteration+=1....
+00001b10: 2020 2020 2020 2020 2020 2020 6966 2070              if p
+00001b20: 7369 2069 7320 4e6f 6e65 3a0d 0a20 2020  si is None:..   
+00001b30: 2020 2020 2020 2020 2020 2020 2050 7369               Psi
+00001b40: 5f70 7265 203d 2050 7369 5f65 7374 2e63  _pre = Psi_est.c
+00001b50: 6f70 7928 290d 0a0d 0a20 2020 2020 2020  opy()....       
+00001b60: 2020 2020 2043 5f70 7265 203d 2043 2e63       C_pre = C.c
+00001b70: 6f70 7928 290d 0a20 2020 2020 2020 2020  opy()..         
+00001b80: 2020 2046 5f70 7265 203d 2046 2e63 6f70     F_pre = F.cop
+00001b90: 7928 290d 0a0d 0a20 2020 2020 2020 2073  y()....        s
+00001ba0: 656c 662e 4120 3d20 435b 3a2c 3a73 656c  elf.A = C[:,:sel
+00001bb0: 662e 725d 0d0a 2020 2020 2020 2020 7365  f.r]..        se
+00001bc0: 6c66 2e42 203d 2043 5b3a 2c73 656c 662e  lf.B = C[:,self.
+00001bd0: 723a 5d0d 0a20 2020 2020 2020 2073 656c  r:]..        sel
+00001be0: 662e 4620 3d20 460d 0a20 2020 2020 2020  f.F = F..       
+00001bf0: 2073 656c 662e 5073 6920 3d20 5073 695f   self.Psi = Psi_
+00001c00: 6573 740d 0a0d 0a20 2020 2020 2020 2069  est....        i
+00001c10: 6620 7665 7262 6f73 653a 0d0a 2020 2020  f verbose:..    
+00001c20: 2020 2020 2020 2020 7062 6172 2e63 6c6f          pbar.clo
+00001c30: 7365 2829 0d0a 0d0a 0d0a 0d0a 2020 2020  se()........    
+00001c40: 6465 6620 6d61 7267 5f6c 696b 2873 656c  def marg_lik(sel
+00001c50: 6629 3a0d 0a0d 0a20 2020 2020 2020 2076  f):....        v
+00001c60: 203d 206e 702e 6f6e 6573 2873 656c 662e   = np.ones(self.
+00001c70: 6e29 0d0a 2020 2020 2020 2020 6d20 3d20  n)..        m = 
+00001c80: 6e70 2e6f 6e65 7328 7365 6c66 2e6e 290d  np.ones(self.n).
+00001c90: 0a0d 0a20 2020 2020 2020 2070 7369 5f69  ...        psi_i
+00001ca0: 6e76 203d 206e 702e 6c69 6e61 6c67 2e69  nv = np.linalg.i
+00001cb0: 6e76 2873 656c 662e 5073 6929 0d0a 0d0a  nv(self.Psi)....
+00001cc0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00001cd0: 4120 6973 204e 6f6e 653a 0d0a 2020 2020  A is None:..    
+00001ce0: 2020 2020 2020 2020 4320 3d20 7365 6c66          C = self
+00001cf0: 2e42 0d0a 2020 2020 2020 2020 656c 7365  .B..        else
+00001d00: 3a0d 0a20 2020 2020 2020 2020 2020 2043  :..            C
+00001d10: 203d 206e 702e 6873 7461 636b 2828 7365   = np.hstack((se
+00001d20: 6c66 2e41 2c20 7365 6c66 2e42 2929 0d0a  lf.A, self.B))..
+00001d30: 2020 2020 2020 2020 0d0a 0d0a 2020 2020          ....    
+00001d40: 2020 2020 2320 452d 7374 6570 0d0a 2020      # E-step..  
+00001d50: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00001d60: 616e 6765 2873 656c 662e 6e29 3a0d 0a20  ange(self.n):.. 
+00001d70: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00001d80: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00001d90: 2e41 2069 7320 6e6f 7420 4e6f 6e65 3a0d  .A is not None:.
+00001da0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001db0: 2078 5f69 203d 206e 702e 6873 7461 636b   x_i = np.hstack
+00001dc0: 2828 7365 6c66 2e46 5b69 5d2c 2073 656c  ((self.F[i], sel
+00001dd0: 662e 465b 695d 2929 0d0a 2020 2020 2020  f.F[i]))..      
+00001de0: 2020 2020 2020 2020 2020 765b 695d 203d            v[i] =
+00001df0: 2028 312b 6e70 2e64 6f74 2878 5f69 2e54   (1+np.dot(x_i.T
+00001e00: 2c20 432e 5429 2e64 6f74 2870 7369 5f69  , C.T).dot(psi_i
+00001e10: 6e76 292e 646f 7428 4329 2e64 6f74 2878  nv).dot(C).dot(x
+00001e20: 5f69 2929 202a 2a20 282d 3129 0d0a 2020  _i)) ** (-1)..  
+00001e30: 2020 2020 2020 2020 2020 2020 2020 6d5b                m[
+00001e40: 695d 203d 2076 5b69 5d2a 6e70 2e64 6f74  i] = v[i]*np.dot
+00001e50: 2828 7365 6c66 2e59 5b69 5d2d 6e70 2e64  ((self.Y[i]-np.d
+00001e60: 6f74 2873 656c 662e 412c 2073 656c 662e  ot(self.A, self.
+00001e70: 465b 695d 2929 2e54 2c70 7369 5f69 6e76  F[i])).T,psi_inv
+00001e80: 292e 646f 7428 4329 2e64 6f74 2878 5f69  ).dot(C).dot(x_i
+00001e90: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00001ea0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00001eb0: 2020 2020 2020 785f 6920 3d20 7365 6c66        x_i = self
+00001ec0: 2e46 5b69 5d0d 0a20 2020 2020 2020 2020  .F[i]..         
+00001ed0: 2020 2020 2020 2076 5b69 5d20 3d20 2831         v[i] = (1
+00001ee0: 2b6e 702e 646f 7428 785f 692e 542c 2043  +np.dot(x_i.T, C
+00001ef0: 2e54 292e 646f 7428 7073 695f 696e 7629  .T).dot(psi_inv)
+00001f00: 2e64 6f74 2843 292e 646f 7428 785f 6929  .dot(C).dot(x_i)
+00001f10: 2920 2a2a 2028 2d31 290d 0a20 2020 2020  ) ** (-1)..     
+00001f20: 2020 2020 2020 2020 2020 206d 5b69 5d20             m[i] 
+00001f30: 3d20 765b 695d 2a6e 702e 646f 7428 2873  = v[i]*np.dot((s
+00001f40: 656c 662e 595b 695d 292e 542c 7073 695f  elf.Y[i]).T,psi_
+00001f50: 696e 7629 2e64 6f74 2843 292e 646f 7428  inv).dot(C).dot(
+00001f60: 785f 6929 0d0a 0d0a 2020 2020 2020 2020  x_i)....        
+00001f70: 0d0a 2020 2020 2020 2020 2320 4d2d 7374  ..        # M-st
+00001f80: 6570 0d0a 0d0a 2020 2020 2020 2020 595f  ep....        Y_
+00001f90: 7469 6c64 6520 3d20 6e70 2e76 7374 6163  tilde = np.vstac
+00001fa0: 6b28 2873 656c 662e 592c 206e 702e 7a65  k((self.Y, np.ze
+00001fb0: 726f 7328 2873 656c 662e 6e2c 7365 6c66  ros((self.n,self
+00001fc0: 2e64 2929 2929 0d0a 2020 2020 2020 2020  .d))))..        
+00001fd0: 6966 2073 656c 662e 4120 6973 206e 6f74  if self.A is not
+00001fe0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00001ff0: 2020 2020 585f 7469 6c64 6520 3d20 206e      X_tilde =  n
+00002000: 702e 7673 7461 636b 2828 6e70 2e68 7374  p.vstack((np.hst
+00002010: 6163 6b28 2873 656c 662e 462c 206d 5b3a  ack((self.F, m[:
+00002020: 2c6e 702e 6e65 7761 7869 735d 2a73 656c  ,np.newaxis]*sel
+00002030: 662e 4629 292c 6e70 2e68 7374 6163 6b28  f.F)),np.hstack(
+00002040: 286e 702e 7a65 726f 7328 2873 656c 662e  (np.zeros((self.
+00002050: 6e2c 2073 656c 662e 7231 2929 2c76 5b3a  n, self.r1)),v[:
+00002060: 2c6e 702e 6e65 7761 7869 735d 2a73 656c  ,np.newaxis]*sel
+00002070: 662e 4629 2929 290d 0a20 2020 2020 2020  f.F))))..       
+00002080: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00002090: 2020 2020 585f 7469 6c64 6520 3d20 206e      X_tilde =  n
+000020a0: 702e 7673 7461 636b 2828 6d5b 3a2c 6e70  p.vstack((m[:,np
+000020b0: 2e6e 6577 6178 6973 5d2a 7365 6c66 2e46  .newaxis]*self.F
+000020c0: 2c76 5b3a 2c6e 702e 6e65 7761 7869 735d  ,v[:,np.newaxis]
+000020d0: 2a73 656c 662e 4629 290d 0a0d 0a0d 0a20  *self.F))...... 
+000020e0: 2020 2020 2020 206f 626a 203d 2030 2e35         obj = 0.5
+000020f0: 2a6e 702e 7472 6163 6528 6e70 2e64 6f74  *np.trace(np.dot
+00002100: 2828 595f 7469 6c64 652d 6e70 2e64 6f74  ((Y_tilde-np.dot
+00002110: 2858 5f74 696c 6465 2c20 432e 5429 292e  (X_tilde, C.T)).
+00002120: 542c 2028 595f 7469 6c64 652d 6e70 2e64  T, (Y_tilde-np.d
+00002130: 6f74 2858 5f74 696c 6465 2c20 432e 5429  ot(X_tilde, C.T)
+00002140: 2929 2e64 6f74 2870 7369 5f69 6e76 2929  )).dot(psi_inv))
+00002150: 202b 2030 2e35 2a73 656c 662e 6f6d 6567   + 0.5*self.omeg
+00002160: 612a 6e70 2e74 7261 6365 286e 702e 646f  a*np.trace(np.do
+00002170: 7428 7365 6c66 2e4b 5f69 6e76 2c20 7365  t(self.K_inv, se
+00002180: 6c66 2e46 292e 646f 7428 7365 6c66 2e48  lf.F).dot(self.H
+00002190: 5f73 715f 696e 7629 2e64 6f74 2873 656c  _sq_inv).dot(sel
+000021a0: 662e 462e 5429 290d 0a20 2020 2020 2020  f.F.T))..       
+000021b0: 200d 0a20 2020 2020 2020 2072 6574 7572   ..        retur
+000021c0: 6e20 6f62 6a0d 0a0d 0a0d 0a0d 0a0d 0a0d  n obj...........
+000021d0: 0a0d 0a0d 0a20 2020 2064 6566 2066 6974  .....    def fit
+000021e0: 5f67 6770 5f62 5f6f 6e6c 7928 7365 6c66  _ggp_b_only(self
+000021f0: 2c20 7073 6920 3d20 4e6f 6e65 2c20 465f  , psi = None, F_
+00002200: 7374 6172 7420 3d20 4e6f 6e65 2c20 2072  start = None,  r
+00002210: 6567 203d 204e 6f6e 652c 2074 7970 655f  eg = None, type_
+00002220: 7265 6720 3d20 4e6f 6e65 2c20 465f 6d65  reg = None, F_me
+00002230: 7468 6f64 203d 2027 6469 7265 6374 272c  thod = 'direct',
+00002240: 2063 203d 204e 6f6e 6529 2d3e 204e 6f6e   c = None)-> Non
+00002250: 653a 0d0a 2020 2020 2020 2020 2222 220d  e:..        """.
+00002260: 0a20 2020 2020 2020 2047 7261 7068 2047  .        Graph G
+00002270: 5020 6f6e 6c79 2066 6974 2063 6f76 6172  P only fit covar
+00002280: 6961 6e63 6520 7465 726d 0d0a 2020 2020  iance term..    
+00002290: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
+000022a0: 2020 2073 656c 662e 465f 6d65 7468 6f64     self.F_method
+000022b0: 203d 2046 5f6d 6574 686f 640d 0a20 2020   = F_method..   
+000022c0: 2020 2020 2073 656c 662e 7265 6720 3d20       self.reg = 
+000022d0: 7265 670d 0a20 2020 2020 2020 2073 656c  reg..        sel
+000022e0: 662e 7479 7065 5f72 6567 203d 2074 7970  f.type_reg = typ
+000022f0: 655f 7265 670d 0a0d 0a20 2020 2020 2020  e_reg....       
+00002300: 2073 656c 662e 7231 203d 2030 0d0a 2020   self.r1 = 0..  
+00002310: 2020 2020 2020 7365 6c66 2e72 3220 3d20        self.r2 = 
+00002320: 7365 6c66 2e72 0d0a 0d0a 2020 2020 2020  self.r....      
+00002330: 2020 0d0a 0d0a 2020 2020 2020 2020 6966    ....        if
+00002340: 2046 5f73 7461 7274 2069 7320 4e6f 6e65   F_start is None
+00002350: 3a0d 0a20 2020 2020 2020 2020 2020 2046  :..            F
+00002360: 5f70 7265 203d 206e 702e 6f6e 6573 2828  _pre = np.ones((
+00002370: 7365 6c66 2e6e 2c20 7365 6c66 2e72 2929  self.n, self.r))
+00002380: 0d0a 0d0a 2020 2020 2020 2020 595f 7469  ....        Y_ti
+00002390: 6c64 6520 3d20 6e70 2e76 7374 6163 6b28  lde = np.vstack(
+000023a0: 2873 656c 662e 592c 206e 702e 7a65 726f  (self.Y, np.zero
+000023b0: 7328 2873 656c 662e 6e2c 7365 6c66 2e64  s((self.n,self.d
+000023c0: 2929 2929 0d0a 0d0a 0d0a 2020 2020 2020  ))))......      
+000023d0: 2020 6966 2070 7369 2069 7320 4e6f 6e65    if psi is None
+000023e0: 3a0d 0a20 2020 2020 2020 2020 2020 2050  :..            P
+000023f0: 7369 5f70 7265 203d 206e 702e 6964 656e  si_pre = np.iden
+00002400: 7469 7479 2873 656c 662e 6429 0d0a 2020  tity(self.d)..  
+00002410: 2020 2020 2020 2020 2020 5073 695f 7072            Psi_pr
+00002420: 655f 696e 7620 3d20 6e70 2e6c 696e 616c  e_inv = np.linal
+00002430: 672e 696e 7628 5073 695f 7072 6529 0d0a  g.inv(Psi_pre)..
+00002440: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00002450: 2020 2020 2020 2020 2020 2050 7369 5f70             Psi_p
+00002460: 7265 203d 2070 7369 0d0a 2020 2020 2020  re = psi..      
+00002470: 2020 2020 2020 5073 695f 7072 655f 696e        Psi_pre_in
+00002480: 7620 3d20 6e70 2e6c 696e 616c 672e 696e  v = np.linalg.in
+00002490: 7628 5073 695f 7072 6529 0d0a 0d0a 2020  v(Psi_pre)....  
+000024a0: 2020 2020 2020 7620 3d20 6e70 2e6f 6e65        v = np.one
+000024b0: 7328 7365 6c66 2e6e 290d 0a20 2020 2020  s(self.n)..     
+000024c0: 2020 206d 203d 206e 702e 6f6e 6573 2873     m = np.ones(s
+000024d0: 656c 662e 6e29 0d0a 2020 2020 2020 2020  elf.n)..        
+000024e0: 2320 5468 6520 736f 6c75 7469 6f6e 2069  # The solution i
+000024f0: 7320 6576 7279 2073 656e 7369 7469 7665  s evry sensitive
+00002500: 2074 6f20 7468 6520 696e 6974 616c 206d   to the inital m
+00002510: 6174 7269 782c 2074 6865 206c 3220 7265  atrix, the l2 re
+00002520: 6775 6c61 7269 7a61 7469 6f6e 2066 6f72  gularization for
+00002530: 2042 5f70 7265 2065 6666 6563 7473 2061   B_pre effects a
+00002540: 6c70 6861 0d0a 2020 2020 2020 2020 0d0a  lpha..        ..
+00002550: 2020 2020 2020 2020 6966 2063 2069 7320          if c is 
+00002560: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+00002570: 2020 2043 5f70 7265 203d 206e 702e 6f6e     C_pre = np.on
+00002580: 6573 2828 7365 6c66 2e64 2c20 7365 6c66  es((self.d, self
+00002590: 2e72 2929 2320 6e70 2e64 6f74 2859 5f74  .r))# np.dot(Y_t
+000025a0: 696c 6465 2e54 2c20 585f 7469 6c64 6529  ilde.T, X_tilde)
+000025b0: 2e64 6f74 286e 702e 6c69 6e61 6c67 2e69  .dot(np.linalg.i
+000025c0: 6e76 286e 702e 646f 7428 585f 7469 6c64  nv(np.dot(X_tild
+000025d0: 652e 542c 2058 5f74 696c 6465 2920 2b20  e.T, X_tilde) + 
+000025e0: 616c 7068 612a 6e70 2e69 6465 6e74 6974  alpha*np.identit
+000025f0: 7928 7229 2929 0d0a 2020 2020 2020 2020  y(r)))..        
+00002600: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00002610: 2020 2043 5f70 7265 203d 2063 0d0a 2020     C_pre = c..  
+00002620: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00002630: 7365 6c66 2e69 7465 7261 7469 6f6e 203d  self.iteration =
+00002640: 2030 0d0a 2020 2020 2020 2020 7365 6c66   0..        self
+00002650: 2e74 6f6c 5f76 6563 203d 206e 702e 7a65  .tol_vec = np.ze
+00002660: 726f 7328 7365 6c66 2e6d 6178 5f69 7465  ros(self.max_ite
+00002670: 7229 0d0a 2020 2020 2020 2020 7768 696c  r)..        whil
+00002680: 6520 7365 6c66 2e69 7465 7261 7469 6f6e  e self.iteration
+00002690: 203c 7365 6c66 2e6d 6178 5f69 7465 723a   <self.max_iter:
+000026a0: 0d0a 2020 2020 2020 2020 2020 2020 432c  ..            C,
+000026b0: 2050 7369 5f65 7374 2c20 462c 2074 6f6c   Psi_est, F, tol
+000026c0: 5f69 203d 2073 656c 662e 6f6e 655f 6974  _i = self.one_it
+000026d0: 6572 6174 696f 6e28 6e70 2e6c 696e 616c  eration(np.linal
+000026e0: 672e 696e 7628 5073 695f 7072 6529 2c20  g.inv(Psi_pre), 
+000026f0: 7073 692c 2043 5f70 7265 2c20 632c 2059  psi, C_pre, c, Y
+00002700: 5f74 696c 6465 2c20 465f 7072 6520 3d20  _tilde, F_pre = 
+00002710: 465f 7072 652c 2077 6974 685f 6d65 616e  F_pre, with_mean
+00002720: 203d 2046 616c 7365 290d 0a20 2020 2020   = False)..     
+00002730: 2020 2020 2020 2073 656c 662e 746f 6c5f         self.tol_
+00002740: 7665 635b 7365 6c66 2e69 7465 7261 7469  vec[self.iterati
+00002750: 6f6e 5d20 3d20 746f 6c5f 690d 0a20 2020  on] = tol_i..   
+00002760: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00002770: 2020 2020 2020 2069 6620 2874 6f6c 5f69         if (tol_i
+00002780: 3c73 656c 662e 746f 6c29 2026 2028 6e6f  <self.tol) & (no
+00002790: 7420 7365 6c66 2e64 6f5f 616c 6c5f 6974  t self.do_all_it
+000027a0: 6572 293a 0d0a 2020 2020 2020 2020 2020  er):..          
+000027b0: 2020 2020 2020 6272 6561 6b0d 0a20 2020        break..   
+000027c0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+000027d0: 2020 2020 2020 2073 656c 662e 6974 6572         self.iter
+000027e0: 6174 696f 6e2b 3d31 0d0a 0d0a 2020 2020  ation+=1....    
+000027f0: 2020 2020 2020 2020 6966 2070 7369 2069          if psi i
+00002800: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
+00002810: 2020 2020 2020 2020 2050 7369 5f70 7265           Psi_pre
+00002820: 203d 2050 7369 5f65 7374 2e63 6f70 7928   = Psi_est.copy(
+00002830: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00002840: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00002850: 2020 2020 2020 5073 695f 7072 6520 3d20        Psi_pre = 
+00002860: 7073 690d 0a0d 0a20 2020 2020 2020 2020  psi....         
+00002870: 2020 2043 5f70 7265 203d 2043 2e63 6f70     C_pre = C.cop
+00002880: 7928 290d 0a20 2020 2020 2020 2020 2020  y()..           
+00002890: 2046 5f70 7265 203d 2046 2e63 6f70 7928   F_pre = F.copy(
+000028a0: 290d 0a0d 0a0d 0a0d 0a20 2020 2020 2020  )........       
+000028b0: 2073 656c 662e 4120 3d20 4e6f 6e65 0d0a   self.A = None..
+000028c0: 2020 2020 2020 2020 7365 6c66 2e42 203d          self.B =
+000028d0: 2043 5b3a 2c73 656c 662e 723a 5d0d 0a20   C[:,self.r:].. 
+000028e0: 2020 2020 2020 2073 656c 662e 4620 3d20         self.F = 
+000028f0: 460d 0a20 2020 2020 2020 2073 656c 662e  F..        self.
+00002900: 5073 6920 3d20 5073 695f 6573 740d 0a0d  Psi = Psi_est...
+00002910: 0a0d 0a0d 0a20 2020 2064 6566 2066 6974  .....    def fit
+00002920: 5f67 6770 5f61 5f6f 6e6c 7928 7365 6c66  _ggp_a_only(self
+00002930: 2c20 7073 6920 3d20 4e6f 6e65 2c20 465f  , psi = None, F_
+00002940: 7374 6172 7420 3d20 4e6f 6e65 2c20 7265  start = None, re
+00002950: 6720 3d20 4e6f 6e65 2c20 7479 7065 5f72  g = None, type_r
+00002960: 6567 203d 204e 6f6e 652c 2046 5f6d 6574  eg = None, F_met
+00002970: 686f 6420 3d20 2764 6972 6563 7427 2c20  hod = 'direct', 
+00002980: 6320 3d20 4e6f 6e65 2920 2d3e 204e 6f6e  c = None) -> Non
+00002990: 653a 0d0a 0d0a 0d0a 2020 2020 2020 2020  e:......        
+000029a0: 7365 6c66 2e72 6567 203d 2072 6567 0d0a  self.reg = reg..
+000029b0: 2020 2020 2020 2020 7365 6c66 2e74 7970          self.typ
+000029c0: 655f 7265 6720 3d20 7479 7065 5f72 6567  e_reg = type_reg
+000029d0: 0d0a 2020 2020 2020 2020 7365 6c66 2e46  ..        self.F
+000029e0: 5f6d 6574 686f 6420 3d20 465f 6d65 7468  _method = F_meth
+000029f0: 6f64 0d0a 0d0a 2020 2020 2020 2020 7365  od....        se
+00002a00: 6c66 2e72 3120 3d20 7365 6c66 2e72 0d0a  lf.r1 = self.r..
+00002a10: 2020 2020 2020 2020 7365 6c66 2e72 3220          self.r2 
+00002a20: 3d20 300d 0a0d 0a0d 0a20 2020 2020 2020  = 0......       
+00002a30: 2069 6620 7073 6920 6973 204e 6f6e 653a   if psi is None:
+00002a40: 0d0a 2020 2020 2020 2020 2020 2020 5073  ..            Ps
+00002a50: 695f 7072 6520 3d20 6e70 2e69 6465 6e74  i_pre = np.ident
+00002a60: 6974 7928 7365 6c66 2e64 290d 0a20 2020  ity(self.d)..   
+00002a70: 2020 2020 2020 2020 2050 7369 5f70 7265           Psi_pre
+00002a80: 5f69 6e76 203d 206e 702e 6c69 6e61 6c67  _inv = np.linalg
+00002a90: 2e69 6e76 2850 7369 5f70 7265 290d 0a20  .inv(Psi_pre).. 
+00002aa0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00002ab0: 2020 2020 2020 2020 2020 5073 695f 7072            Psi_pr
+00002ac0: 6520 3d20 7073 690d 0a20 2020 2020 2020  e = psi..       
+00002ad0: 2020 2020 2050 7369 5f70 7265 5f69 6e76       Psi_pre_inv
+00002ae0: 203d 206e 702e 6c69 6e61 6c67 2e69 6e76   = np.linalg.inv
+00002af0: 2850 7369 5f70 7265 290d 0a0d 0a0d 0a0d  (Psi_pre).......
+00002b00: 0a20 2020 2020 2020 2069 6620 6320 6973  .        if c is
+00002b10: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00002b20: 2020 2020 435f 7072 6520 3d20 6e70 2e6f      C_pre = np.o
+00002b30: 6e65 7328 2873 656c 662e 642c 2073 656c  nes((self.d, sel
+00002b40: 662e 7229 2923 206e 702e 646f 7428 595f  f.r))# np.dot(Y_
+00002b50: 7469 6c64 652e 542c 2058 5f74 696c 6465  tilde.T, X_tilde
+00002b60: 292e 646f 7428 6e70 2e6c 696e 616c 672e  ).dot(np.linalg.
+00002b70: 696e 7628 6e70 2e64 6f74 2858 5f74 696c  inv(np.dot(X_til
+00002b80: 6465 2e54 2c20 585f 7469 6c64 6529 202b  de.T, X_tilde) +
+00002b90: 2061 6c70 6861 2a6e 702e 6964 656e 7469   alpha*np.identi
+00002ba0: 7479 2872 2929 290d 0a20 2020 2020 2020  ty(r)))..       
+00002bb0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00002bc0: 2020 2020 435f 7072 6520 3d20 630d 0a0d      C_pre = c...
+00002bd0: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
+00002be0: 6974 6572 6174 696f 6e20 3d20 300d 0a20  iteration = 0.. 
+00002bf0: 2020 2020 2020 2073 656c 662e 746f 6c5f         self.tol_
+00002c00: 7665 6320 3d20 6e70 2e7a 6572 6f73 2873  vec = np.zeros(s
+00002c10: 656c 662e 6d61 785f 6974 6572 290d 0a20  elf.max_iter).. 
+00002c20: 2020 2020 2020 2077 6869 6c65 2073 656c         while sel
+00002c30: 662e 6974 6572 6174 696f 6e20 3c73 656c  f.iteration <sel
+00002c40: 662e 6d61 785f 6974 6572 3a0d 0a20 2020  f.max_iter:..   
+00002c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002c60: 2023 204d 2d73 7465 700d 0a20 2020 2020   # M-step..     
+00002c70: 2020 2020 2020 2050 7369 5f70 7265 5f69         Psi_pre_i
+00002c80: 6e76 203d 206e 702e 6c69 6e61 6c67 2e69  nv = np.linalg.i
+00002c90: 6e76 2850 7369 5f70 7265 290d 0a20 2020  nv(Psi_pre)..   
+00002ca0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00002cb0: 2e46 5f6d 6574 686f 6420 3d3d 2027 6469  .F_method == 'di
+00002cc0: 7265 6374 273a 0d0a 2020 2020 2020 2020  rect':..        
+00002cd0: 2020 2020 2020 2020 4620 3d20 7365 6c66          F = self
+00002ce0: 2e46 5f6c 735f 7265 6728 2043 5f70 7265  .F_ls_reg( C_pre
+00002cf0: 2c20 5073 695f 7072 655f 696e 7629 0d0a  , Psi_pre_inv)..
+00002d00: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00002d10: 2073 656c 662e 465f 6d65 7468 6f64 203d   self.F_method =
+00002d20: 3d20 2773 6563 616e 7427 3a0d 0a20 2020  = 'secant':..   
+00002d30: 2020 2020 2020 2020 2020 2020 2046 203d               F =
+00002d40: 2073 656c 662e 465f 7365 6361 6e74 5f6f   self.F_secant_o
+00002d50: 7074 696d 286e 702e 7a65 726f 7328 2873  ptim(np.zeros((s
+00002d60: 656c 662e 642c 2073 656c 662e 7229 292c  elf.d, self.r)),
+00002d70: 2043 5f70 7265 2c20 6e70 2e6f 6e65 7328   C_pre, np.ones(
+00002d80: 7365 6c66 2e6e 292c 6e70 2e6f 6e65 7328  self.n),np.ones(
+00002d90: 7365 6c66 2e6e 292c 2050 7369 5f70 7265  self.n), Psi_pre
+00002da0: 5f69 6e76 290d 0a0d 0a20 2020 2020 2020  _inv)....       
+00002db0: 2020 2020 2069 6620 6320 6973 204e 6f6e       if c is Non
+00002dc0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00002dd0: 2020 2020 435f 746d 7020 3d20 435f 7072      C_tmp = C_pr
+00002de0: 652e 666c 6174 7465 6e28 290d 0a20 2020  e.flatten()..   
+00002df0: 2020 2020 2020 2020 2020 2020 2043 5f76               C_v
+00002e00: 6563 203d 206e 702e 7a65 726f 7328 322a  ec = np.zeros(2*
+00002e10: 2873 656c 662e 7231 2b73 656c 662e 7232  (self.r1+self.r2
+00002e20: 292a 7365 6c66 2e64 290d 0a20 2020 2020  )*self.d)..     
+00002e30: 2020 2020 2020 2020 2020 2043 5f76 6563             C_vec
+00002e40: 5b3a 2873 656c 662e 7231 2b73 656c 662e  [:(self.r1+self.
+00002e50: 7232 292a 7365 6c66 2e64 5d20 3d20 6e70  r2)*self.d] = np
+00002e60: 2e61 6273 2843 5f74 6d70 2920 2a20 2843  .abs(C_tmp) * (C
+00002e70: 5f74 6d70 3e30 290d 0a20 2020 2020 2020  _tmp>0)..       
+00002e80: 2020 2020 2020 2020 2043 5f76 6563 5b28           C_vec[(
+00002e90: 7365 6c66 2e72 312b 7365 6c66 2e72 3229  self.r1+self.r2)
+00002ea0: 2a73 656c 662e 643a 5d20 3d20 6e70 2e61  *self.d:] = np.a
+00002eb0: 6273 2843 5f74 6d70 2920 2a20 2843 5f74  bs(C_tmp) * (C_t
+00002ec0: 6d70 3c30 290d 0a0d 0a20 2020 2020 2020  mp<0)....       
+00002ed0: 2020 2020 2020 2020 206f 7574 203d 206d           out = m
+00002ee0: 696e 696d 697a 6528 7365 6c66 2e6c 6173  inimize(self.las
+00002ef0: 736f 5f6f 626a 6563 7469 7665 2c20 435f  so_objective, C_
+00002f00: 7665 632c 2061 7267 7320 3d20 2846 2c20  vec, args = (F, 
+00002f10: 7365 6c66 2e59 2c20 5073 695f 7072 655f  self.Y, Psi_pre_
+00002f20: 696e 762c 7365 6c66 2e64 2c73 656c 662e  inv,self.d,self.
+00002f30: 7231 2b73 656c 662e 7232 2c20 7365 6c66  r1+self.r2, self
+00002f40: 2e61 6c70 6861 292c 206d 6574 686f 643d  .alpha), method=
+00002f50: 274c 2d42 4647 532d 4227 2c20 6a61 633d  'L-BFGS-B', jac=
+00002f60: 5472 7565 2c20 626f 756e 6473 203d 205b  True, bounds = [
+00002f70: 2830 2e30 2c4e 6f6e 6529 5d2a 2832 2a28  (0.0,None)]*(2*(
+00002f80: 7365 6c66 2e72 312b 7365 6c66 2e72 3229  self.r1+self.r2)
+00002f90: 2a73 656c 662e 6429 290d 0a20 2020 2020  *self.d))..     
+00002fa0: 2020 2020 2020 2020 2020 2043 5f76 6563             C_vec
+00002fb0: 203d 206f 7574 2e78 0d0a 2020 2020 2020   = out.x..      
+00002fc0: 2020 2020 2020 2020 2020 4320 3d20 6e70            C = np
+00002fd0: 2e72 6573 6861 7065 286f 7574 2e78 5b3a  .reshape(out.x[:
+00002fe0: 2873 656c 662e 7231 2b73 656c 662e 7232  (self.r1+self.r2
+00002ff0: 292a 7365 6c66 2e64 5d20 2d20 6f75 742e  )*self.d] - out.
+00003000: 785b 2873 656c 662e 7231 2b73 656c 662e  x[(self.r1+self.
+00003010: 7232 292a 7365 6c66 2e64 3a5d 2c20 2873  r2)*self.d:], (s
+00003020: 656c 662e 642c 7365 6c66 2e72 312b 7365  elf.d,self.r1+se
+00003030: 6c66 2e72 3229 290d 0a0d 0a20 2020 2020  lf.r2))....     
+00003040: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00003050: 2020 2020 2020 2020 2020 2020 2020 4320                C 
+00003060: 3d20 630d 0a0d 0a0d 0a20 2020 2020 2020  = c......       
+00003070: 2020 2020 2074 6f6c 5f69 203d 2028 6e70       tol_i = (np
+00003080: 2e6c 696e 616c 672e 6e6f 726d 2843 2d43  .linalg.norm(C-C
+00003090: 5f70 7265 2929 2f28 6e70 2e6c 696e 616c  _pre))/(np.linal
+000030a0: 672e 6e6f 726d 2843 5f70 7265 2929 0d0a  g.norm(C_pre))..
+000030b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000030c0: 2e74 6f6c 5f76 6563 5b73 656c 662e 6974  .tol_vec[self.it
+000030d0: 6572 6174 696f 6e5d 203d 2074 6f6c 5f69  eration] = tol_i
+000030e0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000030f0: 2020 2020 2020 2020 6966 2028 746f 6c5f          if (tol_
+00003100: 693c 7365 6c66 2e74 6f6c 2920 2620 286e  i<self.tol) & (n
+00003110: 6f74 2073 656c 662e 646f 5f61 6c6c 5f69  ot self.do_all_i
+00003120: 7465 7229 3a0d 0a20 2020 2020 2020 2020  ter):..         
+00003130: 2020 2020 2020 2062 7265 616b 0d0a 2020         break..  
+00003140: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00003150: 2020 2020 2020 2020 7365 6c66 2e69 7465          self.ite
+00003160: 7261 7469 6f6e 2b3d 310d 0a20 2020 2020  ration+=1..     
+00003170: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00003180: 2020 2020 2069 6620 7073 6920 6973 204e       if psi is N
+00003190: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+000031a0: 2020 2020 2020 5073 695f 6573 7420 3d20        Psi_est = 
+000031b0: 6e70 2e63 6f76 2828 7365 6c66 2e59 2d6e  np.cov((self.Y-n
+000031c0: 702e 646f 7428 462c 432e 5429 292e 5429  p.dot(F,C.T)).T)
+000031d0: 2a28 7365 6c66 2e6e 2d31 292f 7365 6c66  *(self.n-1)/self
+000031e0: 2e6e 0d0a 2020 2020 2020 2020 2020 2020  .n..            
+000031f0: 2020 2020 5073 695f 7072 6520 3d20 5073      Psi_pre = Ps
+00003200: 695f 6573 742e 636f 7079 2829 0d0a 2020  i_est.copy()..  
+00003210: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00003220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003230: 2050 7369 5f65 7374 203d 2070 7369 0d0a   Psi_est = psi..
+00003240: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00003250: 435f 7072 6520 3d20 432e 636f 7079 2829  C_pre = C.copy()
+00003260: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00003270: 6c66 2e69 7465 7261 7469 6f6e 2b3d 310d  lf.iteration+=1.
+00003280: 0a0d 0a0d 0a20 2020 2020 2020 2073 656c  .....        sel
+00003290: 662e 4120 3d20 430d 0a20 2020 2020 2020  f.A = C..       
+000032a0: 2073 656c 662e 4220 3d20 4e6f 6e65 0d0a   self.B = None..
+000032b0: 2020 2020 2020 2020 7365 6c66 2e46 203d          self.F =
+000032c0: 2046 0d0a 2020 2020 2020 2020 7365 6c66   F..        self
+000032d0: 2e50 7369 203d 2050 7369 5f65 7374 0d0a  .Psi = Psi_est..
+000032e0: 0d0a 0d0a 0d0a 0d0a 0d0a 0d0a            ............
```

### Comparing `DyGraph-0.0.2/src/DyGraph/RootDygl.py` & `DyGraph-0.0.3/src/DyGraph/RootDygl.py`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.2/src/DyGraph/dyg_outer_em.py` & `DyGraph-0.0.3/src/DyGraph/dyg_outer_em.py`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.2/src/DyGraph/dygl_inner_em.py` & `DyGraph-0.0.3/src/DyGraph/dygl_inner_em.py`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.2/src/DyGraph/dygl_utils.py` & `DyGraph-0.0.3/src/DyGraph/dygl_utils.py`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.2/src/DyGraph/sgl_inner_em.py` & `DyGraph-0.0.3/src/DyGraph/sgl_inner_em.py`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.2/src/DyGraph/sgl_outer_em.py` & `DyGraph-0.0.3/src/DyGraph/sgl_outer_em.py`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.2/src/DyGraph.egg-info/PKG-INFO` & `DyGraph-0.0.3/src/DyGraph.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: DyGraph
-Version: 0.0.2
+Version: 0.0.3
 Summary: A package for estimating dynamic graphical lasso with heavy tailed distributions
 Home-page: https://github.com/ragnarlevi/DyGraph
 Author: ragnarlevi
 License: MIT
 Project-URL: Bug Tracker, https://github.com/ragnarlevi/DyGraph/issues
 Platform: unix
 Platform: linux
```

### Comparing `DyGraph-0.0.2/src/DyGraph.egg-info/SOURCES.txt` & `DyGraph-0.0.3/src/DyGraph.egg-info/SOURCES.txt`

 * *Files identical despite different names*

